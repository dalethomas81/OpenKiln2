[
    {
        "id": "592b686edd11b813",
        "type": "tab",
        "label": "dashboard",
        "disabled": false,
        "info": ""
    },
    {
        "id": "e9cef8706a9cf7f6",
        "type": "tab",
        "label": "logic",
        "disabled": false,
        "info": ""
    },
    {
        "id": "b83fb43068cdf48f",
        "type": "tab",
        "label": "pid",
        "disabled": false,
        "info": ""
    },
    {
        "id": "3154c44d1a91de38",
        "type": "tab",
        "label": "i/o",
        "disabled": false,
        "info": ""
    },
    {
        "id": "98e4246c87add39e",
        "type": "tab",
        "label": "utility",
        "disabled": false,
        "info": ""
    },
    {
        "id": "443a1fa760cb1696",
        "type": "ui_base",
        "theme": {
            "name": "theme-dark",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#097479",
                    "value": "#097479",
                    "edited": true
                },
                "page-titlebar-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#111111",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#0eb8c0",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#555555",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#eeeeee",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#333333",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "OpenKiln Dashboard",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "MMM-DD-YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "1a7d214ba0ada216",
        "type": "influxdb",
        "hostname": "127.0.0.1",
        "port": "8086",
        "protocol": "http",
        "database": "home",
        "name": "",
        "usetls": false,
        "tls": "",
        "influxdbVersion": "1.x",
        "url": "http://localhost:8086",
        "rejectUnauthorized": true
    },
    {
        "id": "afede006ffb47acb",
        "type": "ui_link",
        "name": "Node-Red Editor",
        "link": "NodeRed",
        "icon": "developer_dashboard",
        "target": "iframe",
        "order": 6
    },
    {
        "id": "1f041bb493bd73c1",
        "type": "ui_tab",
        "name": "Schedule",
        "icon": "mode_edit",
        "order": 3,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "723f1e0d521d5671",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 3,
        "width": 1,
        "height": 1
    },
    {
        "id": "57fb49920731c540",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "b27a47450c3d7a3c",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 1,
        "width": 1,
        "height": 1
    },
    {
        "id": "739befb0e899ed56",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "32c790dff519b120",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "a046a28b2ea5f0be",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "af4a79934426a42a",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "2dc617e815eb563a",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "c3291b77297c1a32",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "62c47bf35fc1331e",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "ddf52b8312f3dcfe",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "ccb56bf9e6cc2677",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "6ea6176457413f77",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "8e2e9fc7c1febf99",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "f6d092fb3bd13b06",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "50a6ad9370071ac2",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "0ed7068150cfb65f",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "2595b0b597065044",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "916cddc083aed4b1",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "388c16a271ef1c2d",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "a766471096c0346a",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "5e1bdbab1ef4cbe6",
        "type": "ui_group",
        "name": "Schedules",
        "tab": "1f041bb493bd73c1",
        "order": 1,
        "disp": true,
        "width": 7,
        "collapse": false
    },
    {
        "id": "90879df8d2ee4c5d",
        "type": "ui_group",
        "name": "Control",
        "tab": "6e4426eb24a8676f",
        "order": 2,
        "disp": true,
        "width": "7",
        "collapse": false
    },
    {
        "id": "2201d496820b415d",
        "type": "ui_group",
        "name": "Status",
        "tab": "6e4426eb24a8676f",
        "order": 1,
        "disp": true,
        "width": "7",
        "collapse": false
    },
    {
        "id": "d86c6f681ae35c78",
        "type": "ui_link",
        "name": "PiSugar",
        "link": "PiSugar",
        "icon": "battery_charging_full",
        "target": "iframe",
        "order": 7
    },
    {
        "id": "450b79efd321b8c4",
        "type": "ui_link",
        "name": "Grafana",
        "link": "Grafana",
        "icon": "timeline",
        "target": "iframe",
        "order": 5
    },
    {
        "id": "de5db1c89316833e",
        "type": "ui_tab",
        "name": "Utility",
        "icon": "build",
        "order": 8,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "112aa19380852c23",
        "type": "ui_group",
        "name": "Analog Inputs",
        "tab": "de5db1c89316833e",
        "order": 2,
        "disp": true,
        "width": 7,
        "collapse": false
    },
    {
        "id": "f86f065176941099",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 7,
        "width": 1,
        "height": 1
    },
    {
        "id": "7a35b0f792e9846a",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 10,
        "width": 1,
        "height": 1
    },
    {
        "id": "f68e02645d7738c1",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 1,
        "width": 1,
        "height": 1
    },
    {
        "id": "b3be2f849e8ab7b8",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 3,
        "width": 2,
        "height": 1
    },
    {
        "id": "37407a3c1ee7bb79",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 5,
        "width": 1,
        "height": 1
    },
    {
        "id": "4cfc717b29133d4a",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "c7c99b97c361a432",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 8,
        "width": 2,
        "height": 1
    },
    {
        "id": "9e570445ee458c7e",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 10,
        "width": 1,
        "height": 1
    },
    {
        "id": "ad31e06a0c424f07",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 11,
        "width": 1,
        "height": 1
    },
    {
        "id": "e2919be3bfd4465c",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 13,
        "width": 2,
        "height": 1
    },
    {
        "id": "3bbf9d04d13b2787",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 15,
        "width": 1,
        "height": 1
    },
    {
        "id": "49c26116852ae508",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 16,
        "width": 2,
        "height": 1
    },
    {
        "id": "baaca26601c1e496",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 18,
        "width": 2,
        "height": 1
    },
    {
        "id": "6e4426eb24a8676f",
        "type": "ui_tab",
        "name": "Main",
        "icon": "whatshot",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "02cafb3276498790",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "",
        "order": 3,
        "width": 1,
        "height": 1
    },
    {
        "id": "efcd4096ea60e7d9",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "",
        "order": 8,
        "width": 1,
        "height": 1
    },
    {
        "id": "60a8bcb74a3c379f",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "",
        "order": 10,
        "width": 1,
        "height": 1
    },
    {
        "id": "867133fef42b3b35",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "",
        "order": 11,
        "width": 1,
        "height": 1
    },
    {
        "id": "89e70d732b86427b",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "",
        "order": 13,
        "width": 1,
        "height": 1
    },
    {
        "id": "a91f3f1520863187",
        "type": "ui_group",
        "name": "PID Tuning",
        "tab": "de5db1c89316833e",
        "order": 1,
        "disp": true,
        "width": 14,
        "collapse": false,
        "className": ""
    },
    {
        "id": "97a4a070263bb997",
        "type": "ui_group",
        "name": "Enable Control",
        "tab": "6e4426eb24a8676f",
        "order": 3,
        "disp": false,
        "width": 7,
        "collapse": false
    },
    {
        "id": "5331d4d4d2257e9c",
        "type": "ui_group",
        "d": true,
        "name": "System",
        "tab": "de5db1c89316833e",
        "order": 3,
        "disp": true,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "353b1d92547b4d5b",
        "type": "ui_group",
        "d": true,
        "name": "Enable System",
        "tab": "de5db1c89316833e",
        "order": 4,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "9d4b8159d2752be6",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "2201d496820b415d",
        "order": 8,
        "width": 1,
        "height": 1
    },
    {
        "id": "565d382156f1414b",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "90879df8d2ee4c5d",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "f726c6aba929ecf2",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "90879df8d2ee4c5d",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "b02f338a2e8da843",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "90879df8d2ee4c5d",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "05d5079ff09a2beb",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "90879df8d2ee4c5d",
        "order": 10,
        "width": 1,
        "height": 1
    },
    {
        "id": "3e6f453971795e11",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "90879df8d2ee4c5d",
        "order": 12,
        "width": 1,
        "height": 1
    },
    {
        "id": "ebf4e01d30a47e31",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "90879df8d2ee4c5d",
        "order": 13,
        "width": 1,
        "height": 1
    },
    {
        "id": "cec9f88480cf07f5",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "90879df8d2ee4c5d",
        "order": 15,
        "width": 1,
        "height": 1
    },
    {
        "id": "3c9599336968d595",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "90879df8d2ee4c5d",
        "order": 16,
        "width": 1,
        "height": 1
    },
    {
        "id": "03c043822c0addd7",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "90879df8d2ee4c5d",
        "order": 18,
        "width": 1,
        "height": 1
    },
    {
        "id": "6b9044739353ec6a",
        "type": "ui_group",
        "name": "Auto-tune",
        "tab": "de5db1c89316833e",
        "order": 5,
        "disp": true,
        "width": "14",
        "collapse": false,
        "className": ""
    },
    {
        "id": "dfdc51bd64bec297",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "99fc5710996726a8",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "154d90cee4b2de41",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 9,
        "width": 3,
        "height": 1
    },
    {
        "id": "c460468adeed4e1c",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 11,
        "width": 3,
        "height": 1
    },
    {
        "id": "6b90effa0a9951a0",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 13,
        "width": 1,
        "height": 1
    },
    {
        "id": "057250753ca86ecb",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 15,
        "width": 1,
        "height": 1
    },
    {
        "id": "08fa910c576b985f",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 18,
        "width": 1,
        "height": 1
    },
    {
        "id": "8162b5f8989502ab",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 20,
        "width": 1,
        "height": 1
    },
    {
        "id": "7f1f4367b7cb2616",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 23,
        "width": 1,
        "height": 1
    },
    {
        "id": "51419511dacdad31",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 25,
        "width": 1,
        "height": 1
    },
    {
        "id": "2e1c45336b18a17c",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 28,
        "width": 1,
        "height": 1
    },
    {
        "id": "e412fa27fbe3630e",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 30,
        "width": 1,
        "height": 1
    },
    {
        "id": "75d70a3738d69504",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "112aa19380852c23",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "9a03e0468116086f",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "112aa19380852c23",
        "order": 4,
        "width": 7,
        "height": 1
    },
    {
        "id": "d8b402c5e360b2d5",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "112aa19380852c23",
        "order": 5,
        "width": 1,
        "height": 1
    },
    {
        "id": "d7fc473abdfc2651",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "112aa19380852c23",
        "order": 7,
        "width": 1,
        "height": 1
    },
    {
        "id": "bfca97bbf238c97c",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "112aa19380852c23",
        "order": 8,
        "width": 1,
        "height": 1
    },
    {
        "id": "8ff77bcbe2e07e08",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "112aa19380852c23",
        "order": 10,
        "width": 1,
        "height": 1
    },
    {
        "id": "e35b51e38c54fedc",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "112aa19380852c23",
        "order": 11,
        "width": 7,
        "height": 1
    },
    {
        "id": "8724bba0f8abc096",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "112aa19380852c23",
        "order": 12,
        "width": 7,
        "height": 1
    },
    {
        "id": "c298172dbd075ccf",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "112aa19380852c23",
        "order": 14,
        "width": 1,
        "height": 1
    },
    {
        "id": "eee58e76868c7a74",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "112aa19380852c23",
        "order": 17,
        "width": 1,
        "height": 1
    },
    {
        "id": "ba3bd94a4ef42f21",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "112aa19380852c23",
        "order": 20,
        "width": 1,
        "height": 1
    },
    {
        "id": "0d2e4e85563211dc",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "112aa19380852c23",
        "order": 22,
        "width": 7,
        "height": 1
    },
    {
        "id": "018592d5b6fd2855",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "112aa19380852c23",
        "order": 23,
        "width": 7,
        "height": 1
    },
    {
        "id": "b14a5bfd6b9a1a58",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "6b9044739353ec6a",
        "order": 1,
        "width": 1,
        "height": 1
    },
    {
        "id": "b80675c5642d3e79",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "6b9044739353ec6a",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "b2dc14849e17c759",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "6b9044739353ec6a",
        "order": 5,
        "width": 1,
        "height": 1
    },
    {
        "id": "ddea88b3fbb81951",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "6b9044739353ec6a",
        "order": 8,
        "width": 1,
        "height": 1
    },
    {
        "id": "96342192e60c131a",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "6b9044739353ec6a",
        "order": 10,
        "width": 4,
        "height": 1
    },
    {
        "id": "1cbf932573d321f5",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "6b9044739353ec6a",
        "order": 12,
        "width": 4,
        "height": 1
    },
    {
        "id": "aa0d7e8c34dd78c9",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "6b9044739353ec6a",
        "order": 14,
        "width": 1,
        "height": 1
    },
    {
        "id": "0c3630307244d634",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "6b9044739353ec6a",
        "order": 16,
        "width": 1,
        "height": 1
    },
    {
        "id": "b9f05874cb2439dc",
        "type": "catch",
        "z": "592b686edd11b813",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 60,
        "y": 20,
        "wires": [
            [
                "21cec14cfdce048d"
            ]
        ]
    },
    {
        "id": "21cec14cfdce048d",
        "type": "debug",
        "z": "592b686edd11b813",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 155,
        "y": 20,
        "wires": [],
        "l": false
    },
    {
        "id": "018ef11ba74cb510",
        "type": "ui_form",
        "z": "592b686edd11b813",
        "name": "",
        "label": "",
        "group": "5e1bdbab1ef4cbe6",
        "order": 5,
        "width": 0,
        "height": 0,
        "options": [
            {
                "label": "Segment Name",
                "value": "name",
                "type": "text",
                "required": true,
                "rows": null
            },
            {
                "label": "Enabled",
                "value": "enabled",
                "type": "checkbox",
                "required": true,
                "rows": null
            },
            {
                "label": "Hold Enabled",
                "value": "hold",
                "type": "checkbox",
                "required": true,
                "rows": null
            },
            {
                "label": "Setpoint",
                "value": "setpoint",
                "type": "number",
                "required": true,
                "rows": null
            },
            {
                "label": "Ramp Rate",
                "value": "ramp_rate",
                "type": "number",
                "required": true,
                "rows": null
            },
            {
                "label": "Soak Time",
                "value": "soak_time",
                "type": "number",
                "required": true,
                "rows": null
            }
        ],
        "formValue": {
            "name": "",
            "enabled": false,
            "hold": false,
            "setpoint": "",
            "ramp_rate": "",
            "soak_time": ""
        },
        "payload": "",
        "submit": "submit",
        "cancel": "",
        "topic": "topic",
        "topicType": "msg",
        "splitLayout": "",
        "className": "",
        "x": 250,
        "y": 260,
        "wires": [
            [
                "f5070cef209d87e2"
            ]
        ]
    },
    {
        "id": "f5070cef209d87e2",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "//global.set('kiln_01.selected_schedule', temp);\nvar schedule_index = flow.get('schedule_index', 'memoryOnly');\nvar segment_index = flow.get('segment_index', 'memoryOnly');\nvar segment = 'kiln_01.schedules['+ schedule_index.toString() + '].segments[' + segment_index.toString() + ']'\n//node.warn(segment)\nglobal.set(segment, msg.payload);\nmsg.payload = segment\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 415,
        "y": 260,
        "wires": [
            [
                "6b534a21adf47fbc"
            ]
        ],
        "l": false
    },
    {
        "id": "5192f533b0238631",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "update form",
        "func": "\nvar schedule_index = flow.get('schedule_index', 'memoryOnly');\nvar segment_index = flow.get('segment_index', 'memoryOnly');\n\nvar segment = global.get('kiln_01.schedules['+ schedule_index.toString() + '].segments[' + segment_index.toString() + ']');\nif (segment == undefined) {\n    msg.payload = {name:\"\",enabled:false,hold:false,setpoint:0,ramp_rate:0,soak_time:0}\n} else {\n    msg.payload = segment\n}\n\nvar msg2 = {}\nmsg2.payload = global.get('kiln_01.schedules['+ schedule_index.toString() + '].segments');\n\nreturn [msg,msg2];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 610,
        "y": 360,
        "wires": [
            [
                "3fda2bd34a7c89b2"
            ],
            [
                "338980eff32a3206"
            ]
        ]
    },
    {
        "id": "26aedf9d4f3e92fc",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "set default index",
        "rules": [
            {
                "t": "set",
                "p": "#:(memoryOnly)::schedule_index",
                "pt": "flow",
                "to": "0",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "#:(memoryOnly)::segment_index",
                "pt": "flow",
                "to": "0",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "dashboard_client_count",
                "pt": "global",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 395,
        "y": 20,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "782f21bebe74bd1c",
        "type": "ui_dropdown",
        "z": "592b686edd11b813",
        "name": "",
        "label": "Active Schedule",
        "tooltip": "",
        "place": "Select option",
        "group": "90879df8d2ee4c5d",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "multiple": false,
        "options": [
            {
                "label": "schedule 1",
                "value": 0,
                "type": "num"
            },
            {
                "label": "schedule 2",
                "value": 1,
                "type": "num"
            },
            {
                "label": "schedule 3",
                "value": 2,
                "type": "num"
            },
            {
                "label": "schedule 4",
                "value": 3,
                "type": "num"
            },
            {
                "label": "schedule 5",
                "value": 4,
                "type": "num"
            },
            {
                "label": "schedule 6",
                "value": 5,
                "type": "num"
            },
            {
                "label": "schedule 7",
                "value": 6,
                "type": "num"
            },
            {
                "label": "schedule 8",
                "value": 7,
                "type": "num"
            },
            {
                "label": "schedule 9",
                "value": 8,
                "type": "num"
            }
        ],
        "payload": "",
        "topic": "topic",
        "topicType": "msg",
        "className": "",
        "x": 660,
        "y": 520,
        "wires": [
            [
                "245aecb0a76e7750"
            ]
        ]
    },
    {
        "id": "245aecb0a76e7750",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "set schedule index",
        "func": "\n//var selected_schedule = global.get('kiln_01.schedules['+ msg.payload + ']')\n//global.set('kiln_01.active_schedule', selected_schedule);\nglobal.set('kiln_01.active_schedule_index', parseFloat(msg.payload));\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 775,
        "y": 520,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "b5b651e02428cab0",
        "type": "comment",
        "z": "592b686edd11b813",
        "name": "Control Dashboard",
        "info": "",
        "x": 110,
        "y": 480,
        "wires": []
    },
    {
        "id": "71b520a30c4deec4",
        "type": "ui_button",
        "z": "592b686edd11b813",
        "name": "",
        "group": "90879df8d2ee4c5d",
        "order": 3,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Start",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "play_arrow",
        "payload": "Start",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 230,
        "y": 640,
        "wires": [
            [
                "218ec5179ca4b0eb"
            ]
        ]
    },
    {
        "id": "ae53f4a3aef75fe8",
        "type": "ui_button",
        "z": "592b686edd11b813",
        "name": "",
        "group": "90879df8d2ee4c5d",
        "order": 5,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Stop",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "stop",
        "payload": "Stop",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 230,
        "y": 680,
        "wires": [
            [
                "c03c7fb7458a9e9f",
                "09a19e4fb99f4ef4"
            ]
        ]
    },
    {
        "id": "95a54e2f0c9b2382",
        "type": "ui_button",
        "z": "592b686edd11b813",
        "name": "",
        "group": "90879df8d2ee4c5d",
        "order": 11,
        "width": 5,
        "height": 1,
        "passthru": false,
        "label": "Release",
        "tooltip": "",
        "color": "",
        "bgcolor": "orange",
        "className": "",
        "icon": "restore",
        "payload": "Release",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 220,
        "y": 760,
        "wires": [
            [
                "c03c7fb7458a9e9f"
            ]
        ]
    },
    {
        "id": "c03c7fb7458a9e9f",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "Output - Buttons",
        "mode": "link",
        "links": [
            "defcc28b265151c2",
            "81fb9a528731184e"
        ],
        "x": 435,
        "y": 800,
        "wires": []
    },
    {
        "id": "1de58add27ec2baf",
        "type": "ui_text",
        "z": "592b686edd11b813",
        "group": "2201d496820b415d",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Schedule State",
        "format": "<font color='green'>{{msg.payload}}</font>",
        "layout": "row-center",
        "className": "",
        "x": 260,
        "y": 1000,
        "wires": []
    },
    {
        "id": "44901a155449dc95",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - Current Schedule State",
        "links": [
            "b33e0726c17b668b"
        ],
        "x": 135,
        "y": 1000,
        "wires": [
            [
                "1de58add27ec2baf"
            ]
        ]
    },
    {
        "id": "85642d7408d49cd8",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - schedule selection dropdown",
        "links": [
            "7b896f97e70ee242",
            "75b14d458cd1e761",
            "a898206a716472e9",
            "7ada905b810b30c6"
        ],
        "x": 475,
        "y": 520,
        "wires": [
            [
                "7dc828597fda8316"
            ]
        ]
    },
    {
        "id": "d1b9dbb996bc65fd",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "update schedule dropdown with selected schedule index",
        "func": "\n\nmsg.payload = global.get('kiln_01.active_schedule_index');\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 255,
        "y": 520,
        "wires": [
            [
                "75b14d458cd1e761"
            ]
        ],
        "l": false
    },
    {
        "id": "75b14d458cd1e761",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "",
        "mode": "link",
        "links": [
            "85642d7408d49cd8"
        ],
        "x": 315,
        "y": 520,
        "wires": []
    },
    {
        "id": "52e7c1f8dff102dc",
        "type": "switch",
        "z": "592b686edd11b813",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "lost",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "connect",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "change",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 475,
        "y": 340,
        "wires": [
            [],
            [
                "5192f533b0238631",
                "c43fe6a6eabba842"
            ],
            [
                "5192f533b0238631",
                "c43fe6a6eabba842"
            ]
        ],
        "l": false
    },
    {
        "id": "87d7118f46499bc1",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - release button",
        "links": [
            "f59050e178b63b1a"
        ],
        "x": 95,
        "y": 760,
        "wires": [
            [
                "95a54e2f0c9b2382"
            ]
        ]
    },
    {
        "id": "bd741c9362f990e9",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - advance button",
        "links": [],
        "x": 95,
        "y": 720,
        "wires": [
            [
                "7bfd8d56a8dba80e"
            ]
        ]
    },
    {
        "id": "a585d96564013b99",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - stop button",
        "links": [],
        "x": 95,
        "y": 680,
        "wires": [
            [
                "ae53f4a3aef75fe8"
            ]
        ]
    },
    {
        "id": "0642571f7ecac918",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - start button",
        "links": [],
        "x": 95,
        "y": 640,
        "wires": [
            [
                "71b520a30c4deec4"
            ]
        ]
    },
    {
        "id": "9b6b7f2249d013ba",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - Upper Temperature",
        "links": [
            "dcbc073ea7b777ee"
        ],
        "x": 495,
        "y": 1020,
        "wires": [
            [
                "0572ddcc3ec31a19"
            ]
        ]
    },
    {
        "id": "4ea9f6ce194f1281",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - Lower Temperature",
        "links": [
            "e65201e766b76bfd"
        ],
        "x": 495,
        "y": 1040,
        "wires": [
            [
                "6b5cdf6cc5944a09"
            ]
        ]
    },
    {
        "id": "0ced5c373a61386b",
        "type": "ui_chart",
        "z": "592b686edd11b813",
        "name": "",
        "group": "2201d496820b415d",
        "order": 10,
        "width": 7,
        "height": 5,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "bezier",
        "nodata": "Refresh to see data",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#ff9300",
            "#2ca02c",
            "#ff7f0e",
            "#d62728",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 750,
        "y": 1160,
        "wires": [
            []
        ]
    },
    {
        "id": "89090e12b153c6a4",
        "type": "ui_template",
        "z": "592b686edd11b813",
        "group": "5e1bdbab1ef4cbe6",
        "name": "",
        "order": 4,
        "width": 7,
        "height": 4,
        "format": "<style>\n.header {\n    border-bottom: 1pt solid white;\n    //text-decoration: underline;\n    vertical-align: bottom;\n    //valign=\"bottom\"\n}\n.table {\n    width: 100%;\n    //width:500px;\n    //background:lightblue;\n    //border:1px solid black;\n    //border-collapse: collapse;\n    font-size:10px;\n    text-align: center;\n    vertical-align: center;\n}\n.data {\n    //width: 15%\n    //white-space: nowrap\n    //white-space: normal\n    //vertical-align: bottom;\n}\n.main\n{\n    //height:400px;\n}\n</style>\n<div class=\"main\">\n    <table class=\"table\">  \n        <tr>\n            <th class=\"header\">Segment</th>\n            <th class=\"header\">Name</th>\n            <th class=\"header\">Enabled</th>\n            <th class=\"header\">Hold</th>\n            <th class=\"header\">Setpoint (°F)</th>\n            <th class=\"header\">Ramp (deg/h)</th>\n            <th class=\"header\">Soak (min)</th>\n        </tr>\n        <tr ng-repeat = \"payload in msg.payload\"><td>{{$index+1}}</td><td ng-repeat =\"(key,value) in payload\">{{value}}</td></tr>\n    </table>\n</div>",
        "storeOutMessages": false,
        "fwdInMessages": false,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 260,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "22fd3eb6907ee40d",
        "type": "ui_button",
        "z": "592b686edd11b813",
        "name": "delete segment",
        "group": "5e1bdbab1ef4cbe6",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Delete Segment",
        "tooltip": "",
        "color": "",
        "bgcolor": "orange",
        "className": "",
        "icon": "warning",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 280,
        "y": 300,
        "wires": [
            [
                "d815b4776bb0f1aa"
            ]
        ]
    },
    {
        "id": "d815b4776bb0f1aa",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "delete segment",
        "func": "var schedule_index = flow.get('schedule_index', 'memoryOnly');\nvar segment_index = flow.get('segment_index', 'memoryOnly');\nvar segment = 'kiln_01.schedules['+ schedule_index.toString() + '].segments[' + segment_index.toString() + ']'\n\nglobal.set(segment, undefined);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 415,
        "y": 300,
        "wires": [
            [
                "6b534a21adf47fbc"
            ]
        ],
        "l": false
    },
    {
        "id": "e0f89df2c8e81cd9",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "",
        "links": [
            "3fda2bd34a7c89b2"
        ],
        "x": 155,
        "y": 260,
        "wires": [
            [
                "018ef11ba74cb510"
            ]
        ]
    },
    {
        "id": "ae2b5be430abc93f",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "",
        "links": [
            "338980eff32a3206"
        ],
        "x": 155,
        "y": 340,
        "wires": [
            [
                "89090e12b153c6a4"
            ]
        ]
    },
    {
        "id": "3fda2bd34a7c89b2",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "",
        "mode": "link",
        "links": [
            "e0f89df2c8e81cd9"
        ],
        "x": 735,
        "y": 340,
        "wires": []
    },
    {
        "id": "338980eff32a3206",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "",
        "mode": "link",
        "links": [
            "ae2b5be430abc93f"
        ],
        "x": 735,
        "y": 380,
        "wires": []
    },
    {
        "id": "006321a7d5098eed",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "",
        "links": [
            "6b534a21adf47fbc",
            "bbb665c4fceb800d",
            "beee976f9bb8a5fd"
        ],
        "x": 475,
        "y": 380,
        "wires": [
            [
                "5192f533b0238631"
            ]
        ]
    },
    {
        "id": "6b534a21adf47fbc",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "",
        "mode": "link",
        "links": [
            "006321a7d5098eed"
        ],
        "x": 495,
        "y": 260,
        "wires": []
    },
    {
        "id": "bbb665c4fceb800d",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "",
        "mode": "link",
        "links": [
            "006321a7d5098eed",
            "223bca47aa31a4da"
        ],
        "x": 495,
        "y": 180,
        "wires": []
    },
    {
        "id": "7bfd8d56a8dba80e",
        "type": "ui_button",
        "z": "592b686edd11b813",
        "name": "",
        "group": "90879df8d2ee4c5d",
        "order": 17,
        "width": 5,
        "height": 1,
        "passthru": false,
        "label": "Advance",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "skip_next",
        "payload": "Advance",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 220,
        "y": 720,
        "wires": [
            [
                "c03c7fb7458a9e9f"
            ]
        ]
    },
    {
        "id": "8058b979887ff4eb",
        "type": "ui_button",
        "z": "592b686edd11b813",
        "name": "",
        "group": "90879df8d2ee4c5d",
        "order": 14,
        "width": 5,
        "height": 1,
        "passthru": false,
        "label": "Hold",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "pause",
        "payload": "Hold",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 230,
        "y": 800,
        "wires": [
            [
                "c03c7fb7458a9e9f"
            ]
        ]
    },
    {
        "id": "87ef55ffe3ea2883",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - hold button",
        "links": [],
        "x": 95,
        "y": 800,
        "wires": [
            [
                "8058b979887ff4eb"
            ]
        ]
    },
    {
        "id": "2b7d853b4ddd2588",
        "type": "ui_text",
        "z": "592b686edd11b813",
        "group": "2201d496820b415d",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Ramp Rate",
        "format": "<font color='green'>{{msg.payload}} deg/h</font>",
        "layout": "row-center",
        "className": "",
        "x": 610,
        "y": 1000,
        "wires": []
    },
    {
        "id": "899c85f172cb1839",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - status ramp rate",
        "links": [
            "233d081ef7b67749",
            "59ca3789e4efaf36",
            "c5180a0a450ebd11"
        ],
        "x": 495,
        "y": 1000,
        "wires": [
            [
                "2b7d853b4ddd2588"
            ]
        ]
    },
    {
        "id": "fb07d106257c09b8",
        "type": "influxdb in",
        "z": "592b686edd11b813",
        "influxdb": "1a7d214ba0ada216",
        "name": "",
        "query": "",
        "rawOutput": true,
        "precision": "",
        "retentionPolicy": "",
        "org": "organisation",
        "x": 595,
        "y": 1160,
        "wires": [
            [
                "566ce4114146f76d"
            ]
        ],
        "l": false
    },
    {
        "id": "a65357c5f5e0b6d3",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "select kiln temps",
        "rules": [
            {
                "t": "set",
                "p": "query",
                "pt": "msg",
                "to": "select * from Kiln_01_UpperTemperature, Kiln_01_LowerTemperature WHERE time > now() - 12h",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 535,
        "y": 1160,
        "wires": [
            [
                "fb07d106257c09b8"
            ]
        ],
        "l": false
    },
    {
        "id": "566ce4114146f76d",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "parse query results",
        "func": "if (msg.payload.results[0].series !== undefined){\n    // enable \"raw output\" from the influxdb node\n    // use this query: select * from kiln_upper_temperature_01, kiln_lower_temperature_01 WHERE time > now() - 1h;\n    var msg_out = {\"payload\":[{\"series\":[],\"data\":[],\"labels\":[]}]};\n    \n    // series 1\n    var series_data0 = [];\n    for(var i = 0; i < msg.payload.results[0].series[0].values.length-1; i++){\n        series_data0.push({\n            x: msg.payload.results[0].series[0].values[i][0],\n            y: msg.payload.results[0].series[0].values[i][1],\n        })\n    }\n    msg_out.payload[0].series[0] = msg.payload.results[0].series[0].name\n    msg_out.payload[0].labels[0] = \"Upper Temp Label\"\n    \n    // series 2\n    var series_data1 = [];\n    for(var i = 0; i < msg.payload.results[0].series[1].values.length-1; i++){\n        series_data1.push({\n            x: msg.payload.results[0].series[1].values[i][0],\n            y: msg.payload.results[0].series[1].values[i][1],\n        })\n    }\n    msg_out.payload[0].series[1] = msg.payload.results[0].series[1].name\n    msg_out.payload[0].labels[1] = \"Lower Temp Label\"\n    \n    // add all series to the data array\n    var data_array = [];\n    data_array[0] = series_data0\n    data_array[1] = series_data1\n    \n    // \n    msg_out.payload[0].data = data_array\n    \n    return msg_out;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 655,
        "y": 1160,
        "wires": [
            [
                "0ced5c373a61386b"
            ]
        ],
        "l": false
    },
    {
        "id": "0c9d08cd9424255c",
        "type": "comment",
        "z": "592b686edd11b813",
        "name": "Schedule Dashboard",
        "info": "",
        "x": 120,
        "y": 100,
        "wires": []
    },
    {
        "id": "c8796bffe6a96967",
        "type": "ui_audio",
        "z": "592b686edd11b813",
        "name": "",
        "group": "2201d496820b415d",
        "voice": "com.apple.speech.synthesis.voice.Alex",
        "always": true,
        "x": 640,
        "y": 1300,
        "wires": []
    },
    {
        "id": "5aac6d66af0d0e21",
        "type": "inject",
        "z": "592b686edd11b813",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 135,
        "y": 1300,
        "wires": [
            [
                "dcdb2c44aaed16a4"
            ]
        ],
        "l": false
    },
    {
        "id": "be787bb7f9bb0c5c",
        "type": "comment",
        "z": "592b686edd11b813",
        "name": "announcements",
        "info": "",
        "x": 100,
        "y": 1260,
        "wires": []
    },
    {
        "id": "b1abc1b4bcb481ab",
        "type": "inject",
        "z": "592b686edd11b813",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 135,
        "y": 1340,
        "wires": [
            [
                "073493472e3f15af"
            ]
        ],
        "l": false
    },
    {
        "id": "e4bb3457a8359d15",
        "type": "inject",
        "z": "592b686edd11b813",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 135,
        "y": 1380,
        "wires": [
            [
                "154551a7ba429601"
            ]
        ],
        "l": false
    },
    {
        "id": "11c01c157ecfd3ef",
        "type": "comment",
        "z": "592b686edd11b813",
        "name": "Status dashboard",
        "info": "",
        "x": 110,
        "y": 960,
        "wires": []
    },
    {
        "id": "c43fe6a6eabba842",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "",
        "mode": "link",
        "links": [
            "b5f8918b49462031",
            "223bca47aa31a4da"
        ],
        "x": 555,
        "y": 320,
        "wires": []
    },
    {
        "id": "b5f8918b49462031",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "",
        "links": [
            "c43fe6a6eabba842"
        ],
        "x": 75,
        "y": 180,
        "wires": [
            [
                "fc2609866ba68e99",
                "d8c55002e59fcada"
            ]
        ]
    },
    {
        "id": "023f6eeca8781228",
        "type": "ui_text_input",
        "z": "592b686edd11b813",
        "name": "schedule name",
        "label": "",
        "tooltip": "",
        "group": "5e1bdbab1ef4cbe6",
        "order": 1,
        "width": 3,
        "height": 1,
        "passthru": false,
        "mode": "text",
        "delay": "300",
        "topic": "topic",
        "sendOnBlur": true,
        "className": "",
        "topicType": "msg",
        "x": 280,
        "y": 140,
        "wires": [
            [
                "7d3f232e7739f144"
            ]
        ]
    },
    {
        "id": "7d3f232e7739f144",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "var schedule_index = flow.get('schedule_index', 'memoryOnly');\nvar segment = 'kiln_01.schedules['+ schedule_index.toString() + '].name'\n\nglobal.set(segment, msg.payload);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 415,
        "y": 140,
        "wires": [
            [
                "7ada905b810b30c6"
            ]
        ],
        "l": false
    },
    {
        "id": "223bca47aa31a4da",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "",
        "links": [
            "c43fe6a6eabba842",
            "bbb665c4fceb800d",
            "beee976f9bb8a5fd"
        ],
        "x": 75,
        "y": 140,
        "wires": [
            [
                "7560c351d622b7c2"
            ]
        ]
    },
    {
        "id": "7560c351d622b7c2",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "var schedule_index = flow.get('schedule_index', 'memoryOnly');\nvar name = 'kiln_01.schedules['+ schedule_index.toString() + '].name'\n\nmsg.payload = global.get(name);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 155,
        "y": 140,
        "wires": [
            [
                "023f6eeca8781228"
            ]
        ],
        "l": false
    },
    {
        "id": "7ada905b810b30c6",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "",
        "mode": "link",
        "links": [
            "af271e715f494e25",
            "85642d7408d49cd8"
        ],
        "x": 495,
        "y": 140,
        "wires": []
    },
    {
        "id": "7dc828597fda8316",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "get schedule names",
        "func": "var schedules = global.get('kiln_01.schedules')\nvar schedule_names = []\nfor (let index = 0; index < schedules.length; index++) {\n    var name = {}\n    if (schedules[index] !== undefined && schedules[index] !== null){\n        name[schedules[index].name] = index.toString()\n    } else {\n        name[\"schedule \"+index] = index.toString()\n    }\n    schedule_names.push(name)\n}\nmsg.options = schedule_names\nreturn msg;\n\n/*\n[\n    {\n        \"schedule 1\": \"0\"\n    },\n    {\n        \"schedule 2\": \"1\"\n    }\n\n]\n[\n    {\n        \"Cone 04 Bisque\":\"0\"\n    },\n    {\n        \"Cone 6 Glaze\":\"1\"\n    }\n]\n*/",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 535,
        "y": 520,
        "wires": [
            [
                "782f21bebe74bd1c"
            ]
        ],
        "l": false
    },
    {
        "id": "9ac0734e2471a4ae",
        "type": "ui_numeric",
        "z": "592b686edd11b813",
        "name": "schedule index",
        "label": "",
        "tooltip": "",
        "group": "5e1bdbab1ef4cbe6",
        "order": 2,
        "width": 2,
        "height": 1,
        "wrap": true,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{value}}",
        "min": "1",
        "max": "16",
        "step": 1,
        "className": "",
        "x": 280,
        "y": 180,
        "wires": [
            [
                "fee462e7f0afe7fe"
            ]
        ]
    },
    {
        "id": "6de15819559dade9",
        "type": "ui_numeric",
        "z": "592b686edd11b813",
        "name": "segment index",
        "label": "",
        "tooltip": "",
        "group": "5e1bdbab1ef4cbe6",
        "order": 3,
        "width": 2,
        "height": 1,
        "wrap": true,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{value}}",
        "min": "1",
        "max": "16",
        "step": 1,
        "className": "",
        "x": 280,
        "y": 220,
        "wires": [
            [
                "982ec52ff0e6cfbf"
            ]
        ]
    },
    {
        "id": "fc2609866ba68e99",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "var schedule_index = flow.get('schedule_index', 'memoryOnly');\nmsg.payload = schedule_index + 1\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 155,
        "y": 180,
        "wires": [
            [
                "9ac0734e2471a4ae"
            ]
        ],
        "l": false
    },
    {
        "id": "d8c55002e59fcada",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "var segment_index = flow.get('segment_index', 'memoryOnly');\nmsg.payload = segment_index + 1\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 155,
        "y": 220,
        "wires": [
            [
                "6de15819559dade9"
            ]
        ],
        "l": false
    },
    {
        "id": "fee462e7f0afe7fe",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "flow.set('schedule_index', msg.payload - 1, 'memoryOnly');\nflow.set('segment_index', 0, 'memoryOnly'); // reset the segment index when switching schedules\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 415,
        "y": 180,
        "wires": [
            [
                "bbb665c4fceb800d",
                "d8c55002e59fcada"
            ]
        ],
        "l": false
    },
    {
        "id": "982ec52ff0e6cfbf",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "flow.set('segment_index', msg.payload - 1, 'memoryOnly');\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 415,
        "y": 220,
        "wires": [
            [
                "bbb665c4fceb800d"
            ]
        ],
        "l": false
    },
    {
        "id": "c5f9f24aff96d7cb",
        "type": "delay",
        "z": "592b686edd11b813",
        "name": "Soak Timer",
        "pauseType": "delayv",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 675,
        "y": 740,
        "wires": [
            [
                "bc38816db3f974c5"
            ]
        ],
        "l": false
    },
    {
        "id": "bc38816db3f974c5",
        "type": "switch",
        "z": "592b686edd11b813",
        "name": "done",
        "property": "remaining_milliseconds",
        "propertyType": "msg",
        "rules": [
            {
                "t": "lte",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "gt",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 735,
        "y": 740,
        "wires": [
            [
                "084f011204f8cadc"
            ],
            [
                "06a98691587aad1c"
            ]
        ],
        "l": false
    },
    {
        "id": "06a98691587aad1c",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "status",
        "func": "var time\n\nif (!msg.reset){\n    msg.remaining_milliseconds = msg.remaining_milliseconds - 1000\n    if (msg.remaining_milliseconds <= 0) {\n        msg.delay = 0;\n        msg.flush = true;\n    }\n} else {\n    msg.remaining_milliseconds = 0\n}\n\nfunction msToTime(duration) {\n    var milliseconds = Math.floor((duration % 1000) / 100),\n        seconds = Math.floor((duration / 1000) % 60),\n        minutes = Math.floor((duration / (1000 * 60)) % 60),\n        hours = Math.floor((duration / (1000 * 60 * 60)) % 24);\n\n    hours = (hours < 10) ? \"0\" + hours : hours;\n    minutes = (minutes < 10) ? \"0\" + minutes : minutes;\n    seconds = (seconds < 10) ? \"0\" + seconds : seconds;\n\n    return hours + \":\" + minutes + \":\" + seconds + \".\" + milliseconds;\n}\n//console.log(msToTime(300000))\n\ntime = { human: msToTime(msg.remaining_milliseconds), hours: msg.remaining_milliseconds / 1000.0 / 60.0 / 60.0, minutes: msg.remaining_milliseconds / 1000.0 / 60.0, seconds: msg.remaining_milliseconds / 1000.0, milliseconds: msg.remaining_milliseconds };\ntime.hours = time.hours.toFixed(2);\ntime.minutes = time.minutes.toFixed(2);\ntime.seconds = time.seconds.toFixed(2);\ntime.milliseconds = time.milliseconds.toFixed(2);\n\n//msg.remaining = msToTime(msg.remaining_milliseconds)\n\nif (time.milliseconds >= 0){\n    return [msg,time];\n} else {\n    return [msg,null];\n}",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 675,
        "y": 800,
        "wires": [
            [
                "c5f9f24aff96d7cb"
            ],
            [
                "f040abfd68065067"
            ]
        ],
        "l": false
    },
    {
        "id": "5f9c6c60065b8f08",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "start",
        "rules": [
            {
                "t": "set",
                "p": "remaining_milliseconds",
                "pt": "msg",
                "to": "delay",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "1000",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 615,
        "y": 740,
        "wires": [
            [
                "c5f9f24aff96d7cb"
            ]
        ],
        "l": false
    },
    {
        "id": "73d3d8e5967488da",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "reset",
        "rules": [
            {
                "t": "set",
                "p": "remaining_milliseconds",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 615,
        "y": 800,
        "wires": [
            [
                "06a98691587aad1c"
            ]
        ],
        "l": false
    },
    {
        "id": "0f7049822af7ce2d",
        "type": "comment",
        "z": "592b686edd11b813",
        "name": "custom timer with status output",
        "info": "",
        "x": 690,
        "y": 820,
        "wires": []
    },
    {
        "id": "f040abfd68065067",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "send minutes",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "human",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 735,
        "y": 800,
        "wires": [
            [
                "3b166a8844e225b5"
            ]
        ],
        "l": false
    },
    {
        "id": "2644df39e84cb1af",
        "type": "ui_switch",
        "z": "592b686edd11b813",
        "name": "",
        "label": "Delay Start",
        "tooltip": "",
        "group": "90879df8d2ee4c5d",
        "order": 7,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 750,
        "y": 640,
        "wires": [
            [
                "01324301a21bcd20"
            ]
        ]
    },
    {
        "id": "50762693207ba7b8",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "msg.delay = msg.payload * 60.0 * 60.0 * 1000 // convert hours to milliseconds\nflow.set('delay_start_ms', msg.delay)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 875,
        "y": 680,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "218ec5179ca4b0eb",
        "type": "switch",
        "z": "592b686edd11b813",
        "name": "",
        "property": "delay_start",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 315,
        "y": 640,
        "wires": [
            [
                "d3643650aa18d173"
            ],
            [
                "c03c7fb7458a9e9f"
            ]
        ],
        "l": false
    },
    {
        "id": "084f011204f8cadc",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "Output - Buttons",
        "mode": "link",
        "links": [
            "defcc28b265151c2",
            "81fb9a528731184e"
        ],
        "x": 815,
        "y": 740,
        "wires": []
    },
    {
        "id": "01324301a21bcd20",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "delay_start",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 855,
        "y": 640,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "6f1a074c6a1a494f",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "delay_start",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 635,
        "y": 640,
        "wires": [
            [
                "2644df39e84cb1af"
            ]
        ],
        "l": false
    },
    {
        "id": "9be32d3453fc15e7",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "delay_start",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "delay_start_ms",
                "pt": "flow",
                "to": "0",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "delay_start_running",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 855,
        "y": 600,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "4d90359030b767aa",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "delay_start_ms",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "delay_start_running",
                "pt": "flow",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 555,
        "y": 740,
        "wires": [
            [
                "5f9c6c60065b8f08"
            ]
        ],
        "l": false
    },
    {
        "id": "3b166a8844e225b5",
        "type": "ui_text",
        "z": "592b686edd11b813",
        "group": "90879df8d2ee4c5d",
        "order": 9,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Delay time Remaining",
        "format": "<font color='green'>{{msg.payload}}</font>",
        "layout": "row-spread",
        "className": "",
        "x": 795,
        "y": 800,
        "wires": [],
        "l": false
    },
    {
        "id": "5ecdaca58bba18a3",
        "type": "ui_numeric",
        "z": "592b686edd11b813",
        "name": "",
        "label": "",
        "tooltip": "",
        "group": "90879df8d2ee4c5d",
        "order": 8,
        "width": 3,
        "height": 1,
        "wrap": false,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{value}}h",
        "min": 0,
        "max": 10,
        "step": "0.5",
        "className": "",
        "x": 780,
        "y": 680,
        "wires": [
            [
                "50762693207ba7b8"
            ]
        ]
    },
    {
        "id": "dd8c493f3d3692df",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "var delay_start_ms = flow.get('delay_start_ms')\nmsg.payload = delay_start_ms / 1000.0 / 60.0 / 60.0 // convert milliseconds to hours\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 655,
        "y": 680,
        "wires": [
            [
                "5ecdaca58bba18a3"
            ]
        ],
        "l": false
    },
    {
        "id": "09a19e4fb99f4ef4",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "delay_start_running",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 555,
        "y": 800,
        "wires": [
            [
                "73d3d8e5967488da"
            ]
        ],
        "l": false
    },
    {
        "id": "d3643650aa18d173",
        "type": "switch",
        "z": "592b686edd11b813",
        "name": "",
        "property": "delay_start_running",
        "propertyType": "flow",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 495,
        "y": 740,
        "wires": [
            [
                "4d90359030b767aa"
            ]
        ],
        "l": false
    },
    {
        "id": "6af73a69a0827774",
        "type": "ui_ui_control",
        "z": "592b686edd11b813",
        "name": "",
        "events": "all",
        "x": 480,
        "y": 840,
        "wires": [
            []
        ]
    },
    {
        "id": "704c9d7362c26e4e",
        "type": "ui_button",
        "z": "592b686edd11b813",
        "name": "",
        "group": "97a4a070263bb997",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Show Control",
        "tooltip": "",
        "color": "",
        "bgcolor": "orange",
        "className": "",
        "icon": "warning",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 295,
        "y": 840,
        "wires": [
            [
                "e8fb2f356c4749fc"
            ]
        ],
        "l": false
    },
    {
        "id": "e8fb2f356c4749fc",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "show",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"group\":{\"hide\":[\"Main_Enable_Control\"],\"show\":[\"Main_Control\"],\"focus\":true}}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 355,
        "y": 840,
        "wires": [
            [
                "6af73a69a0827774"
            ]
        ],
        "l": false
    },
    {
        "id": "4c5cb4d50d6fc7e2",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "hide",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"group\":{\"hide\":[\"Main_Control\"],\"show\":[\"Main_Enable_Control\"],\"focus\":false}}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 355,
        "y": 880,
        "wires": [
            [
                "6af73a69a0827774"
            ]
        ],
        "l": false
    },
    {
        "id": "77d007e0776a393c",
        "type": "trigger",
        "z": "592b686edd11b813",
        "name": "",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "-10",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 475,
        "y": 1160,
        "wires": [
            [
                "a65357c5f5e0b6d3"
            ]
        ],
        "l": false
    },
    {
        "id": "4bc6a2d8f60ff88a",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 415,
        "y": 1180,
        "wires": [
            [
                "77d007e0776a393c"
            ]
        ],
        "l": false
    },
    {
        "id": "4ba3b5ace9fff3d0",
        "type": "switch",
        "z": "592b686edd11b813",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "change",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "lost",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 295,
        "y": 1180,
        "wires": [
            [
                "29c5bb56f28f82ea"
            ],
            [
                "c3c6a25a8238c2c5"
            ]
        ],
        "l": false
    },
    {
        "id": "29c5bb56f28f82ea",
        "type": "switch",
        "z": "592b686edd11b813",
        "name": "",
        "property": "tab",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "neq",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 355,
        "y": 1160,
        "wires": [
            [
                "77d007e0776a393c"
            ],
            []
        ],
        "l": false
    },
    {
        "id": "154551a7ba429601",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "The kiln schedule is complete.",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "The kiln schedule is complete.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 370,
        "y": 1380,
        "wires": [
            [
                "c8796bffe6a96967"
            ]
        ]
    },
    {
        "id": "073493472e3f15af",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "The kiln has entered a hold.",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "The kiln has entered a hold.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 1340,
        "wires": [
            [
                "c8796bffe6a96967"
            ]
        ]
    },
    {
        "id": "dcdb2c44aaed16a4",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "The Kiln is on fire.",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "The Kiln is on fire.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 1300,
        "wires": [
            [
                "c8796bffe6a96967"
            ]
        ]
    },
    {
        "id": "1c4a0c29242ea67f",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "The Kiln is on fire.",
        "links": [],
        "x": 195,
        "y": 1300,
        "wires": [
            [
                "dcdb2c44aaed16a4"
            ]
        ]
    },
    {
        "id": "b7e67964f0dbbbd9",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "The kiln has entered a hold.",
        "links": [
            "6c4b614fba70c14d"
        ],
        "x": 195,
        "y": 1340,
        "wires": [
            [
                "073493472e3f15af"
            ]
        ]
    },
    {
        "id": "365612cabf4e1f82",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "The kiln schedule is complete.",
        "links": [],
        "x": 195,
        "y": 1380,
        "wires": [
            [
                "154551a7ba429601"
            ]
        ]
    },
    {
        "id": "e4d667c341be7e74",
        "type": "comment",
        "z": "592b686edd11b813",
        "name": "detect when connect to dashboard tab",
        "info": "",
        "x": 370,
        "y": 1140,
        "wires": []
    },
    {
        "id": "34d747ac4d0ff66f",
        "type": "switch",
        "z": "592b686edd11b813",
        "name": "",
        "property": "tab",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "1",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 415,
        "y": 340,
        "wires": [
            [
                "52e7c1f8dff102dc"
            ]
        ],
        "l": false
    },
    {
        "id": "e22edcc46fd64490",
        "type": "switch",
        "z": "592b686edd11b813",
        "name": "",
        "property": "tab",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 135,
        "y": 520,
        "wires": [
            [
                "06694a38753bf2cc"
            ]
        ],
        "l": false
    },
    {
        "id": "f62427195cb0ab96",
        "type": "switch",
        "z": "592b686edd11b813",
        "name": "",
        "property": "tab",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 515,
        "y": 660,
        "wires": [
            [
                "dc13cdb87e5552ed"
            ]
        ],
        "l": false
    },
    {
        "id": "06694a38753bf2cc",
        "type": "switch",
        "z": "592b686edd11b813",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "lost",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "connect",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "change",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 195,
        "y": 520,
        "wires": [
            [],
            [
                "d1b9dbb996bc65fd"
            ],
            [
                "d1b9dbb996bc65fd"
            ]
        ],
        "l": false
    },
    {
        "id": "dc13cdb87e5552ed",
        "type": "switch",
        "z": "592b686edd11b813",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "lost",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "connect",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "change",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 575,
        "y": 660,
        "wires": [
            [],
            [
                "6f1a074c6a1a494f",
                "dd8c493f3d3692df"
            ],
            [
                "6f1a074c6a1a494f",
                "dd8c493f3d3692df"
            ]
        ],
        "l": false
    },
    {
        "id": "edbc0dfd186a2ef1",
        "type": "ui_ui_control",
        "z": "592b686edd11b813",
        "name": "dashboard events",
        "events": "all",
        "x": 675,
        "y": 20,
        "wires": [
            [
                "9234cc41d8a3f409"
            ]
        ],
        "l": false
    },
    {
        "id": "0d7362ca2edd72c6",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "dashboard events w/ client count",
        "mode": "link",
        "links": [
            "c407645cd401c969",
            "72e821de5a9c10a5",
            "cc19dfacf51e9fc6",
            "d3bb9cf4b0826a24",
            "ae639127ca4d386d",
            "c0707caf85c10e83",
            "3de872e32eb64a26",
            "9583bdd91a208b77",
            "47cdbbef8944aef2",
            "c8c2253243612480"
        ],
        "x": 795,
        "y": 20,
        "wires": []
    },
    {
        "id": "c407645cd401c969",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "dashboard events",
        "links": [
            "0d7362ca2edd72c6"
        ],
        "x": 330,
        "y": 400,
        "wires": [
            [
                "34d747ac4d0ff66f"
            ]
        ],
        "l": true
    },
    {
        "id": "72e821de5a9c10a5",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "dashboard events",
        "links": [
            "0d7362ca2edd72c6"
        ],
        "x": 130,
        "y": 580,
        "wires": [
            [
                "e22edcc46fd64490"
            ]
        ],
        "l": true
    },
    {
        "id": "cc19dfacf51e9fc6",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "dashboard events",
        "links": [
            "0d7362ca2edd72c6"
        ],
        "x": 490,
        "y": 600,
        "wires": [
            [
                "f62427195cb0ab96"
            ]
        ],
        "l": true
    },
    {
        "id": "d3bb9cf4b0826a24",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "dashboard events",
        "links": [
            "0d7362ca2edd72c6"
        ],
        "x": 150,
        "y": 1180,
        "wires": [
            [
                "4ba3b5ace9fff3d0"
            ]
        ],
        "l": true
    },
    {
        "id": "c3c6a25a8238c2c5",
        "type": "switch",
        "z": "592b686edd11b813",
        "name": "client count 0",
        "property": "client_count",
        "propertyType": "msg",
        "rules": [
            {
                "t": "lte",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 355,
        "y": 1200,
        "wires": [
            [
                "4bc6a2d8f60ff88a"
            ]
        ],
        "l": false
    },
    {
        "id": "9234cc41d8a3f409",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "dashboard client count",
        "func": "var dashboard_client_count = global.get('dashboard_client_count')\nvar client_count = dashboard_client_count\nif (msg.payload == 'connect'){\n    client_count = dashboard_client_count + 1\n} else if (msg.payload == 'lost') {\n    if (dashboard_client_count > 0) client_count = dashboard_client_count - 1\n}\nglobal.set('dashboard_client_count', client_count);\nmsg.client_count = client_count;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 735,
        "y": 20,
        "wires": [
            [
                "0d7362ca2edd72c6"
            ]
        ],
        "l": false
    },
    {
        "id": "b6802fc260a8ce06",
        "type": "ui_text",
        "z": "592b686edd11b813",
        "group": "2201d496820b415d",
        "order": 9,
        "width": 3,
        "height": 1,
        "name": "upper",
        "label": "Upper Temp",
        "format": "<font color=\"orange\" size=\"+3\">{{msg.payload}}</font>",
        "layout": "col-center",
        "className": "",
        "x": 650,
        "y": 1020,
        "wires": []
    },
    {
        "id": "de9267cf7d7ed872",
        "type": "ui_text",
        "z": "592b686edd11b813",
        "group": "2201d496820b415d",
        "order": 7,
        "width": 3,
        "height": 1,
        "name": "lower",
        "label": "Lower Temp",
        "format": "<font color=\"orange\" size=\"+3\">{{msg.payload}}</font>",
        "layout": "col-center",
        "className": "",
        "x": 650,
        "y": 1040,
        "wires": []
    },
    {
        "id": "6553a2457e1b301e",
        "type": "comment",
        "z": "592b686edd11b813",
        "name": "PiSugar: https://github.com/PiSugar/pisugar-power-manager-rs",
        "info": "",
        "x": 370,
        "y": 1580,
        "wires": []
    },
    {
        "id": "157d8d2802690122",
        "type": "comment",
        "z": "592b686edd11b813",
        "name": "PiSugar user:admin pass:admin",
        "info": "",
        "x": 270,
        "y": 1600,
        "wires": []
    },
    {
        "id": "001d25c9084d4855",
        "type": "http in",
        "z": "592b686edd11b813",
        "name": "",
        "url": "/ui/PiSugar",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 220,
        "y": 1500,
        "wires": [
            [
                "23f7dd1d1126cae8"
            ]
        ]
    },
    {
        "id": "67da5f33484299fc",
        "type": "http response",
        "z": "592b686edd11b813",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 530,
        "y": 1500,
        "wires": []
    },
    {
        "id": "23f7dd1d1126cae8",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "var hostname = global.get('hostname')\nvar Location = \"http://\"+hostname.replace(/[^\\x20-\\x7E]/g, '')+\":8421\"\n\nmsg.statusCode = 303;\nmsg.headers = {Location}\ndelete msg.payload;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 1500,
        "wires": [
            [
                "67da5f33484299fc"
            ]
        ]
    },
    {
        "id": "8c3b80755b085d99",
        "type": "http in",
        "z": "592b686edd11b813",
        "name": "",
        "url": "/ui/NodeRed",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 210,
        "y": 1520,
        "wires": [
            [
                "7f69450907197558"
            ]
        ]
    },
    {
        "id": "2b1845b10613decf",
        "type": "http response",
        "z": "592b686edd11b813",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 530,
        "y": 1520,
        "wires": []
    },
    {
        "id": "7f69450907197558",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "var hostname = global.get('hostname')\nvar Location = \"http://\"+hostname.replace(/[^\\x20-\\x7E]/g, '')+\":1880\"\n\nmsg.statusCode = 303;\nmsg.headers = {Location}\ndelete msg.payload;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 1520,
        "wires": [
            [
                "2b1845b10613decf"
            ]
        ]
    },
    {
        "id": "22060442e0a5d3cc",
        "type": "http in",
        "z": "592b686edd11b813",
        "name": "",
        "url": "/ui/Grafana",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 220,
        "y": 1540,
        "wires": [
            [
                "af782d0fb0a5975e"
            ]
        ]
    },
    {
        "id": "97645d6a4b985196",
        "type": "http response",
        "z": "592b686edd11b813",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 530,
        "y": 1540,
        "wires": []
    },
    {
        "id": "af782d0fb0a5975e",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "var hostname = global.get('hostname')\nvar Location = \"http://\" + hostname.replace(/[^\\x20-\\x7E]/g, '') + \":3000\"\n//var Location = \"http://\"+hostname.replace(/[^\\x20-\\x7E]/g, '')+\":3000/d/_6ZBVeRgk/historical-temperatures?orgId=1&from=now-7d&to=now&fullscreen&panelId=4\"\n\nmsg.statusCode = 303;\nmsg.headers = { Location }\ndelete msg.payload;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 1540,
        "wires": [
            [
                "97645d6a4b985196"
            ]
        ]
    },
    {
        "id": "96518b72332bac16",
        "type": "comment",
        "z": "592b686edd11b813",
        "name": "web redirection",
        "info": "",
        "x": 100,
        "y": 1460,
        "wires": []
    },
    {
        "id": "67fd6dcf0c009872",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Oneshot Inject at Startup",
        "links": [
            "7fa2d20f4131fc60"
        ],
        "x": 335,
        "y": 20,
        "wires": [
            [
                "26aedf9d4f3e92fc"
            ]
        ],
        "icon": "node-red/timer.svg"
    },
    {
        "id": "3a10314de81e4ea3",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Oneshot Inject at Startup",
        "links": [
            "7fa2d20f4131fc60"
        ],
        "x": 475,
        "y": 560,
        "wires": [
            [
                "7dc828597fda8316"
            ]
        ],
        "icon": "node-red/timer.svg"
    },
    {
        "id": "b5bc3f51e5bd08f9",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Oneshot Inject at Startup",
        "links": [
            "7fa2d20f4131fc60"
        ],
        "x": 795,
        "y": 600,
        "wires": [
            [
                "9be32d3453fc15e7"
            ]
        ],
        "icon": "node-red/timer.svg"
    },
    {
        "id": "af50336fbc3029ac",
        "type": "switch",
        "z": "592b686edd11b813",
        "name": "",
        "property": "tab",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 235,
        "y": 880,
        "wires": [
            [
                "5716687e0139b841"
            ]
        ],
        "l": false
    },
    {
        "id": "5716687e0139b841",
        "type": "switch",
        "z": "592b686edd11b813",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "lost",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "connect",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "change",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 295,
        "y": 880,
        "wires": [
            [],
            [
                "4c5cb4d50d6fc7e2"
            ],
            [
                "4c5cb4d50d6fc7e2"
            ]
        ],
        "l": false
    },
    {
        "id": "3de872e32eb64a26",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "dashboard events",
        "links": [
            "0d7362ca2edd72c6"
        ],
        "x": 110,
        "y": 880,
        "wires": [
            [
                "af50336fbc3029ac"
            ]
        ],
        "l": true
    },
    {
        "id": "219b6df02966d0e3",
        "type": "ui_text",
        "z": "592b686edd11b813",
        "group": "2201d496820b415d",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Segment State",
        "format": "<font color='green'>{{msg.payload}}</font>",
        "layout": "row-center",
        "className": "",
        "x": 260,
        "y": 1020,
        "wires": []
    },
    {
        "id": "e5aec5149ce37d5d",
        "type": "ui_text",
        "z": "592b686edd11b813",
        "group": "2201d496820b415d",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Current Segment",
        "format": "<font color='green'>{{msg.payload}}</font>",
        "layout": "row-center",
        "className": "",
        "x": 270,
        "y": 1040,
        "wires": []
    },
    {
        "id": "f9d4fdfcb6abeb41",
        "type": "ui_text",
        "z": "592b686edd11b813",
        "group": "2201d496820b415d",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Soak Remaining",
        "format": "<font color='green'>{{msg.payload}} min</font>",
        "layout": "row-center",
        "className": "",
        "x": 260,
        "y": 1060,
        "wires": []
    },
    {
        "id": "2e9532e03f213fb4",
        "type": "ui_text",
        "z": "592b686edd11b813",
        "group": "2201d496820b415d",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Setpoint",
        "format": "<font color='green'>{{msg.payload}} °F</font>",
        "layout": "row-center",
        "className": "",
        "x": 240,
        "y": 1080,
        "wires": []
    },
    {
        "id": "8095bbd934bc130c",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - Current Segment State",
        "links": [
            "fb11495e37bdb84b"
        ],
        "x": 135,
        "y": 1020,
        "wires": [
            [
                "219b6df02966d0e3"
            ]
        ]
    },
    {
        "id": "1d2a7e1b14ed985d",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - current segment",
        "links": [
            "3ab377921817af3f"
        ],
        "x": 135,
        "y": 1040,
        "wires": [
            [
                "e5aec5149ce37d5d"
            ]
        ]
    },
    {
        "id": "bc808949af0e238a",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - Segment remaining",
        "links": [
            "355d9c4e737fdfe5",
            "9272078ab32e5e81",
            "f1d4774590c51f3d"
        ],
        "x": 135,
        "y": 1060,
        "wires": [
            [
                "f9d4fdfcb6abeb41"
            ]
        ]
    },
    {
        "id": "a8bc30bb3ce76d5e",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - Status Setpoint",
        "links": [
            "edf985d2d969c4b4"
        ],
        "x": 135,
        "y": 1080,
        "wires": [
            [
                "2e9532e03f213fb4"
            ]
        ]
    },
    {
        "id": "f43ac460b7c2ee29",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "initialize variables",
        "func": "var schedules = []\nvar schedulecount = 15\nfor (let index = 0; index < schedulecount; index++) {\n    var segments = []\n    var segmentcount = 1\n    for (let index1 = 0; index1 < segmentcount; index1++) {\n        var seg_obj = {name:'seg'+(index1+1),enabled:false,hold:false,setpoint:0,ramp_rate:0,soak_time:0}\n        var segment = Object.create(seg_obj)\n        segment.name='seg'+(index1+1)\n        segment.enabled=false\n        segment.hold=false\n        segment.setpoint=0\n        segment.ramp_rate=0\n        segment.soak_time=0\n        segments.push(segment)\n    }\n    schedules.push({name:'schedule'+(index+1),segments})\n}\nmsg.payload = schedules\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 535,
        "y": 20,
        "wires": [
            [
                "383fee56e61021c9",
                "299ae31393a123b3"
            ]
        ],
        "l": false
    },
    {
        "id": "e8334987f9343248",
        "type": "inject",
        "z": "592b686edd11b813",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 475,
        "y": 20,
        "wires": [
            [
                "f43ac460b7c2ee29"
            ]
        ],
        "l": false
    },
    {
        "id": "383fee56e61021c9",
        "type": "debug",
        "z": "592b686edd11b813",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 595,
        "y": 20,
        "wires": [],
        "l": false
    },
    {
        "id": "299ae31393a123b3",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "kiln_01.schedules",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 595,
        "y": 80,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "6b5cdf6cc5944a09",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "msg.payload = msg.payload.toFixed(2)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 555,
        "y": 1040,
        "wires": [
            [
                "de9267cf7d7ed872"
            ]
        ],
        "l": false
    },
    {
        "id": "0572ddcc3ec31a19",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "msg.payload = msg.payload.toFixed(2)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 555,
        "y": 1020,
        "wires": [
            [
                "b6802fc260a8ce06"
            ]
        ],
        "l": false
    },
    {
        "id": "0f56f86bd83c9233",
        "type": "finite-state-machine",
        "z": "e9cef8706a9cf7f6",
        "name": "Schedule",
        "fsmDefinition": "{\"state\":{\"status\":\"IDLE\",\"data\":{\"x\":99}},\"transitions\":{\"IDLE\":{\"run\":{\"status\":\"RUNNING\"},\"end\":{\"status\":\"IDLE\"}},\"STOPPING\":{\"end\":{\"status\":\"IDLE\"}},\"RUNNING\":{\"stop\":{\"status\":\"STOPPING\"}}}}",
        "sendInitialState": true,
        "sendStateWithoutChange": true,
        "showTransitionErrors": true,
        "x": 260,
        "y": 160,
        "wires": [
            [
                "2fc3804edce15c2a",
                "69c087d9cb1a75f4",
                "84a2b0552ff4b157"
            ]
        ]
    },
    {
        "id": "9001b19272cdde7c",
        "type": "catch",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 60,
        "y": 20,
        "wires": [
            [
                "82c478cdd58a5695"
            ]
        ]
    },
    {
        "id": "82c478cdd58a5695",
        "type": "debug",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 155,
        "y": 20,
        "wires": [],
        "l": false
    },
    {
        "id": "b92a5a9283774411",
        "type": "finite-state-machine",
        "z": "e9cef8706a9cf7f6",
        "name": "Segment",
        "fsmDefinition": "{\"state\":{\"status\":\"IDLE\",\"data\":{\"segment_data\":{\"elapsed_time\":0,\"max_temperature\":0},\"segment_settings\":{\"name\":\"\",\"enabled\":true,\"hold\":false,\"setpoint\":0,\"ramp_rate\":0,\"soak_time\":0}}},\"transitions\":{\"IDLE\":{\"end\":\"IDLE\",\"init\":\"INITIALIZING\",\"set\":\"IDLE\"},\"INITIALIZING\":{\"ramp\":\"RAMPING\",\"end\":\"IDLE\",\"set\":\"INITIALIZING\"},\"RAMPING\":{\"soak\":\"SOAKING\",\"hold\":\"HOLDING\",\"init\":\"INITIALIZING\",\"end\":\"IDLE\",\"set\":\"RAMPING\"},\"SOAKING\":{\"hold\":\"HOLDING\",\"ramp\":\"RAMPING\",\"init\":\"INITIALIZING\",\"end\":\"IDLE\",\"set\":\"SOAKING\"},\"HOLDING\":{\"ramp\":\"RAMPING\",\"init\":\"INITIALIZING\",\"end\":\"IDLE\",\"set\":\"HOLDING\"}}}",
        "sendInitialState": true,
        "sendStateWithoutChange": true,
        "showTransitionErrors": true,
        "x": 260,
        "y": 600,
        "wires": [
            [
                "4df2a1d5facc0bfb",
                "f3bfd11d3b3fad40",
                "2eb008bbf30d2804",
                "c214fb80818d8c8f",
                "6c6e56db4e40ac7d",
                "a846cb12c824f26b"
            ]
        ]
    },
    {
        "id": "defcc28b265151c2",
        "type": "link in",
        "z": "e9cef8706a9cf7f6",
        "name": "Input - Control Buttons",
        "links": [
            "084f011204f8cadc",
            "c03c7fb7458a9e9f"
        ],
        "x": 155,
        "y": 320,
        "wires": [
            [
                "334e3822e1c7c5ac"
            ]
        ]
    },
    {
        "id": "fb11495e37bdb84b",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "Output - Current Segment State",
        "mode": "link",
        "links": [
            "8095bbd934bc130c"
        ],
        "x": 475,
        "y": 620,
        "wires": []
    },
    {
        "id": "b33e0726c17b668b",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "Output - Current Schedule State",
        "mode": "link",
        "links": [
            "44901a155449dc95"
        ],
        "x": 455,
        "y": 120,
        "wires": []
    },
    {
        "id": "4df2a1d5facc0bfb",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "segment_settings",
                "pt": "msg",
                "to": "payload.data.segment_settings",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.status",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 415,
        "y": 620,
        "wires": [
            [
                "fb11495e37bdb84b"
            ]
        ],
        "l": false
    },
    {
        "id": "2fc3804edce15c2a",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.status",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 395,
        "y": 120,
        "wires": [
            [
                "b33e0726c17b668b"
            ]
        ],
        "l": false
    },
    {
        "id": "334e3822e1c7c5ac",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Start",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Stop",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 215,
        "y": 320,
        "wires": [
            [
                "1ed2d6a8bc75d663"
            ],
            [
                "0d25f4bbb98a1706"
            ]
        ],
        "l": false
    },
    {
        "id": "1ed2d6a8bc75d663",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "run",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "run",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 275,
        "y": 300,
        "wires": [
            [
                "819aacf3762935b7"
            ]
        ],
        "l": false
    },
    {
        "id": "0d25f4bbb98a1706",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "stop",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "stop",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 275,
        "y": 340,
        "wires": [
            [
                "819aacf3762935b7"
            ]
        ],
        "l": false
    },
    {
        "id": "6a57983382d3490e",
        "type": "link in",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "links": [
            "819aacf3762935b7",
            "c96334b38e278286",
            "af8f2e69ea9f27c2"
        ],
        "x": 155,
        "y": 160,
        "wires": [
            [
                "0f56f86bd83c9233"
            ]
        ]
    },
    {
        "id": "819aacf3762935b7",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "6a57983382d3490e"
        ],
        "x": 355,
        "y": 320,
        "wires": []
    },
    {
        "id": "81fb9a528731184e",
        "type": "link in",
        "z": "e9cef8706a9cf7f6",
        "name": "Input - Control Buttons",
        "links": [
            "c03c7fb7458a9e9f",
            "084f011204f8cadc"
        ],
        "x": 155,
        "y": 760,
        "wires": [
            [
                "66a35e0ed6e0c321"
            ]
        ]
    },
    {
        "id": "5b4645244b57514e",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Release",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Advance",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Hold",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 275,
        "y": 760,
        "wires": [
            [
                "12bfd2f54cfcaae9"
            ],
            [
                "12bfd2f54cfcaae9"
            ],
            [
                "e5d4e9ed610e164f"
            ]
        ],
        "l": false
    },
    {
        "id": "fdfa744fcee6a3dd",
        "type": "link in",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "links": [
            "338986178aea2e9e",
            "2e45cc4d57a385c0",
            "edb935f4183746b0",
            "7ab1dfdba11abf46",
            "5b05096dea13f2c2",
            "94a351c8d74cd63c",
            "20db894294ad2264",
            "48e55a20a9c39344"
        ],
        "x": 155,
        "y": 600,
        "wires": [
            [
                "b92a5a9283774411"
            ]
        ]
    },
    {
        "id": "84a2b0552ff4b157",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "STOPPING",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "STARTING",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "RUNNING",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "IDLE",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 4,
        "x": 395,
        "y": 200,
        "wires": [
            [
                "6348c0ed609dce8b"
            ],
            [],
            [
                "0c385503f68c2897",
                "2d50278b266fca54"
            ],
            [
                "04cf21296804ae19",
                "b692ebb29e65c022"
            ]
        ],
        "l": false
    },
    {
        "id": "c214fb80818d8c8f",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "IDLE",
                "vt": "str"
            },
            {
                "t": "neq",
                "v": "IDLE",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "INITIALIZING",
                "vt": "str"
            },
            {
                "t": "neq",
                "v": "INITIALIZING",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 4,
        "x": 475,
        "y": 560,
        "wires": [
            [
                "26a5dc0ca7be4550"
            ],
            [],
            [
                "d73d6c1dd682f172"
            ],
            []
        ],
        "l": false
    },
    {
        "id": "edb935f4183746b0",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "fdfa744fcee6a3dd",
            "c70cd7dd26e8bb29"
        ],
        "x": 715,
        "y": 200,
        "wires": []
    },
    {
        "id": "0c385503f68c2897",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "set segment settings and start segment ramp",
        "func": "\nvar active_schedule_index = global.get('kiln_01.active_schedule_index');\nvar active_schedule = global.get('kiln_01.schedules['+ active_schedule_index + ']')\nglobal.set('kiln_01.active_schedule', active_schedule);\n\nvar topic = \"init\"\nvar segment_settings = global.get('kiln_01.active_schedule.segments[0]')\nvar data = {segment_settings}\n\nvar msg_out = {topic,data}\n\nglobal.set('kiln_01.active_segment_index', 0)\n\nreturn msg_out;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 495,
        "y": 200,
        "wires": [
            [
                "edb935f4183746b0"
            ]
        ],
        "l": false
    },
    {
        "id": "f3bfd11d3b3fad40",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.data.segment_settings.setpoint",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "#:(memoryOnly)::kiln_01.Setpoint",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 415,
        "y": 640,
        "wires": [
            [
                "edf985d2d969c4b4"
            ]
        ],
        "l": false
    },
    {
        "id": "edf985d2d969c4b4",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "a8bc30bb3ce76d5e"
        ],
        "x": 475,
        "y": 640,
        "wires": []
    },
    {
        "id": "b209d1c9da6cb3c2",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "end and clear segment settings",
        "func": "global.set('kiln_01.UpperSetpoint', 0, 'memoryOnly')\nglobal.set('kiln_01.LowerSetpoint', 0, 'memoryOnly')\n\nvar topic = \"end\"\nvar segment_settings = {\"name\":\"\",\"enabled\":false,\"hold\":false,\"setpoint\":0,\"ramp_rate\":0,\"soak_time\":0}\nvar data = {segment_settings}\n\nvar msg_out = {topic,data}\n\nreturn msg_out;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 655,
        "y": 180,
        "wires": [
            [
                "edb935f4183746b0"
            ]
        ],
        "l": false
    },
    {
        "id": "2d50278b266fca54",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "disable the schedule selection when running",
        "rules": [
            {
                "t": "set",
                "p": "enabled",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "kiln_01.active_schedule_index",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 495,
        "y": 220,
        "wires": [
            [
                "7b896f97e70ee242"
            ]
        ],
        "l": false
    },
    {
        "id": "04cf21296804ae19",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "enable the schedule selection when idle",
        "rules": [
            {
                "t": "set",
                "p": "enabled",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "kiln_01.active_schedule_index",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 495,
        "y": 240,
        "wires": [
            [
                "7b896f97e70ee242"
            ]
        ],
        "l": false
    },
    {
        "id": "7b896f97e70ee242",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "Output - enable/disable schedule selection",
        "mode": "link",
        "links": [
            "85642d7408d49cd8"
        ],
        "x": 575,
        "y": 240,
        "wires": []
    },
    {
        "id": "7ab1dfdba11abf46",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "fdfa744fcee6a3dd"
        ],
        "x": 1135,
        "y": 740,
        "wires": []
    },
    {
        "id": "ec192310dbd48cdd",
        "type": "link in",
        "z": "e9cef8706a9cf7f6",
        "name": "stop or advance",
        "links": [
            "12bfd2f54cfcaae9",
            "d30ec35d1e580d54",
            "4205218abe56d8f3"
        ],
        "x": 1015,
        "y": 720,
        "wires": [
            [
                "b17e75bc51a86d9f"
            ]
        ]
    },
    {
        "id": "12bfd2f54cfcaae9",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "ec192310dbd48cdd"
        ],
        "x": 355,
        "y": 740,
        "wires": []
    },
    {
        "id": "c96334b38e278286",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "4840d3b8dd483cff",
            "53681c7211103452",
            "6a57983382d3490e",
            "7b45f7ccea553769",
            "60a14bb9ad4c6918"
        ],
        "x": 1135,
        "y": 700,
        "wires": []
    },
    {
        "id": "73d963005cc1351a",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "disable the release button",
        "rules": [
            {
                "t": "set",
                "p": "enabled",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 815,
        "y": 740,
        "wires": [
            [
                "f59050e178b63b1a"
            ]
        ],
        "l": false
    },
    {
        "id": "717c700de0abd324",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "enable the release button",
        "rules": [
            {
                "t": "set",
                "p": "enabled",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 815,
        "y": 700,
        "wires": [
            [
                "f59050e178b63b1a"
            ]
        ],
        "l": false
    },
    {
        "id": "f59050e178b63b1a",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "Output - enable/disable release button",
        "mode": "link",
        "links": [
            "87d7118f46499bc1"
        ],
        "x": 895,
        "y": 720,
        "wires": []
    },
    {
        "id": "b17e75bc51a86d9f",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "stop schedule or advance",
        "func": "var UpperTemperature = global.get('kiln_01.UpperTemperature', 'memoryOnly')\nvar LowerTemperature = global.get('kiln_01.LowerTemperature', 'memoryOnly')\nvar Setpoint = global.get('kiln_01.Setpoint', 'memoryOnly')\nvar UpperSetpoint = global.get('kiln_01.UpperSetpoint', 'memoryOnly')\nvar LowerSetpoint = global.get('kiln_01.LowerSetpoint', 'memoryOnly')\nvar ControlAction = global.get('kiln_01.ControlAction', 'memoryOnly')\nvar active_schedule = global.get('kiln_01.active_schedule')\nvar segment_count = active_schedule.segments.length\nvar active_segment_index = global.get('kiln_01.active_segment_index')\nvar topic\nvar payload\nvar rate\nvar action\nvar segment_settings\nvar data\nvar msg_out\nvar temps_at_setpoint = global.get('kiln_01.SetpointReached', 'memoryOnly')\n//var tolerance = 20 // degrees\n//var temps_at_setpoint =  (ControlAction == 'heating' && UpperTemperature >= (Setpoint - tolerance) && LowerTemperature >= (Setpoint - tolerance)) \n//                        ||(ControlAction == 'cooling' && UpperTemperature <= (Setpoint + tolerance) && LowerTemperature <= (Setpoint + tolerance))\n\n// check if temps have been reached or advance is commanded\nif ((temps_at_setpoint && msg.payload == 'Release') ||\n    msg.payload == 'Advance'){\n\n    if (segment_count - 1 > active_segment_index) {\n        // advance to next segment\n        active_segment_index = active_segment_index + 1\n        global.set('kiln_01.active_segment_index', active_segment_index)\n        segment_settings = active_schedule.segments[active_segment_index]\n        data = {segment_settings}\n        topic = \"init\"\n        msg_out = {topic,data}\n        return [null,msg_out]\n    } else {\n        // end the schedule\n        topic = \"stop\"\n        payload = 0 // this will go to PID setpoints\n        rate = 0\n        action = \"Off\"\n        msg_out = {topic, payload, rate, action}\n        return [msg_out,null]\n    }\n    \n} else { // continue and try to reach temps\n    topic = \"ramp\"\n    msg_out = {topic}\n    return [null,msg_out]\n}",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1075,
        "y": 720,
        "wires": [
            [
                "c96334b38e278286"
            ],
            [
                "7ab1dfdba11abf46"
            ]
        ],
        "l": false
    },
    {
        "id": "f1169a5a0d122c16",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "check segment enabled",
        "property": "payload.data.segment_settings.enabled",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 815,
        "y": 560,
        "wires": [
            [
                "4449d819d876d690",
                "6621e559cca764ed",
                "585e8b1656cbef91"
            ],
            [
                "14cf0c63e8349ec6"
            ]
        ],
        "l": false
    },
    {
        "id": "3ab377921817af3f",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "Output - active segment",
        "mode": "link",
        "links": [
            "1d2a7e1b14ed985d"
        ],
        "x": 475,
        "y": 660,
        "wires": []
    },
    {
        "id": "2eb008bbf30d2804",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "show active segment",
        "func": "var active_schedule = global.get('kiln_01.active_schedule')\nvar segment_count = active_schedule.segments.length\nvar active_segment_index = global.get('kiln_01.active_segment_index')\nactive_segment_index++\n\nif (msg.payload.status === 'IDLE') {\n    msg.payload = '0 of ' + segment_count.toString()\n} else {\n    msg.payload = active_segment_index.toString() + ' of ' + segment_count.toString()\n}\n\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 415,
        "y": 660,
        "wires": [
            [
                "3ab377921817af3f"
            ]
        ],
        "l": false
    },
    {
        "id": "26a5dc0ca7be4550",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "end",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "end",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "rate",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "action",
                "pt": "msg",
                "to": "Off",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 555,
        "y": 540,
        "wires": [
            [
                "af8f2e69ea9f27c2"
            ]
        ],
        "l": false
    },
    {
        "id": "6348c0ed609dce8b",
        "type": "trigger",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "-250",
        "extend": false,
        "overrideDelay": false,
        "units": "ms",
        "reset": "IDLE",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 595,
        "y": 180,
        "wires": [
            [
                "b209d1c9da6cb3c2"
            ]
        ],
        "l": false
    },
    {
        "id": "af8f2e69ea9f27c2",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "4840d3b8dd483cff",
            "53681c7211103452",
            "6a57983382d3490e",
            "7b45f7ccea553769",
            "60a14bb9ad4c6918"
        ],
        "x": 615,
        "y": 540,
        "wires": []
    },
    {
        "id": "0afd5835b34c3f7e",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "check soak",
        "func": "var SoakTime = msg.payload.data.segment_settings.soak_time\n\nif (SoakTime > 0) {\n    msg.delay = SoakTime * 1000 * 60 // convert min to milliseconds\n    msg.topic = \"soak\"\n    return [null,msg];\n} else {\n    return [msg,null];\n}",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 860,
        "wires": [
            [
                "93a841c73beae51f"
            ],
            [
                "5e52028c66e776b3"
            ]
        ],
        "outputLabels": [
            "advance",
            "soak"
        ],
        "l": false
    },
    {
        "id": "6cfcbd486aa01dca",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "check temps and start soak",
        "func": "var UpperTemperature = global.get('kiln_01.UpperTemperature', 'memoryOnly')\nvar LowerTemperature = global.get('kiln_01.LowerTemperature', 'memoryOnly')\n//var Setpoint = global.get('kiln_01.Setpoint', 'memoryOnly')\nvar ControlAction = global.get('kiln_01.ControlAction', 'memoryOnly')\nvar Setpoint = msg.payload.data.segment_settings.setpoint\nvar RampRate = msg.payload.data.segment_settings.ramp_rate // per hour\nvar Tolerance = Setpoint - Setpoint * 0.998 // 0.2%\n\n// check if temps have been reached\n// TODO: add a confidence timer here to filter out spikes in temp\nif ((ControlAction == 'heating' \n    && UpperTemperature >= (Setpoint - Tolerance) \n    && LowerTemperature >= (Setpoint - Tolerance)) || \n    (ControlAction == 'cooling' \n    && UpperTemperature <= (Setpoint + Tolerance) \n    && LowerTemperature <= (Setpoint + Tolerance))){\n        global.set('kiln_01.SetpointReached', true, 'memoryOnly')\n        global.set('kiln_01.ControlAction', 'maintaining', 'memoryOnly')\n        msg.topic = 'soak'\n        msg.payload = Setpoint\n        msg.rate = RampRate\n        msg.action = 'maintaining'\n        return [msg, msg, msg];\n}\nif ((ControlAction == 'heating' \n    && UpperTemperature >= (Setpoint - Tolerance)) || \n    (ControlAction == 'cooling' \n    && UpperTemperature <= (Setpoint + Tolerance))){\n        msg.payload = Setpoint\n        msg.rate = RampRate\n        msg.action = 'maintaining'\n        return [null, msg, null];\n}\nif ((ControlAction == 'heating' \n    && LowerTemperature >= (Setpoint - Tolerance)) || \n    (ControlAction == 'cooling' \n    && LowerTemperature <= (Setpoint + Tolerance))){\n        msg.payload = Setpoint\n        msg.rate = RampRate\n        msg.action = 'maintaining'\n        return [null, null, msg];\n}",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1035,
        "y": 460,
        "wires": [
            [
                "20db894294ad2264"
            ],
            [
                "91b7c42203f31df4"
            ],
            [
                "2529ef781a84b687"
            ]
        ],
        "l": false
    },
    {
        "id": "6202fbcb0c1e1b73",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "set active schedule",
        "rules": [
            {
                "t": "set",
                "p": "kiln_01.active_schedule",
                "pt": "global",
                "to": "kiln_01.schedules[0]",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 395,
        "y": 20,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "93a841c73beae51f",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "check hold",
        "func": "var HoldEnabled = msg.payload.data.segment_settings.hold\n\nif (HoldEnabled) {\n    msg.topic = 'hold';\n    return [null,msg];\n} else {\n    msg.payload = 'Advance'\n    return [msg,null];\n}",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1095,
        "y": 860,
        "wires": [
            [
                "4205218abe56d8f3"
            ],
            [
                "48e55a20a9c39344"
            ]
        ],
        "outputLabels": [
            "advance",
            "hold"
        ],
        "l": false
    },
    {
        "id": "d73d6c1dd682f172",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "ramp",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "ramp",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 555,
        "y": 580,
        "wires": [
            [
                "5b05096dea13f2c2"
            ]
        ],
        "l": false
    },
    {
        "id": "5b05096dea13f2c2",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "fdfa744fcee6a3dd"
        ],
        "x": 615,
        "y": 580,
        "wires": []
    },
    {
        "id": "e5d4e9ed610e164f",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "hold",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "hold",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 355,
        "y": 780,
        "wires": [
            [
                "94a351c8d74cd63c"
            ]
        ],
        "l": false
    },
    {
        "id": "94a351c8d74cd63c",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "fdfa744fcee6a3dd"
        ],
        "x": 415,
        "y": 780,
        "wires": []
    },
    {
        "id": "c70cd7dd26e8bb29",
        "type": "link in",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "links": [
            "edb935f4183746b0"
        ],
        "x": 675,
        "y": 280,
        "wires": [
            [
                "dc2c386dedaeed7e"
            ]
        ]
    },
    {
        "id": "dc2c386dedaeed7e",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "get ramp rate",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "data.segment_settings.ramp_rate",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 735,
        "y": 280,
        "wires": [
            [
                "233d081ef7b67749"
            ]
        ],
        "l": false
    },
    {
        "id": "233d081ef7b67749",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "Output - ramp rate",
        "mode": "link",
        "links": [
            "899c85f172cb1839"
        ],
        "x": 795,
        "y": 280,
        "wires": []
    },
    {
        "id": "be296861cf96f889",
        "type": "delay",
        "z": "e9cef8706a9cf7f6",
        "name": "Soak Timer",
        "pauseType": "delayv",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 955,
        "y": 900,
        "wires": [
            [
                "b2be957b0b8f3b28"
            ]
        ],
        "l": false
    },
    {
        "id": "b2be957b0b8f3b28",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "done",
        "property": "remaining_milliseconds",
        "propertyType": "msg",
        "rules": [
            {
                "t": "lte",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "gt",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1015,
        "y": 900,
        "wires": [
            [
                "93a841c73beae51f"
            ],
            [
                "57da66cbb8664644"
            ]
        ],
        "l": false
    },
    {
        "id": "57da66cbb8664644",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "status",
        "func": "var time\n\nif (!msg.reset){\n    msg.remaining_milliseconds = msg.remaining_milliseconds - 1000\n    if (msg.remaining_milliseconds <= 0) {\n        msg.delay = 0;\n        msg.flush = true;\n    }\n} else {\n    msg.remaining_milliseconds = 0\n}\n\ntime = { minutes: msg.remaining_milliseconds / 1000.0 / 60.0, seconds: msg.remaining_milliseconds / 1000.0, milliseconds: msg.remaining_milliseconds };\ntime.minutes = time.minutes.toFixed(2);\ntime.seconds = time.seconds.toFixed(2);\ntime.milliseconds = time.milliseconds.toFixed(2);\n\nif (time.milliseconds >= 0){\n    return [msg,time];\n} else {\n    return [msg,null];\n}",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 955,
        "y": 940,
        "wires": [
            [
                "be296861cf96f889"
            ],
            [
                "dbbb8ea68ee4121f"
            ]
        ],
        "l": false
    },
    {
        "id": "5e52028c66e776b3",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "start",
        "rules": [
            {
                "t": "set",
                "p": "remaining_milliseconds",
                "pt": "msg",
                "to": "delay",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "1000",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 875,
        "y": 900,
        "wires": [
            [
                "be296861cf96f889"
            ]
        ],
        "l": false
    },
    {
        "id": "b79bc4ea4760e612",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "reset",
        "rules": [
            {
                "t": "set",
                "p": "remaining_milliseconds",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 875,
        "y": 940,
        "wires": [
            [
                "57da66cbb8664644"
            ]
        ],
        "l": false
    },
    {
        "id": "cb32bc877d76c6f3",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "custom timer with status output",
        "info": "",
        "x": 970,
        "y": 920,
        "wires": []
    },
    {
        "id": "dbbb8ea68ee4121f",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "send minutes",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "minutes",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1035,
        "y": 940,
        "wires": [
            [
                "f1d4774590c51f3d"
            ]
        ],
        "l": false
    },
    {
        "id": "f1d4774590c51f3d",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "status",
        "mode": "link",
        "links": [
            "bc808949af0e238a"
        ],
        "x": 1095,
        "y": 940,
        "wires": []
    },
    {
        "id": "69c087d9cb1a75f4",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "func": "if (msg.topic == 'state') {\n    global.set('kiln_01.FsmStatus_Schedule', msg.payload.status, 'memoryOnly')\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 395,
        "y": 140,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "6c6e56db4e40ac7d",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "func": "if (msg.topic == 'state') {\n    global.set('kiln_01.FsmStatus_Segment', msg.payload.status, 'memoryOnly')\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 415,
        "y": 680,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "48e55a20a9c39344",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "fdfa744fcee6a3dd"
        ],
        "x": 1155,
        "y": 880,
        "wires": []
    },
    {
        "id": "d30ec35d1e580d54",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "ec192310dbd48cdd"
        ],
        "x": 935,
        "y": 580,
        "wires": []
    },
    {
        "id": "4205218abe56d8f3",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "ec192310dbd48cdd"
        ],
        "x": 1155,
        "y": 840,
        "wires": []
    },
    {
        "id": "a2e12771c467bedb",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "SOAKING",
                "vt": "str"
            },
            {
                "t": "neq",
                "v": "SOAKING",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 735,
        "y": 900,
        "wires": [
            [
                "0afd5835b34c3f7e"
            ],
            [
                "b79bc4ea4760e612"
            ]
        ],
        "l": false
    },
    {
        "id": "7debe7ed67a097f5",
        "type": "link in",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "links": [
            "a846cb12c824f26b"
        ],
        "x": 675,
        "y": 900,
        "wires": [
            [
                "a2e12771c467bedb"
            ]
        ]
    },
    {
        "id": "40014b96c9ae727f",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "soaking logic",
        "info": "",
        "x": 730,
        "y": 820,
        "wires": []
    },
    {
        "id": "a846cb12c824f26b",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "7debe7ed67a097f5",
            "57f37c997ce9b505",
            "df378f817d41c61d"
        ],
        "x": 415,
        "y": 560,
        "wires": []
    },
    {
        "id": "57f37c997ce9b505",
        "type": "link in",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "links": [
            "a846cb12c824f26b"
        ],
        "x": 675,
        "y": 720,
        "wires": [
            [
                "5b0d8dc236de50a5"
            ]
        ]
    },
    {
        "id": "5b0d8dc236de50a5",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "HOLDING",
                "vt": "str"
            },
            {
                "t": "neq",
                "v": "HOLDING",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 755,
        "y": 720,
        "wires": [
            [
                "717c700de0abd324",
                "6c4b614fba70c14d"
            ],
            [
                "73d963005cc1351a"
            ]
        ],
        "l": false
    },
    {
        "id": "88d1596c700f5ab1",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "holding logic",
        "info": "",
        "x": 730,
        "y": 660,
        "wires": []
    },
    {
        "id": "df378f817d41c61d",
        "type": "link in",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "links": [
            "a846cb12c824f26b"
        ],
        "x": 675,
        "y": 540,
        "wires": [
            [
                "da94c6de412c0890"
            ]
        ]
    },
    {
        "id": "da94c6de412c0890",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "RAMPING",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "RAMPING",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 735,
        "y": 540,
        "wires": [
            [
                "2293ffac501997ba"
            ],
            [
                "f1169a5a0d122c16"
            ]
        ],
        "l": false
    },
    {
        "id": "3207fc059e95ca8d",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "ramping logic",
        "info": "",
        "x": 730,
        "y": 480,
        "wires": []
    },
    {
        "id": "ef9ca1c1540d2a09",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "transition logic",
        "info": "",
        "x": 1080,
        "y": 660,
        "wires": []
    },
    {
        "id": "6621e559cca764ed",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "get ramp rate",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.data.segment_settings.ramp_rate",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 975,
        "y": 500,
        "wires": [
            [
                "c5180a0a450ebd11"
            ]
        ],
        "l": false
    },
    {
        "id": "c5180a0a450ebd11",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "Output - ramp rate",
        "mode": "link",
        "links": [
            "899c85f172cb1839"
        ],
        "x": 1035,
        "y": 500,
        "wires": []
    },
    {
        "id": "88183c4473e0f66d",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "buttons",
        "info": "",
        "x": 190,
        "y": 700,
        "wires": []
    },
    {
        "id": "65289c32824bc573",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "buttons",
        "info": "",
        "x": 190,
        "y": 260,
        "wires": []
    },
    {
        "id": "b692ebb29e65c022",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 495,
        "y": 280,
        "wires": [
            [
                "6348c0ed609dce8b"
            ]
        ],
        "l": false
    },
    {
        "id": "14cf0c63e8349ec6",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "segment is disabled so advance to next",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Advance",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 875,
        "y": 580,
        "wires": [
            [
                "d30ec35d1e580d54"
            ]
        ],
        "l": false
    },
    {
        "id": "6c4b614fba70c14d",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "b7e67964f0dbbbd9"
        ],
        "x": 895,
        "y": 680,
        "wires": []
    },
    {
        "id": "66a35e0ed6e0c321",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "property": "#:(memoryOnly)::kiln_01.FsmStatus_Schedule",
        "propertyType": "global",
        "rules": [
            {
                "t": "neq",
                "v": "IDLE",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 215,
        "y": 760,
        "wires": [
            [
                "5b4645244b57514e"
            ]
        ],
        "l": false
    },
    {
        "id": "b7093a504612f6ed",
        "type": "link in",
        "z": "e9cef8706a9cf7f6",
        "name": "Oneshot Inject at Startup",
        "links": [
            "7fa2d20f4131fc60"
        ],
        "x": 335,
        "y": 20,
        "wires": [
            [
                "6202fbcb0c1e1b73"
            ]
        ],
        "icon": "node-red/timer.svg"
    },
    {
        "id": "834f8abdb0f8da62",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "schedule state machine",
        "info": "",
        "x": 140,
        "y": 80,
        "wires": []
    },
    {
        "id": "81a6d243dc3cf8d3",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "segment state machine",
        "info": "",
        "x": 140,
        "y": 480,
        "wires": []
    },
    {
        "id": "9715dba2fc1ab553",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "53681c7211103452",
            "7b45f7ccea553769"
        ],
        "x": 1035,
        "y": 540,
        "wires": []
    },
    {
        "id": "6f66fd670975be35",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "4840d3b8dd483cff",
            "60a14bb9ad4c6918"
        ],
        "x": 1035,
        "y": 580,
        "wires": []
    },
    {
        "id": "20db894294ad2264",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "fdfa744fcee6a3dd"
        ],
        "x": 1105,
        "y": 440,
        "wires": []
    },
    {
        "id": "585e8b1656cbef91",
        "type": "trigger",
        "z": "e9cef8706a9cf7f6",
        "name": "Monitor temperature",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-1",
        "extend": false,
        "overrideDelay": true,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 975,
        "y": 460,
        "wires": [
            [
                "6cfcbd486aa01dca",
                "226505f50e89b6e7"
            ]
        ],
        "l": false
    },
    {
        "id": "2293ffac501997ba",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "Reset trigger",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 815,
        "y": 520,
        "wires": [
            [
                "585e8b1656cbef91"
            ]
        ],
        "l": false
    },
    {
        "id": "4449d819d876d690",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "check temps and start soak",
        "func": "var UpperTemperature = global.get('kiln_01.UpperTemperature', 'memoryOnly')\nvar LowerTemperature = global.get('kiln_01.LowerTemperature', 'memoryOnly')\nvar AverageTemperature = (UpperTemperature + LowerTemperature) / 2.0\nvar Setpoint = msg.payload.data.segment_settings.setpoint\nvar RampRate = msg.payload.data.segment_settings.ramp_rate // per hour\nvar ControlAction\n\nif (AverageTemperature > Setpoint) {\n    ControlAction = 'cooling'\n    RampRate = RampRate * -1 // change sign so pid controller ramps down\n} else {\n    ControlAction = 'heating'\n}\n\nglobal.set('kiln_01.ControlAction', ControlAction, 'memoryOnly')\nglobal.set('kiln_01.SetpointReached', false, 'memoryOnly')\n\nvar msg1 = { payload: Setpoint, rate: RampRate, action: ControlAction }\nvar msg2 = { payload: Setpoint, rate: RampRate, action: ControlAction }\n\nreturn [msg1, msg2];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 975,
        "y": 560,
        "wires": [
            [
                "9715dba2fc1ab553"
            ],
            [
                "6f66fd670975be35"
            ]
        ],
        "l": false
    },
    {
        "id": "91b7c42203f31df4",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "53681c7211103452",
            "7b45f7ccea553769"
        ],
        "x": 1105,
        "y": 460,
        "wires": []
    },
    {
        "id": "2529ef781a84b687",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "4840d3b8dd483cff",
            "60a14bb9ad4c6918"
        ],
        "x": 1105,
        "y": 480,
        "wires": []
    },
    {
        "id": "226505f50e89b6e7",
        "type": "debug",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1130,
        "y": 340,
        "wires": []
    },
    {
        "id": "2f19129886721298",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "initialize variables",
        "func": "/*var input = []\nvar inputcount = 2\nfor (let index = 0; index < inputcount; index++) {\n    var x = { min: 0.0, max: 0.0 };\n    var y = { min: 0.0, max: 0.0 };\n    var calibration = { x, y, span: 0.0, offset: 0.0 }\n    calibration.x.min = 0.0; calibration.x.max = 0.0; calibration.y.min = 0.0; calibration.y.max = 0.0;\n    calibration.span = 0.0; calibration.offset = 0.0;\n    var obj2 = { HiHi: 0.0, Hi: 0.0, Lo: 0.0, LoLo: 0.0 }\n    var limits = Object.create(obj2)\n    limits.HiHi = 0.0; limits.Hi = 0.0; limits.Lo = 0.0; limits.LoLo = 0.0;\n    var obj3 = { HiHi: false, Hi: false, Lo: false, LoLo: false }\n    var alarms = Object.create(obj3)\n    alarms.HiHi = false; alarms.Hi = false; alarms.Lo = false; alarms.LoLo = false;\n    input.push({ id: '', raw: 0.0, scaled: 0.0, calibration, limits, alarms })\n}\nvar analoginput = { selected_input: 0, input }\n//global.set('analoginput', analoginput, 'memoryOnly')\nglobal.set('analoginput', analoginput)\nmsg.payload = { analoginput }\nreturn msg;*/",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 535,
        "y": 20,
        "wires": [
            [
                "dfa00176a8aa4236"
            ]
        ],
        "l": false
    },
    {
        "id": "aecfb76003773780",
        "type": "inject",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 475,
        "y": 20,
        "wires": [
            [
                "2f19129886721298"
            ]
        ],
        "l": false
    },
    {
        "id": "dfa00176a8aa4236",
        "type": "debug",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 595,
        "y": 20,
        "wires": [],
        "l": false
    },
    {
        "id": "0d21e53eb5db0544",
        "type": "catch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 60,
        "y": 20,
        "wires": [
            [
                "3e7097f5bd1c065c"
            ]
        ]
    },
    {
        "id": "3e7097f5bd1c065c",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 155,
        "y": 20,
        "wires": [],
        "l": false
    },
    {
        "id": "9f8f243cf0171822",
        "type": "PID",
        "z": "b83fb43068cdf48f",
        "name": "",
        "setpoint": "0",
        "pb": 1,
        "ti": 9999,
        "td": 0,
        "integral_default": 0.5,
        "smooth_factor": 3,
        "max_interval": 600,
        "enable": 1,
        "disabled_op": 0,
        "x": 205,
        "y": 240,
        "wires": [
            [
                "79e8d734b498031e"
            ]
        ],
        "l": false
    },
    {
        "id": "70c0bc1ae3c6d12d",
        "type": "pid-autotune",
        "z": "b83fb43068cdf48f",
        "name": "",
        "outstep": 100,
        "maxout": 100,
        "lookback": 30,
        "setpoint": "setpoint",
        "setpointType": "msg",
        "tempVariable": "payload",
        "tempVariableType": "msg",
        "tempVariableMsgTopic": "temp-BK",
        "autoStart": "false",
        "triggeredStartValue": "start",
        "x": 215,
        "y": 620,
        "wires": [
            [
                "7fa4d2bb4f6f7d6d",
                "1f4cc5c39e564a05"
            ],
            [
                "4f6c495a3f7424e0",
                "5e6821a08b748efd"
            ],
            [
                "7e795aafec1fe140",
                "e0212f99f8fa6abc"
            ]
        ],
        "l": false
    },
    {
        "id": "7fa4d2bb4f6f7d6d",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 275,
        "y": 580,
        "wires": [],
        "l": false
    },
    {
        "id": "7e795aafec1fe140",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 275,
        "y": 660,
        "wires": [],
        "l": false
    },
    {
        "id": "fcf34e6662f8df35",
        "type": "inject",
        "z": "b83fb43068cdf48f",
        "name": "start",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 75,
        "y": 580,
        "wires": [
            [
                "27787572425fc29d"
            ]
        ],
        "l": false
    },
    {
        "id": "4e3a914816059153",
        "type": "inject",
        "z": "b83fb43068cdf48f",
        "name": "stop",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 75,
        "y": 620,
        "wires": [
            [
                "c3273409af651b10"
            ]
        ],
        "l": false
    },
    {
        "id": "92ddf9e5188bd64e",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "process in",
        "links": [
            "bee9b0aaa92de05c",
            "b533e4fa8c93b24a",
            "5793f419da2fa866",
            "3cd6ce4406cb6bbc"
        ],
        "x": 55,
        "y": 680,
        "wires": [
            [
                "4753b7a6881b7b3c",
                "2983d3178fa2d2ea"
            ]
        ]
    },
    {
        "id": "27787572425fc29d",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].autotune.active', true)\nmsg.setpoint = global.get('pid.zone[' + selected_zone + '].autotune.setpoint') || 0\nmsg.topic = 'temp-BK'\nmsg.cmd = 'start'\nmsg.payload = 0\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 135,
        "y": 580,
        "wires": [
            [
                "70c0bc1ae3c6d12d",
                "94caaeb1c8b9263b"
            ]
        ],
        "l": false
    },
    {
        "id": "c3273409af651b10",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].autotune.active', false)\nmsg.cmd = 'stop'\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 135,
        "y": 620,
        "wires": [
            [
                "70c0bc1ae3c6d12d"
            ]
        ],
        "l": false
    },
    {
        "id": "1f4cc5c39e564a05",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nvar selected_action = global.get('pid.selected_action') || 0 // 'heating', 'cooling', 'maintaining'\nglobal.set('pid.zone[' + selected_zone + '].autotune.active', false)\n\nif (msg.state == 'succeeded') {\n    global.set('pid.zone[' + selected_zone + '].settings.' + selected_action + '.gain.Kp', msg.payload.Kp)\n    global.set('pid.zone[' + selected_zone + '].settings.' + selected_action + '.gain.Ki', msg.payload.Ki)\n    global.set('pid.zone[' + selected_zone + '].settings.' + selected_action + '.gain.Kd', msg.payload.Kd)\n} \n\nvar msg_out = { enabled: true } // enable any dashboard ui\nreturn msg_out",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 275,
        "y": 580,
        "wires": [
            [
                "ba4e7459b18e1a54"
            ]
        ],
        "l": false
    },
    {
        "id": "b0cf339b6f16ca16",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "init",
        "rules": [
            {
                "t": "set",
                "p": "pid.selected_zone",
                "pt": "global",
                "to": "0",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "pid.zone[0].autotune.active",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "pid.zone[1].autotune.active",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 395,
        "y": 20,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "fc98fd801ee9ea69",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 315,
        "y": 180,
        "wires": [],
        "l": false
    },
    {
        "id": "1f1e287e7011feb5",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "pid.zone[0].parameters.process",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 315,
        "y": 140,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "edf4d60398ebee66",
        "type": "ui_chart",
        "z": "b83fb43068cdf48f",
        "name": "",
        "group": "a91f3f1520863187",
        "order": 8,
        "width": 14,
        "height": 5,
        "label": "",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "bezier",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#2ba02b",
            "#ff9300",
            "#ff2600",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 785,
        "y": 1120,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "2ba532e7faaaf05f",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "clear chart",
        "func": "//var msg_out = {\"payload\":[{\"series\":[],\"data\":[],\"labels\":[]}]};\n\n//var series_data0 = [];\n//var series_data1 = [];\n\n//var data_array = [];\n//data_array[0] = series_data0\n//data_array[1] = series_data1\n\n// \n//msg_out.payload[0].data = data_array\n\n//return msg_out;\n\nmsg.payload = []\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 665,
        "y": 1120,
        "wires": [
            [
                "edf4d60398ebee66"
            ]
        ],
        "l": false
    },
    {
        "id": "90b25ac716e929c6",
        "type": "inject",
        "z": "b83fb43068cdf48f",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 605,
        "y": 1120,
        "wires": [
            [
                "2ba532e7faaaf05f"
            ]
        ],
        "l": false
    },
    {
        "id": "79e8d734b498031e",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "set control if auto tune not active 0",
        "func": "var zone_id = 0\nvar zone = global.get('pid.zone[' + zone_id + ']')\nif (!zone.autotune.active) {\n    var cv = msg.payload * 100\n    global.set('pid.zone['+zone_id+'].parameters.control', cv)\n    \n    if (zone.action == 'heating' || zone.action == 'cooling' ) {\n        msg.payload = cv * zone.parameters.rate / 100\n        msg.action = zone.action\n        node.status({ fill: \"green\", shape: \"dot\", text: msg.payload.toFixed(2) + ' CV' });\n    } else if (zone.action == 'maintaining') {\n        msg.action = \"Off\"\n        node.status({ fill: \"green\", shape: \"dot\", text: cv.toFixed(2) + ' CV' });\n    } else {\n        msg.action = \"Off\"\n        node.status({ fill: \"green\", shape: \"dot\", text: 0 + ' CV' });\n    }\n    \n    return msg;\n} else {\n    node.status({ fill: \"green\", shape: \"ring\", text: 'tuning' });\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 285,
        "y": 240,
        "wires": [
            [
                "a7d4d1f6e66847a4",
                "26f55fb29541fdb1"
            ]
        ],
        "l": false
    },
    {
        "id": "82f39574ad2ae492",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "pid.zone[0].parameters.control",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 125,
        "y": 140,
        "wires": [
            [
                "9697d72a5f2cf931",
                "ea31253a46d4b358"
            ]
        ],
        "l": false
    },
    {
        "id": "9ace848fd4fa953c",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "",
        "links": [
            "362eeead535475d1",
            "6c642e204f07ada4"
        ],
        "x": 545,
        "y": 600,
        "wires": [
            [
                "2e3cae4209b2ada3",
                "421e168f1e21c8eb",
                "89b465e16b59498c",
                "ac5e74fbfbc5c35b",
                "dc54653aed0af737",
                "ba1d8ad698619ff8",
                "ae2d534c0af3fdbf",
                "30268114cb16ecdb",
                "1fc9834e133d4dd7",
                "ad72ca96abbbda04",
                "9e758dbc39404bb8",
                "3aa827944da4334b",
                "264235440a742302",
                "3a1438a5665ec43e",
                "27f7045e7c6618ef",
                "d6d4fadaca2168e9",
                "f2550ccb2c8302f1"
            ]
        ]
    },
    {
        "id": "ba4e7459b18e1a54",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "c825648e000f6977"
        ],
        "x": 335,
        "y": 580,
        "wires": []
    },
    {
        "id": "a2cccb12b627c0e7",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "c825648e000f6977"
        ],
        "x": 535,
        "y": 820,
        "wires": []
    },
    {
        "id": "45a06d0cb15ef15c",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "initialize variables",
        "func": "\n\nvar zone = []\nvar zone_count = 4\nfor (let index = 0; index < zone_count; index++) {\n    zone.push({ id: '',\n                action: 'Off', \n                autotune: { active: false, setpoint: 0, rate: 0}, \n                parameters: { rate: 0, setpoint: 0, control: 0, process: 0 }, \n                settings: { \n                    heating: { \n                        gain: { Kp: 0, Ki: 0, Kd: 0 }, \n                        time: { PB: 1600, Ti: 10, Td: -1 } },\n                    cooling: { \n                        gain: { Kp: 0, Ki: 0, Kd: 0 }, \n                        time: { PB: 1600, Ti: 10, Td: 0 } } ,\n                    maintaining: { \n                        gain: { Kp: 0, Ki: 0, Kd: 0 }, \n                        time: { PB: 1600, Ti: 10, Td: 0 } } } } )\n}\nvar pid = { selected_zone: 0, zone }\nglobal.set('pid', pid)\nmsg.payload = { pid }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 535,
        "y": 20,
        "wires": [
            [
                "87022818070f9cce"
            ]
        ],
        "l": false
    },
    {
        "id": "4f6c495a3f7424e0",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "set control if auto tune active",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nif (global.get('pid.zone[' + selected_zone + '].autotune.active')) {\n    global.set('pid.zone[' + selected_zone + '].parameters.control', msg.payload)\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 275,
        "y": 620,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "385287d0010ada53",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "gate if auto tune active",
        "func": "var zone_id = 0\nmsg.topic = 'process'\nvar zone = global.get('pid.zone[' + zone_id + ']')\nif (zone.action == \"Off\") {\n    node.status({ fill: \"red\", shape: \"ring\", text: zone.action });\n    msg.enable = false\n} else {\n    node.status({ fill: \"green\", shape: \"dot\", text: zone.action });\n    msg.enable = true\n    msg.payload = zone.parameters.process || 0\n    msg.setpoint = zone.parameters.setpoint || 0\n    if (zone.action == 'heating'){\n        msg.prop_band = zone.settings.heating.time.PB || 0\n        msg.t_integral = zone.settings.heating.time.Ti || 0\n        msg.t_derivative = zone.settings.heating.time.Td || 0\n    } else if (zone.action == 'cooling') {\n        msg.prop_band = zone.settings.cooling.time.PB || 0\n        msg.t_integral = zone.settings.cooling.time.Ti || 0\n        msg.t_derivative = zone.settings.cooling.time.Td || 0\n    } else if (zone.action == 'maintaining') {\n        msg.prop_band = zone.settings.maintaining.time.PB || 0\n        msg.t_integral = zone.settings.maintaining.time.Ti || 0\n        msg.t_derivative = zone.settings.maintaining.time.Td || 0\n    } else {\n        // uh oh...\n        node.status({ fill: \"red\", shape: \"ring\", text: zone.action });\n        msg.enable = false\n    }\n    msg.integral_default = 0.5\n    msg.max_interval = 600\n    msg.smooth_factor = 0\n    msg.disabled_op = 0 \n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 125,
        "y": 240,
        "wires": [
            [
                "9f8f243cf0171822"
            ]
        ],
        "l": false
    },
    {
        "id": "0354f9fa940fc412",
        "type": "comment",
        "z": "b83fb43068cdf48f",
        "name": "zone 0 temp pid",
        "info": "",
        "x": 100,
        "y": 80,
        "wires": []
    },
    {
        "id": "f7bef6a806c015d4",
        "type": "comment",
        "z": "b83fb43068cdf48f",
        "name": "auto tune",
        "info": "",
        "x": 80,
        "y": 540,
        "wires": []
    },
    {
        "id": "f44bbf38f57e5c57",
        "type": "PID",
        "z": "b83fb43068cdf48f",
        "name": "",
        "setpoint": "0",
        "pb": 1,
        "ti": 9999,
        "td": 0,
        "integral_default": 0.5,
        "smooth_factor": 3,
        "max_interval": 600,
        "enable": 1,
        "disabled_op": 0,
        "x": 665,
        "y": 240,
        "wires": [
            [
                "83caff269f9bed78"
            ]
        ],
        "l": false
    },
    {
        "id": "83caff269f9bed78",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "set control if auto tune not active 1",
        "func": "var zone_id = 1\nvar zone = global.get('pid.zone[' + zone_id + ']')\nif (!zone.autotune.active) {\n    var cv = msg.payload * 100\n    global.set('pid.zone['+zone_id+'].parameters.control', cv)\n    \n    if (zone.action == 'heating' || zone.action == 'cooling' ) {\n        msg.payload = cv * zone.parameters.rate / 100\n        msg.action = zone.action\n        node.status({ fill: \"green\", shape: \"dot\", text: msg.payload.toFixed(2) + ' CV' });\n    } else if (zone.action == 'maintaining') {\n        msg.action = \"Off\"\n        node.status({ fill: \"green\", shape: \"dot\", text: cv.toFixed(2) + ' CV' });\n    } else {\n        msg.action = \"Off\"\n        node.status({ fill: \"green\", shape: \"dot\", text: 0 + ' CV' });\n    }\n    \n    return msg;\n} else {\n    node.status({ fill: \"green\", shape: \"ring\", text: 'tuning' });\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 745,
        "y": 240,
        "wires": [
            [
                "33d46d048827346c",
                "48c743e763d05137"
            ]
        ],
        "l": false
    },
    {
        "id": "aa541d34f410d1e9",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "gate if auto tune active",
        "func": "var zone_id = 1\nmsg.topic = 'process'\nvar zone = global.get('pid.zone[' + zone_id + ']')\nif (zone.action == \"Off\") {\n    node.status({ fill: \"red\", shape: \"ring\", text: zone.action });\n    msg.enable = false\n} else {\n    node.status({ fill: \"green\", shape: \"dot\", text: zone.action });\n    msg.enable = true\n    msg.payload = zone.parameters.process || 0\n    msg.setpoint = zone.parameters.setpoint || 0\n    if (zone.action == 'heating'){\n        msg.prop_band = zone.settings.heating.time.PB || 0\n        msg.t_integral = zone.settings.heating.time.Ti || 0\n        msg.t_derivative = zone.settings.heating.time.Td || 0\n    } else if (zone.action == 'cooling') {\n        msg.prop_band = zone.settings.cooling.time.PB || 0\n        msg.t_integral = zone.settings.cooling.time.Ti || 0\n        msg.t_derivative = zone.settings.cooling.time.Td || 0\n    } else if (zone.action == 'maintaining') {\n        msg.prop_band = zone.settings.maintaining.time.PB || 0\n        msg.t_integral = zone.settings.maintaining.time.Ti || 0\n        msg.t_derivative = zone.settings.maintaining.time.Td || 0\n    } else {\n        // uh oh...\n        node.status({ fill: \"red\", shape: \"ring\", text: zone.action });\n        msg.enable = false\n    }\n    msg.integral_default = 0.5\n    msg.max_interval = 600\n    msg.smooth_factor = 0\n    msg.disabled_op = 0 \n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 585,
        "y": 240,
        "wires": [
            [
                "f44bbf38f57e5c57"
            ]
        ],
        "l": false
    },
    {
        "id": "905f3657bdd0e94b",
        "type": "comment",
        "z": "b83fb43068cdf48f",
        "name": "zone 1 temp pid",
        "info": "",
        "x": 560,
        "y": 80,
        "wires": []
    },
    {
        "id": "bee9b0aaa92de05c",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "aa4193468fa51352",
            "92ddf9e5188bd64e",
            "287e0e0ceab0f3df"
        ],
        "x": 375,
        "y": 180,
        "wires": []
    },
    {
        "id": "8df48c7183182914",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "pid.selected_zone",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 315,
        "y": 180,
        "wires": [
            [
                "bee9b0aaa92de05c"
            ]
        ],
        "l": false
    },
    {
        "id": "7bec29feb13d35ed",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 775,
        "y": 180,
        "wires": [],
        "l": false
    },
    {
        "id": "e506ed0cd0354fe6",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "pid.zone[1].parameters.process",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 775,
        "y": 140,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "2173af95761ba16b",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "pid.zone[1].parameters.control",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 585,
        "y": 140,
        "wires": [
            [
                "63baca868e0f50b3",
                "81f7f54ee10d9601"
            ]
        ],
        "l": false
    },
    {
        "id": "b533e4fa8c93b24a",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "aa4193468fa51352",
            "92ddf9e5188bd64e",
            "287e0e0ceab0f3df"
        ],
        "x": 835,
        "y": 180,
        "wires": []
    },
    {
        "id": "f05ced95d18386f1",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "pid.selected_zone",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "1",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 775,
        "y": 180,
        "wires": [
            [
                "b533e4fa8c93b24a"
            ]
        ],
        "l": false
    },
    {
        "id": "a7d4d1f6e66847a4",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 335,
        "y": 240,
        "wires": [],
        "l": false
    },
    {
        "id": "33d46d048827346c",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 795,
        "y": 240,
        "wires": [],
        "l": false
    },
    {
        "id": "53f27879023bc849",
        "type": "comment",
        "z": "b83fb43068cdf48f",
        "name": "dashboard",
        "info": "",
        "x": 540,
        "y": 540,
        "wires": []
    },
    {
        "id": "26cb94d0aa740af8",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "input - zone 0 temp pid - in from process (PV)",
        "links": [
            "dcbc073ea7b777ee"
        ],
        "x": 255,
        "y": 180,
        "wires": [
            [
                "1f1e287e7011feb5",
                "8df48c7183182914",
                "fc98fd801ee9ea69"
            ]
        ]
    },
    {
        "id": "9fea36d4825b738a",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "input - zone 1 temp pid - in from process (PV)",
        "links": [
            "e65201e766b76bfd"
        ],
        "x": 715,
        "y": 180,
        "wires": [
            [
                "7bec29feb13d35ed",
                "e506ed0cd0354fe6",
                "f05ced95d18386f1"
            ]
        ]
    },
    {
        "id": "53681c7211103452",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "input - zone 0 - SP",
        "links": [
            "9715dba2fc1ab553",
            "c96334b38e278286",
            "af8f2e69ea9f27c2",
            "91b7c42203f31df4"
        ],
        "x": 65,
        "y": 180,
        "wires": [
            [
                "15a8037dcc3b6a5a"
            ]
        ]
    },
    {
        "id": "15a8037dcc3b6a5a",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "pid.zone[0].parameters.setpoint",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "pid.zone[0].parameters.rate",
                "pt": "global",
                "to": "rate",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "pid.zone[0].action",
                "pt": "global",
                "to": "action",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 125,
        "y": 180,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "4840d3b8dd483cff",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "input - zone 1 - SP",
        "links": [
            "6f66fd670975be35",
            "c96334b38e278286",
            "af8f2e69ea9f27c2",
            "2529ef781a84b687"
        ],
        "x": 525,
        "y": 180,
        "wires": [
            [
                "9fa5332fb445e60b"
            ]
        ]
    },
    {
        "id": "9fa5332fb445e60b",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "pid.zone[1].parameters.setpoint",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "pid.zone[1].parameters.rate",
                "pt": "global",
                "to": "rate",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "pid.zone[1].action",
                "pt": "global",
                "to": "action",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 585,
        "y": 180,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "989fbf5d083c48b4",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "tab",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "5",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 415,
        "y": 820,
        "wires": [
            [
                "b6c91fa96dfbfdb5"
            ]
        ],
        "l": false
    },
    {
        "id": "b6c91fa96dfbfdb5",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "lost",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "connect",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "change",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 475,
        "y": 820,
        "wires": [
            [],
            [
                "a2cccb12b627c0e7"
            ],
            [
                "a2cccb12b627c0e7"
            ]
        ],
        "l": false
    },
    {
        "id": "ae639127ca4d386d",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "dashboard events",
        "links": [
            "0d7362ca2edd72c6"
        ],
        "x": 430,
        "y": 760,
        "wires": [
            [
                "989fbf5d083c48b4"
            ]
        ],
        "l": true
    },
    {
        "id": "216bb83c577ca24b",
        "type": "inject",
        "z": "b83fb43068cdf48f",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 475,
        "y": 20,
        "wires": [
            [
                "45a06d0cb15ef15c"
            ]
        ],
        "l": false
    },
    {
        "id": "926b0d1549693d67",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "Timer 1",
        "links": [
            "62eccecdbb37e6f8"
        ],
        "x": 525,
        "y": 240,
        "wires": [
            [
                "aa541d34f410d1e9"
            ]
        ],
        "icon": "node-red/timer.svg"
    },
    {
        "id": "98c5268e979c7dcb",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "Timer 1",
        "links": [
            "62eccecdbb37e6f8"
        ],
        "x": 65,
        "y": 240,
        "wires": [
            [
                "385287d0010ada53"
            ]
        ],
        "icon": "node-red/timer.svg"
    },
    {
        "id": "83d1eeca2821fcac",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "Timer 1",
        "links": [
            "62eccecdbb37e6f8"
        ],
        "x": 525,
        "y": 140,
        "wires": [
            [
                "2173af95761ba16b"
            ]
        ],
        "icon": "node-red/timer.svg"
    },
    {
        "id": "c271444bdafb92be",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "Timer 1",
        "links": [
            "62eccecdbb37e6f8"
        ],
        "x": 65,
        "y": 140,
        "wires": [
            [
                "82f39574ad2ae492"
            ]
        ],
        "icon": "node-red/timer.svg"
    },
    {
        "id": "0f779fd67e9e72b8",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "Oneshot Inject at Startup",
        "links": [
            "7fa2d20f4131fc60"
        ],
        "x": 335,
        "y": 20,
        "wires": [
            [
                "b0cf339b6f16ca16"
            ]
        ],
        "icon": "node-red/timer.svg"
    },
    {
        "id": "8dd6c26b1fcddca6",
        "type": "PID",
        "z": "b83fb43068cdf48f",
        "name": "",
        "setpoint": "0",
        "pb": 1,
        "ti": 9999,
        "td": 0,
        "integral_default": 0.5,
        "smooth_factor": 3,
        "max_interval": 600,
        "enable": 1,
        "disabled_op": 0,
        "x": 205,
        "y": 480,
        "wires": [
            [
                "21abba5c735f4f33"
            ]
        ],
        "l": false
    },
    {
        "id": "21abba5c735f4f33",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "set control if auto tune not active 2",
        "func": "var zone_id = 2\nvar cv\nif (!global.get('pid.zone['+zone_id+'].autotune.active')) {\n    cv = msg.payload * 100\n    global.set('pid.zone['+zone_id+'].parameters.control', cv)\n    node.status({ fill: \"green\", shape: \"dot\", text: cv.toFixed(2) + ' CV' });\n    return msg;\n} else {\n    node.status({ fill: \"green\", shape: \"ring\", text: 'tuning' });\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 285,
        "y": 480,
        "wires": [
            [
                "55eefabb9d45afba"
            ]
        ],
        "l": false
    },
    {
        "id": "3d56a3e565b065fb",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "gate if auto tune active",
        "func": "var zone_id = 2\nmsg.topic = 'process'\nvar zone = global.get('pid.zone[' + zone_id + ']')\nif (zone.action == \"Off\") {\n    node.status({ fill: \"red\", shape: \"ring\", text: zone.action });\n    msg.enable = false\n} else {\n    node.status({ fill: \"green\", shape: \"dot\", text: zone.action });\n    msg.enable = true\n    msg.payload = zone.parameters.process || 0\n    msg.setpoint = zone.parameters.setpoint || 0\n    if (zone.action == 'heating'){\n        msg.prop_band = zone.settings.heating.time.PB || 0\n        msg.t_integral = zone.settings.heating.time.Ti || 0\n        msg.t_derivative = zone.settings.heating.time.Td || 0\n    } else if (zone.action == 'cooling') {\n        msg.prop_band = zone.settings.cooling.time.PB || 0\n        msg.t_integral = zone.settings.cooling.time.Ti || 0\n        msg.t_derivative = zone.settings.cooling.time.Td || 0\n    } else if (zone.action == 'maintaining') {\n        msg.prop_band = zone.settings.maintaining.time.PB || 0\n        msg.t_integral = zone.settings.maintaining.time.Ti || 0\n        msg.t_derivative = zone.settings.maintaining.time.Td || 0\n    } else {\n        // uh oh...\n        node.status({ fill: \"red\", shape: \"ring\", text: zone.action });\n        msg.enable = false\n    }\n    msg.integral_default = 0.5\n    msg.max_interval = 600\n    msg.smooth_factor = 0\n    msg.disabled_op = 0 \n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 125,
        "y": 480,
        "wires": [
            [
                "8dd6c26b1fcddca6"
            ]
        ],
        "l": false
    },
    {
        "id": "6d16639b39a7e3e8",
        "type": "comment",
        "z": "b83fb43068cdf48f",
        "name": "zone 2 ramp pid",
        "info": "",
        "x": 100,
        "y": 320,
        "wires": []
    },
    {
        "id": "16af16873f4883b4",
        "type": "PID",
        "z": "b83fb43068cdf48f",
        "name": "",
        "setpoint": "0",
        "pb": 1,
        "ti": 9999,
        "td": 0,
        "integral_default": 0.5,
        "smooth_factor": 3,
        "max_interval": 600,
        "enable": 1,
        "disabled_op": 0,
        "x": 665,
        "y": 480,
        "wires": [
            [
                "356e5793a9f364e9"
            ]
        ],
        "l": false
    },
    {
        "id": "356e5793a9f364e9",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "set control if auto tune not active 3",
        "func": "var zone_id = 3\nvar cv\nif (!global.get('pid.zone['+zone_id+'].autotune.active')) {\n    cv = msg.payload * 100\n    global.set('pid.zone['+zone_id+'].parameters.control', cv)\n    node.status({ fill: \"green\", shape: \"dot\", text: cv.toFixed(2) + ' CV' });\n    return msg;\n} else {\n    node.status({ fill: \"green\", shape: \"ring\", text: 'tuning' });\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 745,
        "y": 480,
        "wires": [
            [
                "da404c6570aec769"
            ]
        ],
        "l": false
    },
    {
        "id": "cb1f9a0b2d53e60e",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "gate if auto tune active",
        "func": "var zone_id = 3\nmsg.topic = 'process'\nvar zone = global.get('pid.zone[' + zone_id + ']')\nif (zone.action == \"Off\") {\n    node.status({ fill: \"red\", shape: \"ring\", text: zone.action });\n    msg.enable = false\n} else {\n    node.status({ fill: \"green\", shape: \"dot\", text: zone.action });\n    msg.enable = true\n    msg.payload = zone.parameters.process || 0\n    msg.setpoint = zone.parameters.setpoint || 0\n    if (zone.action == 'heating'){\n        msg.prop_band = zone.settings.heating.time.PB || 0\n        msg.t_integral = zone.settings.heating.time.Ti || 0\n        msg.t_derivative = zone.settings.heating.time.Td || 0\n    } else if (zone.action == 'cooling') {\n        msg.prop_band = zone.settings.cooling.time.PB || 0\n        msg.t_integral = zone.settings.cooling.time.Ti || 0\n        msg.t_derivative = zone.settings.cooling.time.Td || 0\n    } else if (zone.action == 'maintaining') {\n        msg.prop_band = zone.settings.maintaining.time.PB || 0\n        msg.t_integral = zone.settings.maintaining.time.Ti || 0\n        msg.t_derivative = zone.settings.maintaining.time.Td || 0\n    } else {\n        // uh oh...\n        node.status({ fill: \"red\", shape: \"ring\", text: zone.action });\n        msg.enable = false\n    }\n    msg.integral_default = 0.5\n    msg.max_interval = 600\n    msg.smooth_factor = 0\n    msg.disabled_op = 0 \n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 585,
        "y": 480,
        "wires": [
            [
                "16af16873f4883b4"
            ]
        ],
        "l": false
    },
    {
        "id": "5f95d2fc0a226726",
        "type": "comment",
        "z": "b83fb43068cdf48f",
        "name": "zone 3 ramp pid",
        "info": "",
        "x": 560,
        "y": 320,
        "wires": []
    },
    {
        "id": "55eefabb9d45afba",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 335,
        "y": 480,
        "wires": [],
        "l": false
    },
    {
        "id": "da404c6570aec769",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 805,
        "y": 480,
        "wires": [],
        "l": false
    },
    {
        "id": "7e2fa6ed953dcc19",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "Timer 1",
        "links": [
            "62eccecdbb37e6f8"
        ],
        "x": 525,
        "y": 480,
        "wires": [
            [
                "cb1f9a0b2d53e60e"
            ]
        ],
        "icon": "node-red/timer.svg"
    },
    {
        "id": "5cb7a543f0243acf",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "Timer 1",
        "links": [
            "62eccecdbb37e6f8"
        ],
        "x": 65,
        "y": 480,
        "wires": [
            [
                "3d56a3e565b065fb"
            ]
        ],
        "icon": "node-red/timer.svg"
    },
    {
        "id": "39a42bcb9118d6a7",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "measure ramp rate",
        "func": "var LastValue = context.get('LastValue') || 0\nvar LastTime = context.get('LastTime') || 0\nvar NowValue = msg.payload || 0\nvar NowTime = Date.now() || 0\n//if (NowTime - LastTime > 5000) { // wait at least 5 seconds to take another measurement\n    context.set('LastValue', msg.payload)\n    context.set('LastTime', Date.now())\n    var milli = ((NowValue - LastValue) / (NowTime - LastTime)) // units per millisecond\n    var sec = milli * 1000.0\n    var min = sec * 60.0\n    var hour = min * 60.0\n    msg.rate = {milli, sec, min, hour}\n    node.status({ fill: \"green\", shape: \"dot\", text: hour.toFixed(2) + ' UPH' });\n    msg.payload = hour\n    return msg;\n//}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 420,
        "wires": [
            [
                "8b514b70a1c22fca",
                "82008bc92cbf7d6d"
            ]
        ],
        "l": false
    },
    {
        "id": "c94953d0aadb25d7",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 285,
        "y": 380,
        "wires": [],
        "l": false
    },
    {
        "id": "acaf9302560db8b4",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "pid.zone[2].parameters.process",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 365,
        "y": 440,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "c22c195193993549",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "pid.zone[2].parameters.control",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 125,
        "y": 380,
        "wires": [
            [
                "7c57cd1b6579e857",
                "07cdd33a021030f4"
            ]
        ],
        "l": false
    },
    {
        "id": "5793f419da2fa866",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "aa4193468fa51352",
            "92ddf9e5188bd64e",
            "287e0e0ceab0f3df"
        ],
        "x": 415,
        "y": 400,
        "wires": []
    },
    {
        "id": "f473728b7ae37ca2",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "pid.selected_zone",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "2",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 365,
        "y": 400,
        "wires": [
            [
                "5793f419da2fa866"
            ]
        ],
        "l": false
    },
    {
        "id": "8b514b70a1c22fca",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 745,
        "y": 380,
        "wires": [],
        "l": false
    },
    {
        "id": "546fc99e5e691238",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "pid.zone[3].parameters.process",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 825,
        "y": 440,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "5d3e4473b07e8b43",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "pid.zone[3].parameters.control",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 585,
        "y": 380,
        "wires": [
            [
                "88dc5e16a84e5d48",
                "c51f5f99a3b50c74"
            ]
        ],
        "l": false
    },
    {
        "id": "3cd6ce4406cb6bbc",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "aa4193468fa51352",
            "92ddf9e5188bd64e",
            "287e0e0ceab0f3df"
        ],
        "x": 875,
        "y": 400,
        "wires": []
    },
    {
        "id": "7abb781e2be6035b",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "pid.selected_zone",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "3",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 825,
        "y": 400,
        "wires": [
            [
                "3cd6ce4406cb6bbc"
            ]
        ],
        "l": false
    },
    {
        "id": "731f4e17a1f3392d",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "input - zone 2 ramp pid - in from process (PV)",
        "links": [
            "dcbc073ea7b777ee"
        ],
        "x": 185,
        "y": 420,
        "wires": [
            [
                "e95daadd472e3c3b"
            ]
        ]
    },
    {
        "id": "f30c6739d0a3c556",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "input - zone 3 ramp pid - in from process (PV)",
        "links": [
            "e65201e766b76bfd"
        ],
        "x": 645,
        "y": 420,
        "wires": [
            [
                "39a42bcb9118d6a7"
            ]
        ]
    },
    {
        "id": "44672db9b0431917",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "Timer 1",
        "links": [
            "62eccecdbb37e6f8"
        ],
        "x": 525,
        "y": 380,
        "wires": [
            [
                "5d3e4473b07e8b43"
            ]
        ],
        "icon": "node-red/timer.svg"
    },
    {
        "id": "b88c29b93586b994",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "Timer 1",
        "links": [
            "62eccecdbb37e6f8"
        ],
        "x": 65,
        "y": 380,
        "wires": [
            [
                "c22c195193993549"
            ]
        ],
        "icon": "node-red/timer.svg"
    },
    {
        "id": "87022818070f9cce",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 595,
        "y": 20,
        "wires": [],
        "l": false
    },
    {
        "id": "e95daadd472e3c3b",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "measure ramp rate",
        "func": "var LastValue = context.get('LastValue') || 0\nvar LastTime = context.get('LastTime') || 0\nvar NowValue = msg.payload || 0\nvar NowTime = Date.now() || 0\n//if (NowTime - LastTime > 5000) { // wait at least 5 seconds to take another measurement\n    context.set('LastValue', msg.payload)\n    context.set('LastTime', Date.now())\n    var milli = ((NowValue - LastValue) / (NowTime - LastTime)) // units per millisecond\n    var sec = milli * 1000.0\n    var min = sec * 60.0\n    var hour = min * 60.0\n    msg.rate = {milli, sec, min, hour}\n    node.status({ fill: \"green\", shape: \"dot\", text: hour.toFixed(2) + ' UPH' });\n    msg.payload = hour\n    return msg;\n//}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 235,
        "y": 420,
        "wires": [
            [
                "c94953d0aadb25d7",
                "a5c6380a3f3c2b32"
            ]
        ],
        "l": false
    },
    {
        "id": "b9a5324498572017",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "pid.zone[2].parameters.setpoint",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "pid.zone[2].action",
                "pt": "global",
                "to": "action",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 125,
        "y": 420,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "94112e9a2839cf54",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "",
        "links": [
            "26f55fb29541fdb1",
            "1396628d0ea3f917"
        ],
        "x": 65,
        "y": 420,
        "wires": [
            [
                "b9a5324498572017"
            ]
        ]
    },
    {
        "id": "26f55fb29541fdb1",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "94112e9a2839cf54"
        ],
        "x": 335,
        "y": 240,
        "wires": []
    },
    {
        "id": "48c743e763d05137",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "d10bbe6d04d1179a"
        ],
        "x": 795,
        "y": 240,
        "wires": []
    },
    {
        "id": "c62eab5d62729aa1",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "pid.zone[3].parameters.setpoint",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "pid.zone[3].action",
                "pt": "global",
                "to": "action",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 585,
        "y": 420,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "d10bbe6d04d1179a",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "",
        "links": [
            "48c743e763d05137",
            "ac657527b6dfaca0"
        ],
        "x": 525,
        "y": 420,
        "wires": [
            [
                "c62eab5d62729aa1"
            ]
        ]
    },
    {
        "id": "5e6821a08b748efd",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 325,
        "y": 620,
        "wires": [],
        "l": false
    },
    {
        "id": "4753b7a6881b7b3c",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "check for zero because autotune lib doesnt like it",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "neq",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 105,
        "y": 680,
        "wires": [
            [
                "906802117f136580"
            ],
            [
                "d36e49a591261d50"
            ]
        ],
        "l": false
    },
    {
        "id": "906802117f136580",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "1",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 155,
        "y": 660,
        "wires": [
            [
                "d36e49a591261d50"
            ]
        ],
        "l": false
    },
    {
        "id": "2983d3178fa2d2ea",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 105,
        "y": 720,
        "wires": [],
        "l": false
    },
    {
        "id": "cc59d4f3b8c4d157",
        "type": "ui_button",
        "z": "b83fb43068cdf48f",
        "name": "",
        "group": "a91f3f1520863187",
        "order": 10,
        "width": 8,
        "height": 1,
        "passthru": false,
        "label": "Clear",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 605,
        "y": 1120,
        "wires": [
            [
                "2ba532e7faaaf05f"
            ]
        ],
        "l": false
    },
    {
        "id": "5926fc467620cb66",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "",
        "links": [
            "362eeead535475d1"
        ],
        "x": 605,
        "y": 1160,
        "wires": [
            [
                "2ba532e7faaaf05f"
            ]
        ]
    },
    {
        "id": "c83a8da294ebc889",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "heating Pb",
        "label": "Pb",
        "tooltip": "",
        "group": "a91f3f1520863187",
        "order": 17,
        "width": 4,
        "height": 1,
        "wrap": false,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": "-10000",
        "max": "10000",
        "step": "0.01",
        "className": "",
        "x": 755,
        "y": 580,
        "wires": [
            [
                "2cd06c2411c3deec"
            ]
        ],
        "l": false
    },
    {
        "id": "eaafcfd82fd76c68",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "heating Ti",
        "label": "Ti",
        "tooltip": "",
        "group": "a91f3f1520863187",
        "order": 22,
        "width": 4,
        "height": 1,
        "wrap": false,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": "-10000",
        "max": "10000",
        "step": "0.01",
        "className": "",
        "x": 755,
        "y": 600,
        "wires": [
            [
                "a396384803913239"
            ]
        ],
        "l": false
    },
    {
        "id": "72a202982dfa9713",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "heating Td",
        "label": "Td",
        "tooltip": "",
        "group": "a91f3f1520863187",
        "order": 27,
        "width": 4,
        "height": 1,
        "wrap": false,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": "-10000",
        "max": "10000",
        "step": "0.01",
        "className": "",
        "x": 755,
        "y": 620,
        "wires": [
            [
                "37b71ab824c00a0b"
            ]
        ],
        "l": false
    },
    {
        "id": "ac5e74fbfbc5c35b",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].settings.heating.time.PB') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 580,
        "wires": [
            [
                "c83a8da294ebc889"
            ]
        ],
        "l": false
    },
    {
        "id": "dc54653aed0af737",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].settings.heating.time.Ti') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 600,
        "wires": [
            [
                "eaafcfd82fd76c68"
            ]
        ],
        "l": false
    },
    {
        "id": "ba1d8ad698619ff8",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].settings.heating.time.Td') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 620,
        "wires": [
            [
                "72a202982dfa9713"
            ]
        ],
        "l": false
    },
    {
        "id": "2cd06c2411c3deec",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].settings.heating.time.PB', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 580,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "a396384803913239",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].settings.heating.time.Ti', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 600,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "37b71ab824c00a0b",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].settings.heating.time.Td', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 620,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "2e3cae4209b2ada3",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].settings.cooling.time.PB') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 640,
        "wires": [
            [
                "6f0a2b0420a217c6"
            ]
        ],
        "l": false
    },
    {
        "id": "6f0a2b0420a217c6",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "cooling Pb",
        "label": "Pb",
        "tooltip": "",
        "group": "a91f3f1520863187",
        "order": 19,
        "width": 4,
        "height": 1,
        "wrap": false,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": "-10000",
        "max": "10000",
        "step": "0.01",
        "className": "",
        "x": 755,
        "y": 640,
        "wires": [
            [
                "16d2b807c8911037"
            ]
        ],
        "l": false
    },
    {
        "id": "16d2b807c8911037",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].settings.cooling.time.PB', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 640,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "b3278848da3d3187",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].settings.cooling.time.Ti', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 660,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "2e2d8b482044aceb",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "cooling Ti",
        "label": "Ti",
        "tooltip": "",
        "group": "a91f3f1520863187",
        "order": 24,
        "width": 4,
        "height": 1,
        "wrap": false,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": "-10000",
        "max": "10000",
        "step": "0.01",
        "className": "",
        "x": 755,
        "y": 660,
        "wires": [
            [
                "b3278848da3d3187"
            ]
        ],
        "l": false
    },
    {
        "id": "421e168f1e21c8eb",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].settings.cooling.time.Ti') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 660,
        "wires": [
            [
                "2e2d8b482044aceb"
            ]
        ],
        "l": false
    },
    {
        "id": "89b465e16b59498c",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].settings.cooling.time.Td') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 680,
        "wires": [
            [
                "59104e20fbde50f9"
            ]
        ],
        "l": false
    },
    {
        "id": "59104e20fbde50f9",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "cooling Td",
        "label": "Td",
        "tooltip": "",
        "group": "a91f3f1520863187",
        "order": 29,
        "width": 4,
        "height": 1,
        "wrap": false,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": "-10000",
        "max": "10000",
        "step": "0.01",
        "className": "",
        "x": 755,
        "y": 680,
        "wires": [
            [
                "72e5604feb0fec41"
            ]
        ],
        "l": false
    },
    {
        "id": "72e5604feb0fec41",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].settings.cooling.time.Td', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 680,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "6b6bc919a4c2a64d",
        "type": "ui_text",
        "z": "b83fb43068cdf48f",
        "group": "a91f3f1520863187",
        "order": 12,
        "width": 4,
        "height": 1,
        "name": "heating",
        "label": "",
        "format": "heating",
        "layout": "col-center",
        "className": "",
        "x": 420,
        "y": 880,
        "wires": []
    },
    {
        "id": "dce6853405238785",
        "type": "ui_text",
        "z": "b83fb43068cdf48f",
        "group": "a91f3f1520863187",
        "order": 14,
        "width": 4,
        "height": 1,
        "name": "cooling",
        "label": "",
        "format": "cooling",
        "layout": "col-center",
        "className": "",
        "x": 420,
        "y": 900,
        "wires": []
    },
    {
        "id": "7c57cd1b6579e857",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "pid.zone[2].action",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "heating",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "cooling",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 185,
        "y": 380,
        "wires": [
            [
                "1cc3f245a847a3d0"
            ],
            [
                "1cc3f245a847a3d0"
            ]
        ],
        "l": false
    },
    {
        "id": "9697d72a5f2cf931",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "pid.zone[0].action",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "maintaining",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 185,
        "y": 100,
        "wires": [
            [
                "7ef113d46af94fa7"
            ]
        ],
        "l": false
    },
    {
        "id": "88dc5e16a84e5d48",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "pid.zone[3].action",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "heating",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "cooling",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 645,
        "y": 380,
        "wires": [
            [
                "ccbdd10cb54a906c"
            ],
            [
                "ccbdd10cb54a906c"
            ]
        ],
        "l": false
    },
    {
        "id": "63baca868e0f50b3",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "pid.zone[1].action",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "maintaining",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 645,
        "y": 100,
        "wires": [
            [
                "3ead42b5645fe82a"
            ]
        ],
        "l": false
    },
    {
        "id": "ae2d534c0af3fdbf",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].settings.maintaining.time.PB') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 700,
        "wires": [
            [
                "1a5f9fc8869a33e1"
            ]
        ],
        "l": false
    },
    {
        "id": "1a5f9fc8869a33e1",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "maintaining Pb",
        "label": "Pb",
        "tooltip": "",
        "group": "a91f3f1520863187",
        "order": 21,
        "width": 4,
        "height": 1,
        "wrap": false,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": "-10000",
        "max": "10000",
        "step": "0.01",
        "className": "",
        "x": 755,
        "y": 700,
        "wires": [
            [
                "09ad5366c6ae2c56"
            ]
        ],
        "l": false
    },
    {
        "id": "09ad5366c6ae2c56",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].settings.maintaining.time.PB', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 700,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "19e8ae51d5e09d57",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].settings.maintaining.time.Ti', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 720,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "2ca1fd6d80d47e4a",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "maintaining Ti",
        "label": "Ti",
        "tooltip": "",
        "group": "a91f3f1520863187",
        "order": 26,
        "width": 4,
        "height": 1,
        "wrap": false,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": "-10000",
        "max": "10000",
        "step": "0.01",
        "className": "",
        "x": 755,
        "y": 720,
        "wires": [
            [
                "19e8ae51d5e09d57"
            ]
        ],
        "l": false
    },
    {
        "id": "30268114cb16ecdb",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].settings.maintaining.time.Ti') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 720,
        "wires": [
            [
                "2ca1fd6d80d47e4a"
            ]
        ],
        "l": false
    },
    {
        "id": "1fc9834e133d4dd7",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].settings.maintaining.time.Td') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 740,
        "wires": [
            [
                "09a7de795265b75d"
            ]
        ],
        "l": false
    },
    {
        "id": "09a7de795265b75d",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "maintaining Td",
        "label": "Td",
        "tooltip": "",
        "group": "a91f3f1520863187",
        "order": 31,
        "width": 4,
        "height": 1,
        "wrap": false,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": "-10000",
        "max": "10000",
        "step": "0.01",
        "className": "",
        "x": 755,
        "y": 740,
        "wires": [
            [
                "7deea731c74ec31a"
            ]
        ],
        "l": false
    },
    {
        "id": "7deea731c74ec31a",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].settings.maintaining.time.Td', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 740,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "c825648e000f6977",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "",
        "links": [
            "a2cccb12b627c0e7",
            "ba4e7459b18e1a54"
        ],
        "x": 545,
        "y": 920,
        "wires": [
            [
                "2e3cae4209b2ada3",
                "421e168f1e21c8eb",
                "89b465e16b59498c",
                "ac5e74fbfbc5c35b",
                "dc54653aed0af737",
                "ba1d8ad698619ff8",
                "1fc9834e133d4dd7",
                "30268114cb16ecdb",
                "ae2d534c0af3fdbf",
                "ad72ca96abbbda04",
                "ad72ca96abbbda04",
                "299b028606dbaba5",
                "299b028606dbaba5",
                "9e758dbc39404bb8",
                "9e758dbc39404bb8",
                "3aa827944da4334b",
                "3aa827944da4334b",
                "264235440a742302",
                "264235440a742302",
                "3a1438a5665ec43e",
                "27f7045e7c6618ef",
                "d6d4fadaca2168e9",
                "f2550ccb2c8302f1"
            ]
        ]
    },
    {
        "id": "3145db745f792654",
        "type": "ui_dropdown",
        "z": "b83fb43068cdf48f",
        "name": "",
        "label": "Controller",
        "tooltip": "",
        "place": "Select controller",
        "group": "a91f3f1520863187",
        "order": 1,
        "width": 8,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "Upper Temp (Outer Loop)",
                "value": 0,
                "type": "num"
            },
            {
                "label": "Lower Temp (Outer Loop)",
                "value": 1,
                "type": "num"
            },
            {
                "label": "Upper Rate (Inner Loop)",
                "value": 2,
                "type": "num"
            },
            {
                "label": "Lower Rate (Inner Loop)",
                "value": 3,
                "type": "num"
            }
        ],
        "payload": "",
        "topic": "topic",
        "topicType": "msg",
        "className": "",
        "x": 755,
        "y": 780,
        "wires": [
            [
                "f105876bb8452e6f",
                "f105876bb8452e6f"
            ]
        ],
        "l": false
    },
    {
        "id": "781cd411777349be",
        "type": "ui_text",
        "z": "b83fb43068cdf48f",
        "group": "a91f3f1520863187",
        "order": 16,
        "width": 4,
        "height": 1,
        "name": "maintaining",
        "label": "",
        "format": "maintaining",
        "layout": "col-center",
        "className": "",
        "x": 430,
        "y": 920,
        "wires": []
    },
    {
        "id": "c16e42bed75f431a",
        "type": "trigger",
        "z": "b83fb43068cdf48f",
        "name": "",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 555,
        "y": 1060,
        "wires": [
            [
                "bcb0ebd2c23db8e3",
                "422b0453aa8d2e2b",
                "4041ed0c8ac3b123",
                "52a1b5a440697dbd"
            ]
        ],
        "l": false
    },
    {
        "id": "727afe8d60cec42e",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 495,
        "y": 1080,
        "wires": [
            [
                "c16e42bed75f431a"
            ]
        ],
        "l": false
    },
    {
        "id": "3363addf8d70e14b",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "change",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "lost",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 375,
        "y": 1080,
        "wires": [
            [
                "5c76615484274118"
            ],
            [
                "72ac8f8cda046cf3"
            ]
        ],
        "l": false
    },
    {
        "id": "5c76615484274118",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "tab",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "5",
                "vt": "num"
            },
            {
                "t": "neq",
                "v": "5",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 435,
        "y": 1060,
        "wires": [
            [
                "c16e42bed75f431a"
            ],
            []
        ],
        "l": false
    },
    {
        "id": "8425a674f39bddb4",
        "type": "comment",
        "z": "b83fb43068cdf48f",
        "name": "detect when connect to dashboard tab",
        "info": "",
        "x": 450,
        "y": 1040,
        "wires": []
    },
    {
        "id": "c8c2253243612480",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "dashboard events",
        "links": [
            "0d7362ca2edd72c6"
        ],
        "x": 230,
        "y": 1080,
        "wires": [
            [
                "3363addf8d70e14b"
            ]
        ],
        "l": true
    },
    {
        "id": "72ac8f8cda046cf3",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "client count 0",
        "property": "client_count",
        "propertyType": "msg",
        "rules": [
            {
                "t": "lte",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 435,
        "y": 1100,
        "wires": [
            [
                "727afe8d60cec42e"
            ]
        ],
        "l": false
    },
    {
        "id": "bcb0ebd2c23db8e3",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].action')\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 665,
        "y": 1000,
        "wires": [
            [
                "a321eae632374aff",
                "a321eae632374aff"
            ]
        ],
        "l": false
    },
    {
        "id": "a321eae632374aff",
        "type": "ui_text",
        "z": "b83fb43068cdf48f",
        "group": "a91f3f1520863187",
        "order": 2,
        "width": 6,
        "height": 1,
        "name": "action",
        "label": "Action",
        "format": "<font color=\"green\" size=\"+2\">{{msg.payload}}</font>",
        "layout": "row-center",
        "className": "",
        "x": 785,
        "y": 1000,
        "wires": [],
        "l": false
    },
    {
        "id": "422b0453aa8d2e2b",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = parseFloat(global.get('pid.zone[' + selected_zone + '].parameters.setpoint'))\nmsg.topic = 'Setpoint'\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 665,
        "y": 1020,
        "wires": [
            [
                "5f3d7dbca9bda384",
                "edf4d60398ebee66",
                "5f3d7dbca9bda384",
                "5f3d7dbca9bda384"
            ]
        ],
        "l": false
    },
    {
        "id": "5f3d7dbca9bda384",
        "type": "ui_text",
        "z": "b83fb43068cdf48f",
        "group": "a91f3f1520863187",
        "order": 3,
        "width": 4,
        "height": 1,
        "name": "setpoint",
        "label": "Setpoint",
        "format": "<font color=\"green\" size=\"+2\">{{msg.payload}}</font>",
        "layout": "row-spread",
        "className": "",
        "x": 785,
        "y": 1020,
        "wires": [],
        "l": false
    },
    {
        "id": "4041ed0c8ac3b123",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = parseFloat(global.get('pid.zone[' + selected_zone + '].parameters.process')).toFixed(2)\nmsg.topic = 'Process'\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 665,
        "y": 1040,
        "wires": [
            [
                "edf4d60398ebee66",
                "88b62b08d497ced5",
                "88b62b08d497ced5",
                "88b62b08d497ced5"
            ]
        ],
        "l": false
    },
    {
        "id": "88b62b08d497ced5",
        "type": "ui_text",
        "z": "b83fb43068cdf48f",
        "group": "a91f3f1520863187",
        "order": 7,
        "width": 4,
        "height": 1,
        "name": "process",
        "label": "Process",
        "format": "<font color=\"orange\" size=\"+2\">{{msg.payload}}</font>",
        "layout": "row-spread",
        "className": "",
        "x": 785,
        "y": 1040,
        "wires": [],
        "l": false
    },
    {
        "id": "52a1b5a440697dbd",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = parseFloat(global.get('pid.zone[' + selected_zone + '].parameters.control')).toFixed(2)\nmsg.topic = 'Control'\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 665,
        "y": 1060,
        "wires": [
            [
                "edf4d60398ebee66",
                "690b214f18161f59",
                "690b214f18161f59",
                "690b214f18161f59"
            ]
        ],
        "l": false
    },
    {
        "id": "690b214f18161f59",
        "type": "ui_text",
        "z": "b83fb43068cdf48f",
        "group": "a91f3f1520863187",
        "order": 5,
        "width": 4,
        "height": 1,
        "name": "control",
        "label": "Control",
        "format": "<font color=\"red\" size=\"+2\">{{msg.payload}}</font>",
        "layout": "row-spread",
        "className": "",
        "x": 785,
        "y": 1060,
        "wires": [],
        "l": false
    },
    {
        "id": "dc7fd3f39f82034f",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].parameters.setpoint', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 760,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "ad72ca96abbbda04",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].parameters.setpoint') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 760,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "287e0e0ceab0f3df",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "",
        "links": [
            "b533e4fa8c93b24a",
            "bee9b0aaa92de05c",
            "5793f419da2fa866",
            "3cd6ce4406cb6bbc"
        ],
        "x": 575,
        "y": 760,
        "wires": [
            [
                "ad72ca96abbbda04",
                "ad72ca96abbbda04"
            ]
        ]
    },
    {
        "id": "f105876bb8452e6f",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "set zone",
        "rules": [
            {
                "t": "set",
                "p": "pid.selected_zone",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 815,
        "y": 780,
        "wires": [
            [
                "362eeead535475d1",
                "362eeead535475d1"
            ]
        ],
        "l": false
    },
    {
        "id": "101e026ab1295209",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nvar selected_action = global.get('pid.selected_action') || 0 // 'heating', 'cooling', 'maintaining'\nvar Kp = global.get('pid.zone[' + selected_zone + '].settings.' + selected_action + '.gain.Kp') || 0\nvar Ki = global.get('pid.zone[' + selected_zone + '].settings.' + selected_action + '.gain.Ki') || 0\nvar Kd = global.get('pid.zone[' + selected_zone + '].settings.' + selected_action + '.gain.Kd') || 0\n//global.set('pid.zone[' + selected_zone + '].settings.' + selected_action + '.gain.Kp', Kp)\n//global.set('pid.zone[' + selected_zone + '].settings.' + selected_action + '.gain.Ki', Ki)\n//global.set('pid.zone[' + selected_zone + '].settings.' + selected_action + '.gain.Kd', Kd)\nglobal.set('pid.zone[' + selected_zone + '].settings.' + selected_action + '.time.PB', 100/Kp)\nglobal.set('pid.zone[' + selected_zone + '].settings.' + selected_action + '.time.Ti', Kp/Ki)\nglobal.set('pid.zone[' + selected_zone + '].settings.' + selected_action + '.time.Td', Kd/Kp)\n\nreturn msg;\n\n//https://knowledge.ni.com/KnowledgeArticleDetails?id=kA00Z0000019L5TSAU&l=en-US\n//https://www.controleng.com/articles/understanding-derivative-in-pid-control/\n//https://en.wikipedia.org/wiki/PID_controller",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 800,
        "wires": [
            [
                "6c642e204f07ada4",
                "6c642e204f07ada4"
            ]
        ],
        "l": false
    },
    {
        "id": "d90c5421811f3d01",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].autotune.setpoint', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 820,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "9a9fdf8f6e8bbef2",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].autotune.rate', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 840,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "7a6d3d40ee58594a",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].id', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 860,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "299b028606dbaba5",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "get zone",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "pid.selected_zone",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 695,
        "y": 780,
        "wires": [
            [
                "3145db745f792654",
                "3145db745f792654"
            ]
        ],
        "l": false
    },
    {
        "id": "9e758dbc39404bb8",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].autotune.setpoint') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 820,
        "wires": [
            [
                "3e412e382c7935ac"
            ]
        ],
        "l": false
    },
    {
        "id": "3aa827944da4334b",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].autotune.rate') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 840,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "264235440a742302",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].id') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 860,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "362eeead535475d1",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "9ace848fd4fa953c",
            "5926fc467620cb66"
        ],
        "x": 875,
        "y": 780,
        "wires": []
    },
    {
        "id": "6c642e204f07ada4",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "598a311988e79e25",
            "9ace848fd4fa953c"
        ],
        "x": 875,
        "y": 800,
        "wires": []
    },
    {
        "id": "c50964ed6fac2ae1",
        "type": "ui_button",
        "z": "b83fb43068cdf48f",
        "name": "start",
        "group": "6b9044739353ec6a",
        "order": 2,
        "width": 5,
        "height": 1,
        "passthru": false,
        "label": "Start",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 75,
        "y": 580,
        "wires": [
            [
                "27787572425fc29d"
            ]
        ],
        "l": false
    },
    {
        "id": "123ca3b054938124",
        "type": "ui_button",
        "z": "b83fb43068cdf48f",
        "name": "stop",
        "group": "6b9044739353ec6a",
        "order": 6,
        "width": 5,
        "height": 1,
        "passthru": false,
        "label": "Stop",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 75,
        "y": 620,
        "wires": [
            [
                "c3273409af651b10"
            ]
        ],
        "l": false
    },
    {
        "id": "e0212f99f8fa6abc",
        "type": "ui_text",
        "z": "b83fb43068cdf48f",
        "group": "6b9044739353ec6a",
        "order": 9,
        "width": 14,
        "height": 1,
        "name": "status",
        "label": "Status",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 275,
        "y": 660,
        "wires": [],
        "l": false
    },
    {
        "id": "d4de0420135c8286",
        "type": "ui_button",
        "z": "b83fb43068cdf48f",
        "name": "",
        "group": "6b9044739353ec6a",
        "order": 11,
        "width": 6,
        "height": 1,
        "passthru": false,
        "label": "Accept",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "accept",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 755,
        "y": 800,
        "wires": [
            [
                "101e026ab1295209"
            ]
        ],
        "l": false
    },
    {
        "id": "3e412e382c7935ac",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "auto-tune sp",
        "label": "Setpoint",
        "tooltip": "",
        "group": "6b9044739353ec6a",
        "order": 7,
        "width": 7,
        "height": 1,
        "wrap": false,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": "-10000",
        "max": "10000",
        "step": "10",
        "className": "",
        "x": 755,
        "y": 820,
        "wires": [
            [
                "d90c5421811f3d01"
            ]
        ],
        "l": false
    },
    {
        "id": "3b13c26c7cd91f4b",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "tuned Kp",
        "label": "Kp",
        "tooltip": "",
        "group": "6b9044739353ec6a",
        "order": 13,
        "width": 4,
        "height": 1,
        "wrap": false,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": "-10000",
        "max": "10000",
        "step": "0.00001",
        "className": "",
        "x": 755,
        "y": 880,
        "wires": [
            [
                "97c7b99a0a39a4a1"
            ]
        ],
        "l": false
    },
    {
        "id": "4b422ecd2ab572b7",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "tuned Ki",
        "label": "Ki",
        "tooltip": "",
        "group": "6b9044739353ec6a",
        "order": 15,
        "width": 4,
        "height": 1,
        "wrap": false,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": "-10000",
        "max": "10000",
        "step": "0.00001",
        "className": "",
        "x": 755,
        "y": 900,
        "wires": [
            [
                "c9b0629ff03b905a"
            ]
        ],
        "l": false
    },
    {
        "id": "f346a6914e5b0d0a",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "tuned Kd",
        "label": "Kd",
        "tooltip": "",
        "group": "6b9044739353ec6a",
        "order": 17,
        "width": 4,
        "height": 1,
        "wrap": false,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": "-10000",
        "max": "10000",
        "step": "0.00001",
        "className": "",
        "x": 755,
        "y": 920,
        "wires": [
            [
                "8012c7b1159fd050"
            ]
        ],
        "l": false
    },
    {
        "id": "3a1438a5665ec43e",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nvar selected_action = global.get('pid.selected_action') || 0 // 'heating', 'cooling', 'maintaining'\nmsg.payload = global.get('pid.zone[' + selected_zone + '].settings.' + selected_action + '.gain.Kp') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 880,
        "wires": [
            [
                "3b13c26c7cd91f4b"
            ]
        ],
        "l": false
    },
    {
        "id": "27f7045e7c6618ef",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nvar selected_action = global.get('pid.selected_action') // 'heating', 'cooling', 'maintaining'\nmsg.payload = global.get('pid.zone[' + selected_zone + '].settings.' + selected_action + '.gain.Ki') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 900,
        "wires": [
            [
                "4b422ecd2ab572b7"
            ]
        ],
        "l": false
    },
    {
        "id": "d6d4fadaca2168e9",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nvar selected_action = global.get('pid.selected_action') || 0 // 'heating', 'cooling', 'maintaining'\nmsg.payload = global.get('pid.zone[' + selected_zone + '].settings.' + selected_action + '.gain.Kd') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 920,
        "wires": [
            [
                "f346a6914e5b0d0a"
            ]
        ],
        "l": false
    },
    {
        "id": "97c7b99a0a39a4a1",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nvar selected_action = global.get('pid.selected_action') || 0 // 'heating', 'cooling', 'maintaining'\nglobal.set('pid.zone[' + selected_zone + '].settings.' + selected_action + '.gain.Kp', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 880,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "c9b0629ff03b905a",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nvar selected_action = global.get('pid.selected_action') || 0 // 'heating', 'cooling', 'maintaining'\nglobal.set('pid.zone[' + selected_zone + '].settings.' + selected_action + '.gain.Ki', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 900,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "8012c7b1159fd050",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nvar selected_action = global.get('pid.selected_action') || 0 // 'heating', 'cooling', 'maintaining'\nglobal.set('pid.zone[' + selected_zone + '].settings.' + selected_action + '.gain.Kd', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 920,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "78195abb9bec9ca7",
        "type": "ui_dropdown",
        "z": "b83fb43068cdf48f",
        "name": "",
        "label": "Action",
        "tooltip": "",
        "place": "Select action",
        "group": "6b9044739353ec6a",
        "order": 3,
        "width": 7,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "heating",
                "value": "heating",
                "type": "str"
            },
            {
                "label": "cooling",
                "value": "cooling",
                "type": "str"
            },
            {
                "label": "maintaining",
                "value": "maintaining",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "topic",
        "topicType": "msg",
        "className": "",
        "x": 755,
        "y": 940,
        "wires": [
            [
                "e46c54fd714b3355"
            ]
        ],
        "l": false
    },
    {
        "id": "f2550ccb2c8302f1",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "msg.payload = global.get('pid.selected_action') || 0 // 'heating', 'cooling', 'maintaining'\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 940,
        "wires": [
            [
                "78195abb9bec9ca7"
            ]
        ],
        "l": false
    },
    {
        "id": "e46c54fd714b3355",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "global.set('pid.selected_action', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 940,
        "wires": [
            [
                "7ba72c04c9ad9266"
            ]
        ],
        "l": false
    },
    {
        "id": "07cdd33a021030f4",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "pid.zone[2].autotune.active",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 185,
        "y": 360,
        "wires": [
            [
                "1cc3f245a847a3d0"
            ]
        ],
        "l": false
    },
    {
        "id": "c51f5f99a3b50c74",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "pid.zone[3].autotune.active",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 645,
        "y": 360,
        "wires": [
            [
                "ccbdd10cb54a906c"
            ]
        ],
        "l": false
    },
    {
        "id": "a5c6380a3f3c2b32",
        "type": "smooth",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "payload",
        "action": "low",
        "count": "20",
        "round": "",
        "mult": "single",
        "reduce": false,
        "x": 285,
        "y": 420,
        "wires": [
            [
                "acaf9302560db8b4",
                "f473728b7ae37ca2"
            ]
        ],
        "l": false
    },
    {
        "id": "82008bc92cbf7d6d",
        "type": "smooth",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "payload",
        "action": "low",
        "count": "20",
        "round": "",
        "mult": "single",
        "reduce": false,
        "x": 745,
        "y": 420,
        "wires": [
            [
                "546fc99e5e691238",
                "7abb781e2be6035b"
            ]
        ],
        "l": false
    },
    {
        "id": "73dc68879c84838d",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 255,
        "y": 720,
        "wires": [],
        "l": false
    },
    {
        "id": "d36e49a591261d50",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "//var selected_zone = global.get('pid.selected_zone') || 0\n//msg.setpoint = global.get('pid.zone[' + selected_zone + '].autotune.setpoint') || 0\nmsg.topic = 'temp-BK'\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 205,
        "y": 680,
        "wires": [
            [
                "70c0bc1ae3c6d12d",
                "73dc68879c84838d"
            ]
        ],
        "l": false
    },
    {
        "id": "94caaeb1c8b9263b",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 215,
        "y": 580,
        "wires": [],
        "l": false
    },
    {
        "id": "1396628d0ea3f917",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "94112e9a2839cf54"
        ],
        "x": 255,
        "y": 140,
        "wires": []
    },
    {
        "id": "ac657527b6dfaca0",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "d10bbe6d04d1179a"
        ],
        "x": 715,
        "y": 140,
        "wires": []
    },
    {
        "id": "81f7f54ee10d9601",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var temp_zone_id = 1\nvar ramp_zone_id = 3\nvar auto_tune = global.get('pid.zone['+temp_zone_id+'].autotune.active')\nif (auto_tune) {\n    var action = global.get('pid.selected_action')\n    if (action == 'heating' || action == 'cooling') {\n        var cv = global.get('pid.zone['+temp_zone_id+'].parameters.control')\n        var setpoint = global.get('pid.zone['+ramp_zone_id+'].autotune.setpoint')\n        if (cv > 0 ) {\n            msg.payload = setpoint/cv * 100\n            msg.action = global.get('pid.selected_action')\n        } else {\n            msg.payload = 0\n            msg.action = 'Off'\n        }\n        return [null, msg];\n    } else if (action == 'maintaining'){\n        msg.payload = global.get('pid.zone['+temp_zone_id+'].parameters.control')\n        return [msg, null];\n    }\n}",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 645,
        "y": 140,
        "wires": [
            [
                "3ead42b5645fe82a"
            ],
            [
                "ac657527b6dfaca0"
            ]
        ],
        "l": false
    },
    {
        "id": "ea31253a46d4b358",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var temp_zone_id = 0\nvar ramp_zone_id = 2\nvar auto_tune = global.get('pid.zone['+temp_zone_id+'].autotune.active')\nif (auto_tune) {\n    var action = global.get('pid.selected_action')\n    if (action == 'heating' || action == 'cooling') {\n        var cv = global.get('pid.zone['+temp_zone_id+'].parameters.control')\n        var setpoint = global.get('pid.zone['+ramp_zone_id+'].autotune.setpoint')\n        if (cv > 0 ) {\n            msg.payload = setpoint/cv * 100\n            msg.action = global.get('pid.selected_action')\n        } else {\n            msg.payload = 0\n            msg.action = 'Off'\n        }\n        return [null, msg];\n    } else if (action == 'maintaining'){\n        msg.payload = global.get('pid.zone['+temp_zone_id+'].parameters.control')\n        return [msg, null];\n    }\n}",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 185,
        "y": 140,
        "wires": [
            [
                "7ef113d46af94fa7"
            ],
            [
                "1396628d0ea3f917"
            ]
        ],
        "l": false
    },
    {
        "id": "7d41f5125ed5ccf8",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "",
        "links": [
            "7ba72c04c9ad9266"
        ],
        "x": 545,
        "y": 880,
        "wires": [
            [
                "3a1438a5665ec43e",
                "27f7045e7c6618ef",
                "d6d4fadaca2168e9"
            ]
        ]
    },
    {
        "id": "7ba72c04c9ad9266",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "7d41f5125ed5ccf8"
        ],
        "x": 875,
        "y": 940,
        "wires": []
    },
    {
        "id": "7ef113d46af94fa7",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "digitaloutput.output[0].duty_cycle",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 255,
        "y": 100,
        "wires": [
            [
                "0cd87642d8d48f72"
            ]
        ],
        "l": false
    },
    {
        "id": "1cc3f245a847a3d0",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "digitaloutput.output[0].duty_cycle",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 285,
        "y": 340,
        "wires": [
            [
                "647356533bb8d48c"
            ]
        ],
        "l": false
    },
    {
        "id": "0cd87642d8d48f72",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 315,
        "y": 100,
        "wires": [],
        "l": false
    },
    {
        "id": "647356533bb8d48c",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 345,
        "y": 340,
        "wires": [],
        "l": false
    },
    {
        "id": "ccbdd10cb54a906c",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "digitaloutput.output[1].duty_cycle",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 745,
        "y": 340,
        "wires": [
            [
                "2c2e53cd950c2273"
            ]
        ],
        "l": false
    },
    {
        "id": "2c2e53cd950c2273",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 805,
        "y": 340,
        "wires": [],
        "l": false
    },
    {
        "id": "3ead42b5645fe82a",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "digitaloutput.output[1].duty_cycle",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 715,
        "y": 100,
        "wires": [
            [
                "165d4145e067fa57"
            ]
        ],
        "l": false
    },
    {
        "id": "165d4145e067fa57",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 775,
        "y": 100,
        "wires": [],
        "l": false
    },
    {
        "id": "35573d9f8cb557cc",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "get upper temp",
        "func": "// https://github.com/maugdog/max31855\n// https://cdn-shop.adafruit.com/datasheets/MAX31855.pdf#page=10\n\n/**\n * Node.js module for driving the Adafruit MAX31855 thermocouple temperature amplifier on Raspberry Pi.\n *\n * Currently supports only hardware SPI configuration (as opposed to software SPI using GPIO pins).\n * Note: May require running under sudo for SPI permissions.\n * Note: The SPI master driver is disabled by default on Raspian Linux and must be enabled. see here:\n * https://www.raspberrypi.org/documentation/hardware/raspberrypi/spi/README.md\n */\n\n//var SPI = require('pi-spi');\n\nfunction MAX31855(spidev) {\n  // Initialize the SPI settings\n  //this._spi = SPI.initialize(\"/dev/spidev0.0\");\n  this._spi = SPI.initialize(spidev);\n  this._spi.clockSpeed(5000000);\n  this._spi.dataMode(0);\n  this._spi.bitOrder(SPI.order.MSB_FIRST);\n}\n\n/** Read 32 bits from the SPI bus. */\nMAX31855.prototype._read32 = function (callback) {\n  this._spi.read(4, function (error, bytes) {\n    if (error) {\n      console.error(error);\n    } else {\n      if (!bytes || bytes.length != 4) {\n        throw new Error('MAX31855: Did not read expected number of bytes from device!');\n      } else {\n        var value\n        value = bytes[0] << 24 | bytes[1] << 16 | bytes[2] << 8 | bytes[3];\n        callback(value);\n      }\n    }\n  });\n};\n\n/** Returns the internal temperature value in degrees Celsius. */\nMAX31855.prototype.readInternalC = function (callback) {\n  if (callback) {\n    this._read32(function (value) {\n      // Ignore bottom 4 bits of thermocouple data.\n      value >>= 4;\n      // Grab bottom 11 bits as internal temperature data.\n      var internal = value & 0x7FF;\n      if (value & 0x800) {\n        // Negative value, take 2's compliment.\n        internal = ~internal + 1;\n      }\n      // Scale by 0.0625 degrees C per bit and return value.\n      callback(internal * 0.0625);\n    });\n  } else {\n    console.log('MAX31855: Read request issued with no callback.');\n  }\n};\n\n/** Return the thermocouple temperature value. Value is returned in degrees celsius */\nMAX31855.prototype.readTempC = function (callback) {\n  if (callback) {\n    var self = this; // Scope closure\n    this._read32(function (value) {\n      // Check for error reading value.\n      //if (value & 0x7) { // 2=short to vcc, 1=short to gnd, 0=open circuit\n      if (value & 0x1) { // 2=short to vcc, 1=short to gnd, 0=open circuit\n        callback(NaN);\n      } else {\n        if (value & 0x80000000) { // Check if signed bit is set.\n          // Negative value, shift the bits and take 2's compliment.\n          value >>= 18;\n          value = ~value + 1;\n        } else { // Positive value, just shift the bits to get the value.\n          value >>= 18;\n        }\n        // Scale by 0.25 degrees C per bit\n        callback(value * 0.25);\n      }\n    });\n  } else {\n    console.log('MAX31855: Read request issued with no callback.');\n  }\n};\n\nvar thermoSensor = new MAX31855(msg.spidev);\nthermoSensor.readTempC(function (temp) {\n  temp = temp * 9 / 5 + 32\n  node.status({ fill: \"green\", shape: \"dot\", text: temp + '°F' });\n  var newMsg = { \"payload\": temp }\n  node.send(newMsg); // node.send() is needed for async\n  node.done();\n});",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [
            {
                "var": "SPI",
                "module": "pi-spi"
            }
        ],
        "x": 295,
        "y": 260,
        "wires": [
            [
                "ee0291f3aba6669c",
                "0d670f61e6fde01c"
            ]
        ],
        "l": false
    },
    {
        "id": "90d2df249ed5559d",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "get lower temp",
        "func": "// https://github.com/maugdog/max31855\n// https://cdn-shop.adafruit.com/datasheets/MAX31855.pdf#page=10\n\n/**\n * Node.js module for driving the Adafruit MAX31855 thermocouple temperature amplifier on Raspberry Pi.\n *\n * Currently supports only hardware SPI configuration (as opposed to software SPI using GPIO pins).\n * Note: May require running under sudo for SPI permissions.\n * Note: The SPI master driver is disabled by default on Raspian Linux and must be enabled. see here:\n * https://www.raspberrypi.org/documentation/hardware/raspberrypi/spi/README.md\n */\n\n//var SPI = require('pi-spi');\n\nfunction MAX31855(spidev) {\n  // Initialize the SPI settings\n  //this._spi = SPI.initialize(\"/dev/spidev0.0\");\n  this._spi = SPI.initialize(spidev);\n  this._spi.clockSpeed(5000000);\n  this._spi.dataMode(0);\n  this._spi.bitOrder(SPI.order.MSB_FIRST);\n}\n\n/** Read 32 bits from the SPI bus. */\nMAX31855.prototype._read32 = function(callback) {\n  this._spi.read(4, function(error, bytes) {\n    if(error) {\n      console.error(error);\n    } else {\n      if(!bytes || bytes.length != 4) {\n        throw new Error('MAX31855: Did not read expected number of bytes from device!');\n      } else {\n        var value\n        value = bytes[0] << 24 | bytes[1] << 16 | bytes[2] << 8 | bytes[3];\n        //console.log('Raw value: ', value);\n        callback(value);\n      }\n    }\n  });\n};\n\n/** Returns the internal temperature value in degrees Celsius. */\nMAX31855.prototype.readInternalC = function(callback) {\n  if(callback) {\n    this._read32(function(value) {\n      // Ignore bottom 4 bits of thermocouple data.\n  \t\tvalue >>= 4;\n  \t\t// Grab bottom 11 bits as internal temperature data.\n  \t\tvar internal = value & 0x7FF;\n  \t\tif(value & 0x800) {\n        // Negative value, take 2's compliment.\n        internal = ~internal + 1;\n      }\n      // Scale by 0.0625 degrees C per bit and return value.\n      callback(internal * 0.0625);\n    });\n  } else {\n    console.log('MAX31855: Read request issued with no callback.');\n  }\n};\n\n/** Return the thermocouple temperature value. Value is returned in degrees celsius */\nMAX31855.prototype.readTempC = function(callback) {\n  if(callback) {\n    var self = this; // Scope closure\n    this._read32(function(value) {\n      // Check for error reading value.\n      //if (value & 0x7) { // 2=short to vcc, 1=short to gnd, 0=open circuit\n      if (value & 0x1) { // 2=short to vcc, 1=short to gnd, 0=open circuit\n        callback(NaN);\n      } else {\n        if(value & 0x80000000) { // Check if signed bit is set.\n          // Negative value, shift the bits and take 2's compliment.\n          value >>= 18;\n          value = ~value + 1;\n        } else { // Positive value, just shift the bits to get the value.\n          value >>= 18;\n        }\n        // Scale by 0.25 degrees C per bit\n        callback(value * 0.25);\n      }\n    });\n  } else {\n    console.log('MAX31855: Read request issued with no callback.');\n  }\n};\n\nvar thermoSensor = new MAX31855(msg.spidev);\nthermoSensor.readTempC(function (temp) {\n  temp = temp * 9 / 5 + 32\n  node.status({ fill: \"green\", shape: \"dot\", text: temp + '°F' });\n  var newMsg = { \"payload\": temp}\n  node.send(newMsg); // node.send() is needed for async\n  node.done();\n});",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [
            {
                "var": "SPI",
                "module": "pi-spi"
            }
        ],
        "x": 295,
        "y": 460,
        "wires": [
            [
                "b439be6284f42bd5",
                "8c970109233d3f07"
            ]
        ],
        "l": false
    },
    {
        "id": "774be46b1df4202c",
        "type": "catch",
        "z": "3154c44d1a91de38",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 60,
        "y": 20,
        "wires": [
            [
                "08d3626ca47817b7"
            ]
        ]
    },
    {
        "id": "08d3626ca47817b7",
        "type": "debug",
        "z": "3154c44d1a91de38",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 155,
        "y": 20,
        "wires": [],
        "l": false
    },
    {
        "id": "6c490df17d1de881",
        "type": "rbe",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "deadbandEq",
        "gap": "1",
        "start": "",
        "inout": "out",
        "septopics": false,
        "property": "payload",
        "topi": "topic",
        "x": 655,
        "y": 380,
        "wires": [
            [
                "dbaab26e980063a4"
            ]
        ],
        "l": false
    },
    {
        "id": "bd45525a6924a5c5",
        "type": "rbe",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "deadbandEq",
        "gap": "1",
        "start": "",
        "inout": "out",
        "septopics": false,
        "property": "payload",
        "topi": "topic",
        "x": 655,
        "y": 340,
        "wires": [
            [
                "5cdb1e903b180a71"
            ]
        ],
        "l": false
    },
    {
        "id": "dcbc073ea7b777ee",
        "type": "link out",
        "z": "3154c44d1a91de38",
        "name": "Output - Upper Temperature",
        "mode": "link",
        "links": [
            "26cb94d0aa740af8",
            "9b6b7f2249d013ba",
            "731f4e17a1f3392d"
        ],
        "x": 655,
        "y": 300,
        "wires": []
    },
    {
        "id": "e65201e766b76bfd",
        "type": "link out",
        "z": "3154c44d1a91de38",
        "name": "Output - Lower Temperature",
        "mode": "link",
        "links": [
            "4ea9f6ce194f1281",
            "9fea36d4825b738a",
            "f30c6739d0a3c556"
        ],
        "x": 655,
        "y": 420,
        "wires": []
    },
    {
        "id": "1235c1dcd4711779",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "build measurement",
        "rules": [
            {
                "t": "delete",
                "p": "topic",
                "pt": "msg"
            },
            {
                "t": "set",
                "p": "measurement",
                "pt": "msg",
                "to": "Kiln_01_UpperTemperature",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 775,
        "y": 340,
        "wires": [
            [
                "2f036bde9aaff376"
            ]
        ],
        "l": false
    },
    {
        "id": "9468a3b6de1782db",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "build measurement",
        "rules": [
            {
                "t": "delete",
                "p": "topic",
                "pt": "msg"
            },
            {
                "t": "set",
                "p": "measurement",
                "pt": "msg",
                "to": "Kiln_01_LowerTemperature",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 775,
        "y": 380,
        "wires": [
            [
                "2f036bde9aaff376"
            ]
        ],
        "l": false
    },
    {
        "id": "bc3e2212fd11e206",
        "type": "ui_switch",
        "z": "3154c44d1a91de38",
        "name": "",
        "label": "Simulation",
        "tooltip": "",
        "group": "112aa19380852c23",
        "order": 3,
        "width": 3,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 410,
        "y": 920,
        "wires": [
            [
                "d76c7ce673b280af"
            ]
        ]
    },
    {
        "id": "d76c7ce673b280af",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "set sim temp",
        "rules": [
            {
                "t": "set",
                "p": "kiln_01.SimulateTemperature",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 515,
        "y": 920,
        "wires": [
            [
                "a3ad47349ae89c29"
            ]
        ],
        "l": false
    },
    {
        "id": "f45e246dbf521446",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "check sim temp",
        "property": "kiln_01.SimulateTemperature",
        "propertyType": "global",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 135,
        "y": 360,
        "wires": [
            [
                "159e09add5a1e1ed",
                "0402b15e862a2745"
            ]
        ],
        "l": false
    },
    {
        "id": "2f036bde9aaff376",
        "type": "influxdb out",
        "z": "3154c44d1a91de38",
        "influxdb": "1a7d214ba0ada216",
        "name": "",
        "measurement": "",
        "precision": "",
        "retentionPolicy": "",
        "database": "home",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "52w",
        "org": "organisation",
        "bucket": "bucket",
        "x": 855,
        "y": 360,
        "wires": [],
        "l": false
    },
    {
        "id": "dbaab26e980063a4",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "temp cutoff",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gte",
                "v": "50",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 715,
        "y": 380,
        "wires": [
            [
                "9468a3b6de1782db"
            ]
        ],
        "l": false
    },
    {
        "id": "5cdb1e903b180a71",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "temp cutoff",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gte",
                "v": "50",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 715,
        "y": 340,
        "wires": [
            [
                "1235c1dcd4711779"
            ]
        ],
        "l": false
    },
    {
        "id": "477ed7158a34c5bf",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "get sim temp",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "kiln_01.SimulateTemperature",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 295,
        "y": 920,
        "wires": [
            [
                "bc3e2212fd11e206"
            ]
        ],
        "l": false
    },
    {
        "id": "a3ad47349ae89c29",
        "type": "link out",
        "z": "3154c44d1a91de38",
        "name": "",
        "mode": "link",
        "links": [
            "218ba5aacd9d564e"
        ],
        "x": 575,
        "y": 920,
        "wires": []
    },
    {
        "id": "16e8124d59e7fb62",
        "type": "rpi-gpio out",
        "z": "3154c44d1a91de38",
        "name": "Upper Heater",
        "pin": "26",
        "set": true,
        "level": "0",
        "freq": "",
        "out": "out",
        "bcm": true,
        "x": 600,
        "y": 680,
        "wires": []
    },
    {
        "id": "708a944b9506b9a4",
        "type": "trigger",
        "z": "3154c44d1a91de38",
        "name": "",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "200",
        "extend": false,
        "overrideDelay": true,
        "units": "ms",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 455,
        "y": 660,
        "wires": [
            [
                "16e8124d59e7fb62"
            ]
        ],
        "l": false
    },
    {
        "id": "11d1503b33735b7a",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "initialize",
        "rules": [
            {
                "t": "set",
                "p": "#:(memoryOnly)::kiln_01.Setpoint",
                "pt": "global",
                "to": "0",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "#:(memoryOnly)::kiln_01.UpperSetpoint",
                "pt": "global",
                "to": "0",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "#:(memoryOnly)::kiln_01.LowerSetpoint",
                "pt": "global",
                "to": "0",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "kiln_01.SimulateTemperature",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "upper_thermocouple_bad",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "lower_thermocouple_bad",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 395,
        "y": 20,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "12681729a71ef662",
        "type": "rpi-gpio out",
        "z": "3154c44d1a91de38",
        "name": "Lower Heater",
        "pin": "19",
        "set": true,
        "level": "0",
        "freq": "",
        "out": "out",
        "bcm": true,
        "x": 600,
        "y": 780,
        "wires": []
    },
    {
        "id": "26dcb58ffb63fae4",
        "type": "trigger",
        "z": "3154c44d1a91de38",
        "name": "",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "200",
        "extend": false,
        "overrideDelay": true,
        "units": "ms",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 455,
        "y": 760,
        "wires": [
            [
                "12681729a71ef662"
            ]
        ],
        "l": false
    },
    {
        "id": "e4a7e7415279dc26",
        "type": "comment",
        "z": "3154c44d1a91de38",
        "name": "ssr output",
        "info": "",
        "x": 80,
        "y": 620,
        "wires": []
    },
    {
        "id": "4411f03fad54a3bf",
        "type": "comment",
        "z": "3154c44d1a91de38",
        "name": "thermocouple input",
        "info": "",
        "x": 110,
        "y": 140,
        "wires": []
    },
    {
        "id": "0d670f61e6fde01c",
        "type": "smooth",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "payload",
        "action": "low",
        "count": "100",
        "round": "",
        "mult": "single",
        "reduce": false,
        "x": 375,
        "y": 260,
        "wires": [
            [
                "88697b6b43b4084e"
            ]
        ],
        "l": false
    },
    {
        "id": "8c970109233d3f07",
        "type": "smooth",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "payload",
        "action": "low",
        "count": "100",
        "round": "",
        "mult": "single",
        "reduce": false,
        "x": 375,
        "y": 460,
        "wires": [
            [
                "409049cb84c39312"
            ]
        ],
        "l": false
    },
    {
        "id": "d4cb1a52a4fe0d75",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "var output_id = 0\nvar duty_cycle = global.get('digitaloutput.output['+output_id+'].duty_cycle')\nvar msg_out = { delay: duty_cycle * 10 }; // should come in as 0 - 100%\nvar FsmStatus_Schedule = global.get('kiln_01.FsmStatus_Schedule','memoryOnly')\nvar auto_tune_upper = output_id == 0 && (global.get('pid.zone[0].autotune.active') || global.get('pid.zone[2].autotune.active'))\nvar auto_tune_lower = output_id == 1 && (global.get('pid.zone[1].autotune.active') || global.get('pid.zone[3].autotune.active'))\nvar upper_thermocouple_bad = flow.get('upper_thermocouple_bad')\nvar lower_thermocouple_bad = flow.get('lower_thermocouple_bad')\nvar simulation = global.get('kiln_01.SimulateTemperature')\n\nif (!upper_thermocouple_bad && !lower_thermocouple_bad && !simulation\n    && ( FsmStatus_Schedule !== 'IDLE' || (auto_tune_upper || auto_tune_lower ))) {\n        // the trigger function locks up if you send it a zero\n        // similarly, we dont want to send it a value over\n        // the trigger time (1000 ms)\n        if (msg_out.delay > 0 && msg_out.delay < 1000) {\n            node.status({fill:\"green\",shape:\"dot\",text:duty_cycle.toFixed(1) + '%'});\n            return [ msg_out, null ];\n        } else if (msg_out.delay <= 0) {\n            // send an \"off\" directly to the output node\n            node.status({fill:\"green\",shape:\"ring\",text:'0%'});\n            msg_out.payload = \"0\"\n            return [ null, msg_out ];\n        } else if (msg_out.delay >= 1000){\n            // send an \"on\" directly to the output node\n            node.status({fill:\"green\",shape:\"dot\",text:'100%'});\n            msg_out.payload = \"1\"\n            return [ null, msg_out ];\n        } else {\n            // send an \"off\" directly to the output node\n            node.status({fill:\"green\",shape:\"ring\",text:'0%'});\n            msg_out.payload = \"0\"\n            return [ null, msg_out ];\n        }\n} else if (simulation) {\n    // send an \"off\" directly to the output node\n    node.status({fill:\"blue\",shape:\"dot\",text:\"Simulation\"});\n    msg_out.payload = \"0\"\n    return [ null, msg_out ];\n} else {\n    // send an \"off\" directly to the output node\n    node.status({fill:\"blue\",shape:\"dot\",text:\"Disabled\"});\n    msg_out.payload = \"0\"\n    return [ null, msg_out ];\n}",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 355,
        "y": 680,
        "wires": [
            [
                "708a944b9506b9a4",
                "19c89045bda88732"
            ],
            [
                "16e8124d59e7fb62"
            ]
        ],
        "l": false
    },
    {
        "id": "5bb8a83cadcb2ba3",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "var output_id = 1\nvar duty_cycle = global.get('digitaloutput.output['+output_id+'].duty_cycle')\nvar msg_out = { delay: duty_cycle * 10 }; // should come in as 0 - 100%\nvar FsmStatus_Schedule = global.get('kiln_01.FsmStatus_Schedule','memoryOnly')\nvar auto_tune_upper = output_id == 0 && (global.get('pid.zone[0].autotune.active') || global.get('pid.zone[2].autotune.active'))\nvar auto_tune_lower = output_id == 1 && (global.get('pid.zone[1].autotune.active') || global.get('pid.zone[3].autotune.active'))\nvar upper_thermocouple_bad = flow.get('upper_thermocouple_bad')\nvar lower_thermocouple_bad = flow.get('lower_thermocouple_bad')\nvar simulation = global.get('kiln_01.SimulateTemperature')\n\nif (!upper_thermocouple_bad && !lower_thermocouple_bad && !simulation\n    && ( FsmStatus_Schedule !== 'IDLE' || (auto_tune_upper || auto_tune_lower ))) {\n        // the trigger function locks up if you send it a zero\n        // similarly, we dont want to send it a value over\n        // the trigger time (1000 ms)\n        if (msg_out.delay > 0 && msg_out.delay < 1000) {\n            node.status({fill:\"green\",shape:\"dot\",text:duty_cycle.toFixed(1) + '%'});\n            return [ msg_out, null ];\n        } else if (msg_out.delay <= 0) {\n            // send an \"off\" directly to the output node\n            node.status({fill:\"green\",shape:\"ring\",text:'0%'});\n            msg_out.payload = \"0\"\n            return [ null, msg_out ];\n        } else if (msg_out.delay >= 1000){\n            // send an \"on\" directly to the output node\n            node.status({fill:\"green\",shape:\"dot\",text:'100%'});\n            msg_out.payload = \"1\"\n            return [ null, msg_out ];\n        } else {\n            // send an \"off\" directly to the output node\n            node.status({fill:\"green\",shape:\"ring\",text:'0%'});\n            msg_out.payload = \"0\"\n            return [ null, msg_out ];\n        }\n} else if (simulation) {\n    // send an \"off\" directly to the output node\n    node.status({fill:\"blue\",shape:\"dot\",text:\"Simulation\"});\n    msg_out.payload = \"0\"\n    return [ null, msg_out ];\n} else {\n    // send an \"off\" directly to the output node\n    node.status({fill:\"blue\",shape:\"dot\",text:\"Disabled\"});\n    msg_out.payload = \"0\"\n    return [ null, msg_out ];\n}",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 355,
        "y": 780,
        "wires": [
            [
                "26dcb58ffb63fae4",
                "bc8323ef9436386d"
            ],
            [
                "12681729a71ef662"
            ]
        ],
        "l": false
    },
    {
        "id": "159e09add5a1e1ed",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "spidev",
                "pt": "msg",
                "to": "/dev/spidev0.1",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 235,
        "y": 260,
        "wires": [
            [
                "35573d9f8cb557cc"
            ]
        ],
        "l": false
    },
    {
        "id": "0402b15e862a2745",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "spidev",
                "pt": "msg",
                "to": "/dev/spidev0.0",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 235,
        "y": 460,
        "wires": [
            [
                "90d2df249ed5559d"
            ]
        ],
        "l": false
    },
    {
        "id": "aec3c2c38a63dd10",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "#:(memoryOnly)::kiln_01.UpperTemperature",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 655,
        "y": 260,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "6ab284ac808bee4a",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "#:(memoryOnly)::kiln_01.LowerTemperature",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 655,
        "y": 460,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "ba263ec1075b0897",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "initialize variables",
        "func": "var input = []\nvar inputcount = 2\nfor (let index = 0; index < inputcount; index++) {\n    var x = { min: 0.0, max: 0.0 };\n    var y = { min: 0.0, max: 0.0 };\n    var calibration = { x, y, span: 0.0, offset: 0.0 }\n    calibration.x.min = 0.0; calibration.x.max = 0.0; calibration.y.min = 0.0; calibration.y.max = 0.0;\n    calibration.span = 0.0; calibration.offset = 0.0;\n    var obj2 = { HiHi: 0.0, Hi: 0.0, Lo: 0.0, LoLo: 0.0 }\n    var limits = Object.create(obj2)\n    limits.HiHi = 0.0; limits.Hi = 0.0; limits.Lo = 0.0; limits.LoLo = 0.0;\n    var obj3 = { HiHi: false, Hi: false, Lo: false, LoLo: false }\n    var alarms = Object.create(obj3)\n    alarms.HiHi = false; alarms.Hi = false; alarms.Lo = false; alarms.LoLo = false;\n    input.push({ id: '', raw: 0.0, scaled: 0.0, calibration, limits, alarms })\n}\nvar analoginput = { selected_input: 0, input }\n//global.set('analoginput', analoginput, 'memoryOnly')\nglobal.set('analoginput', analoginput)\nmsg.payload = { analoginput }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 535,
        "y": 20,
        "wires": [
            [
                "0174d9742bec95c7"
            ]
        ],
        "l": false
    },
    {
        "id": "de189d290a2ccfe0",
        "type": "inject",
        "z": "3154c44d1a91de38",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 475,
        "y": 20,
        "wires": [
            [
                "ba263ec1075b0897"
            ]
        ],
        "l": false
    },
    {
        "id": "44fc0716fdc686dc",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "handle analog input",
        "func": "var analoginput = global.get('analoginput')\n\ntry {\n    if (!isNaN(msg.payload)){\n        analoginput.input[msg.inputnumber].raw = msg.payload\n        analoginput.input[msg.inputnumber].scaled = msg.payload * analoginput.input[msg.inputnumber].calibration.span + analoginput.input[msg.inputnumber].calibration.offset;\n        if (analoginput.input[msg.inputnumber].scaled >= analoginput.input[msg.inputnumber].limits.HiHi) { analoginput.input[msg.inputnumber].alarms.HiHi = true } else { analoginput.input[msg.inputnumber].alarms.HiHi = false };\n        if (analoginput.input[msg.inputnumber].scaled >= analoginput.input[msg.inputnumber].limits.Hi) { analoginput.input[msg.inputnumber].alarms.Hi = true } else { analoginput.input[msg.inputnumber].alarms.Hi = false };\n        if (analoginput.input[msg.inputnumber].scaled <= analoginput.input[msg.inputnumber].limits.Lo) { analoginput.input[msg.inputnumber].alarms.Lo = true } else { analoginput.input[msg.inputnumber].alarms.Lo = false };\n        if (analoginput.input[msg.inputnumber].scaled <= analoginput.input[msg.inputnumber].limits.LoLo) { analoginput.input[msg.inputnumber].alarms.LoLo = true } else { analoginput.input[msg.inputnumber].alarms.LoLo = false };\n    }\n} catch (error) {\n    node.warn(error)\n};\n\nglobal.set('analoginput', analoginput)\n\nmsg.payload = analoginput.input[msg.inputnumber].scaled\nnode.status({ fill: \"green\", shape: \"ring\", text: msg.payload + '°F' });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 475,
        "y": 260,
        "wires": [
            [
                "138195432c3badec"
            ]
        ],
        "l": false
    },
    {
        "id": "88697b6b43b4084e",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "inputnumber",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 425,
        "y": 260,
        "wires": [
            [
                "44fc0716fdc686dc"
            ]
        ],
        "l": false
    },
    {
        "id": "10d4807e18c79f6f",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "handle analog input",
        "func": "var analoginput = global.get('analoginput')\n\ntry {\n    if (!isNaN(msg.payload)){\n        analoginput.input[msg.inputnumber].raw = msg.payload\n        analoginput.input[msg.inputnumber].scaled = msg.payload * analoginput.input[msg.inputnumber].calibration.span + analoginput.input[msg.inputnumber].calibration.offset;\n        if (analoginput.input[msg.inputnumber].scaled >= analoginput.input[msg.inputnumber].limits.HiHi) { analoginput.input[msg.inputnumber].alarms.HiHi = true } else { analoginput.input[msg.inputnumber].alarms.HiHi = false };\n        if (analoginput.input[msg.inputnumber].scaled >= analoginput.input[msg.inputnumber].limits.Hi) { analoginput.input[msg.inputnumber].alarms.Hi = true } else { analoginput.input[msg.inputnumber].alarms.Hi = false };\n        if (analoginput.input[msg.inputnumber].scaled <= analoginput.input[msg.inputnumber].limits.Lo) { analoginput.input[msg.inputnumber].alarms.Lo = true } else { analoginput.input[msg.inputnumber].alarms.Lo = false };\n        if (analoginput.input[msg.inputnumber].scaled <= analoginput.input[msg.inputnumber].limits.LoLo) { analoginput.input[msg.inputnumber].alarms.LoLo = true } else { analoginput.input[msg.inputnumber].alarms.LoLo = false };\n    }\n} catch (error) {\n    node.warn(error)\n};\n\nglobal.set('analoginput', analoginput)\n\nmsg.payload = analoginput.input[msg.inputnumber].scaled\nnode.status({ fill: \"green\", shape: \"ring\", text: msg.payload + '°F' });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 475,
        "y": 460,
        "wires": [
            [
                "465fe5024865b9db"
            ]
        ],
        "l": false
    },
    {
        "id": "409049cb84c39312",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "inputnumber",
                "pt": "msg",
                "to": "1",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 425,
        "y": 460,
        "wires": [
            [
                "10d4807e18c79f6f"
            ]
        ],
        "l": false
    },
    {
        "id": "dd5fa1a2a7edec40",
        "type": "ui_text",
        "z": "3154c44d1a91de38",
        "group": "112aa19380852c23",
        "order": 6,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Raw",
        "format": "<font color=\"green\" size=\"+3\">{{msg.payload}}</font>",
        "layout": "row-spread",
        "className": "",
        "x": 710,
        "y": 1060,
        "wires": []
    },
    {
        "id": "9d1d6fc5b853b597",
        "type": "ui_text",
        "z": "3154c44d1a91de38",
        "group": "112aa19380852c23",
        "order": 9,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Scaled",
        "format": "<font color=\"green\" size=\"+3\">{{msg.payload}}</font>",
        "layout": "row-spread",
        "className": "",
        "x": 710,
        "y": 1100,
        "wires": []
    },
    {
        "id": "b537b846c99d5ba0",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "var selected_input = global.get('analoginput.selected_input')\nvar input = global.get('analoginput.input['+selected_input+']')\nmsg.input = input\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 515,
        "y": 1060,
        "wires": [
            [
                "ba082e8df156fb74",
                "01fee8c005244e85"
            ]
        ],
        "l": false
    },
    {
        "id": "e5017d61ae5c7809",
        "type": "ui_numeric",
        "z": "3154c44d1a91de38",
        "name": "select input",
        "label": "Input",
        "tooltip": "",
        "group": "112aa19380852c23",
        "order": 1,
        "width": 3,
        "height": 1,
        "wrap": true,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{value}}",
        "min": 0,
        "max": "1",
        "step": 1,
        "className": "",
        "x": 410,
        "y": 960,
        "wires": [
            [
                "c84c7544fd660421"
            ]
        ]
    },
    {
        "id": "d9fcdb3e4f6fe46a",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "get sim temp",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "analoginput.selected_input",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 295,
        "y": 960,
        "wires": [
            [
                "e5017d61ae5c7809"
            ]
        ],
        "l": false
    },
    {
        "id": "c84c7544fd660421",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "get sim temp",
        "rules": [
            {
                "t": "set",
                "p": "analoginput.selected_input",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 515,
        "y": 960,
        "wires": [
            [
                "23106acb85b27ca6"
            ]
        ],
        "l": false
    },
    {
        "id": "4aa0d55a58d20193",
        "type": "ui_numeric",
        "z": "3154c44d1a91de38",
        "name": "xmin",
        "label": "",
        "tooltip": "",
        "group": "112aa19380852c23",
        "order": 16,
        "width": 3,
        "height": 1,
        "wrap": true,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "xmin{{msg.payload}}",
        "min": 0,
        "max": "3000",
        "step": "0.01",
        "className": "",
        "x": 490,
        "y": 1160,
        "wires": [
            [
                "b985d102fbee08b0"
            ]
        ]
    },
    {
        "id": "e62882e76d5a3ed0",
        "type": "ui_numeric",
        "z": "3154c44d1a91de38",
        "name": "xmax",
        "label": "",
        "tooltip": "",
        "group": "112aa19380852c23",
        "order": 18,
        "width": 3,
        "height": 1,
        "wrap": true,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "xmax{{msg.payload}}",
        "min": 0,
        "max": "3000",
        "step": "0.01",
        "className": "",
        "x": 490,
        "y": 1180,
        "wires": [
            [
                "effc4b19720ccea9"
            ]
        ]
    },
    {
        "id": "f840ee76882f8428",
        "type": "ui_numeric",
        "z": "3154c44d1a91de38",
        "name": "ymin",
        "label": "",
        "tooltip": "",
        "group": "112aa19380852c23",
        "order": 13,
        "width": 3,
        "height": 1,
        "wrap": true,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "ymin{{msg.payload}}",
        "min": 0,
        "max": "3000",
        "step": "0.01",
        "className": "",
        "x": 490,
        "y": 1200,
        "wires": [
            [
                "aa4ea636d07ed467"
            ]
        ]
    },
    {
        "id": "69a195c61a15f1ff",
        "type": "ui_numeric",
        "z": "3154c44d1a91de38",
        "name": "ymax",
        "label": "",
        "tooltip": "",
        "group": "112aa19380852c23",
        "order": 15,
        "width": 3,
        "height": 1,
        "wrap": true,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "ymax{{msg.payload}}",
        "min": 0,
        "max": "3000",
        "step": "0.01",
        "className": "",
        "x": 490,
        "y": 1220,
        "wires": [
            [
                "98fe73aa5a255e16"
            ]
        ]
    },
    {
        "id": "32539e809a4ab257",
        "type": "ui_numeric",
        "z": "3154c44d1a91de38",
        "name": "span",
        "label": "",
        "tooltip": "",
        "group": "112aa19380852c23",
        "order": 19,
        "width": 3,
        "height": 1,
        "wrap": true,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "span{{msg.payload}}",
        "min": 0,
        "max": "3000",
        "step": "0.0001",
        "className": "",
        "x": 490,
        "y": 1240,
        "wires": [
            [
                "9edae096c12a993e"
            ]
        ]
    },
    {
        "id": "f78df4f546d5323b",
        "type": "ui_numeric",
        "z": "3154c44d1a91de38",
        "name": "offset",
        "label": "",
        "tooltip": "",
        "group": "112aa19380852c23",
        "order": 21,
        "width": 3,
        "height": 1,
        "wrap": true,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "offset{{msg.payload}}",
        "min": 0,
        "max": "3000",
        "step": "0.0001",
        "className": "",
        "x": 490,
        "y": 1260,
        "wires": [
            [
                "6eba4c323a68d274"
            ]
        ]
    },
    {
        "id": "59e10ec9698b12e7",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "var selected_input = global.get('analoginput.selected_input')\nvar input = global.get('analoginput.input['+selected_input+']')\nmsg.input = input\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 295,
        "y": 1160,
        "wires": [
            [
                "eb5f0cccbdddec17",
                "40253492d076eefe",
                "473527177fd9918f",
                "4ec6890d736cceb7",
                "024a786b0d40ab92",
                "c9be4acf1148863b"
            ]
        ],
        "l": false
    },
    {
        "id": "eb5f0cccbdddec17",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "input.calibration.x.min",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 395,
        "y": 1160,
        "wires": [
            [
                "4aa0d55a58d20193"
            ]
        ],
        "l": false
    },
    {
        "id": "40253492d076eefe",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "input.calibration.x.max",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 395,
        "y": 1180,
        "wires": [
            [
                "e62882e76d5a3ed0"
            ]
        ],
        "l": false
    },
    {
        "id": "473527177fd9918f",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "input.calibration.y.min",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 395,
        "y": 1200,
        "wires": [
            [
                "f840ee76882f8428"
            ]
        ],
        "l": false
    },
    {
        "id": "4ec6890d736cceb7",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "input.calibration.y.max",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 395,
        "y": 1220,
        "wires": [
            [
                "69a195c61a15f1ff"
            ]
        ],
        "l": false
    },
    {
        "id": "024a786b0d40ab92",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "input.calibration.span",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 395,
        "y": 1240,
        "wires": [
            [
                "32539e809a4ab257"
            ]
        ],
        "l": false
    },
    {
        "id": "c9be4acf1148863b",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "input.calibration.offset",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 395,
        "y": 1260,
        "wires": [
            [
                "f78df4f546d5323b"
            ]
        ],
        "l": false
    },
    {
        "id": "b985d102fbee08b0",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "var selected_input = global.get('analoginput.selected_input')\nglobal.set('analoginput.input['+selected_input+'].calibration.x.min', msg.payload)\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 595,
        "y": 1160,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "effc4b19720ccea9",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "var selected_input = global.get('analoginput.selected_input')\nglobal.set('analoginput.input['+selected_input+'].calibration.x.max', msg.payload)\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 595,
        "y": 1180,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "aa4ea636d07ed467",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "var selected_input = global.get('analoginput.selected_input')\nglobal.set('analoginput.input['+selected_input+'].calibration.y.min', msg.payload)\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 595,
        "y": 1200,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "98fe73aa5a255e16",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "var selected_input = global.get('analoginput.selected_input')\nglobal.set('analoginput.input['+selected_input+'].calibration.y.max', msg.payload)\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 595,
        "y": 1220,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "9edae096c12a993e",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "var selected_input = global.get('analoginput.selected_input')\nglobal.set('analoginput.input['+selected_input+'].calibration.span', msg.payload)\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 595,
        "y": 1240,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "6eba4c323a68d274",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "var selected_input = global.get('analoginput.selected_input')\nglobal.set('analoginput.input['+selected_input+'].calibration.offset', msg.payload)\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 595,
        "y": 1260,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "193129d955d22371",
        "type": "trigger",
        "z": "3154c44d1a91de38",
        "name": "",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "-1",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 455,
        "y": 1060,
        "wires": [
            [
                "b537b846c99d5ba0"
            ]
        ],
        "l": false
    },
    {
        "id": "06678430389b644d",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 395,
        "y": 1080,
        "wires": [
            [
                "193129d955d22371"
            ]
        ],
        "l": false
    },
    {
        "id": "57fabf8420eb8b51",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "change",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "lost",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 275,
        "y": 1080,
        "wires": [
            [
                "877974758133d165"
            ],
            [
                "f6ef36916a7aab3d"
            ]
        ],
        "l": false
    },
    {
        "id": "877974758133d165",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "tab",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "5",
                "vt": "num"
            },
            {
                "t": "neq",
                "v": "5",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 335,
        "y": 1060,
        "wires": [
            [
                "193129d955d22371"
            ],
            []
        ],
        "l": false
    },
    {
        "id": "babdd556d27c32aa",
        "type": "trigger",
        "z": "3154c44d1a91de38",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "nul",
        "op2type": "str",
        "duration": "5",
        "extend": false,
        "overrideDelay": true,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 635,
        "y": 160,
        "wires": [
            [
                "d7036bba6f2040c6"
            ]
        ],
        "l": false
    },
    {
        "id": "1219bcc4367384ed",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 515,
        "y": 200,
        "wires": [
            [
                "babdd556d27c32aa"
            ]
        ],
        "l": false
    },
    {
        "id": "f484e601c7a47daa",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 465,
        "y": 180,
        "wires": [
            [
                "6404ddd0204a1536",
                "e2173a2b70e6db18"
            ],
            [
                "1219bcc4367384ed",
                "a8b1edd17a18f4ac"
            ]
        ],
        "l": false
    },
    {
        "id": "ee0291f3aba6669c",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "temp is bad",
        "func": "if (isNaN(msg.payload) || msg.payload == 32) {\n    //flow.set('upper_thermocouple_bad', true)\n    msg.payload = true\n    msg.delay = 10000\n} else {\n    //flow.set('upper_thermocouple_bad', false)\n    msg.payload = false\n    msg.delay = 5000\n}\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 405,
        "y": 180,
        "wires": [
            [
                "f484e601c7a47daa"
            ]
        ],
        "l": false
    },
    {
        "id": "d7036bba6f2040c6",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "upper_thermocouple_bad",
                "pt": "flow",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 695,
        "y": 160,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "be6db2014d2266f4",
        "type": "trigger",
        "z": "3154c44d1a91de38",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "nul",
        "op2type": "str",
        "duration": "5",
        "extend": false,
        "overrideDelay": true,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 635,
        "y": 200,
        "wires": [
            [
                "1baf34e0f140c835"
            ]
        ],
        "l": false
    },
    {
        "id": "6404ddd0204a1536",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 515,
        "y": 160,
        "wires": [
            [
                "be6db2014d2266f4"
            ]
        ],
        "l": false
    },
    {
        "id": "1baf34e0f140c835",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "upper_thermocouple_bad",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 695,
        "y": 200,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "e2173a2b70e6db18",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "upper_thermocouple_bad",
        "propertyType": "flow",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 575,
        "y": 160,
        "wires": [
            [
                "babdd556d27c32aa"
            ]
        ],
        "l": false
    },
    {
        "id": "a8b1edd17a18f4ac",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "upper_thermocouple_bad",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 575,
        "y": 200,
        "wires": [
            [
                "be6db2014d2266f4"
            ]
        ],
        "l": false
    },
    {
        "id": "e4959970166cb7b8",
        "type": "trigger",
        "z": "3154c44d1a91de38",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "nul",
        "op2type": "str",
        "duration": "5",
        "extend": false,
        "overrideDelay": true,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 635,
        "y": 520,
        "wires": [
            [
                "7da29b2e3863d1aa"
            ]
        ],
        "l": false
    },
    {
        "id": "4c8ebe9638c55c70",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 515,
        "y": 560,
        "wires": [
            [
                "e4959970166cb7b8"
            ]
        ],
        "l": false
    },
    {
        "id": "dc3a71b261563fe2",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 465,
        "y": 540,
        "wires": [
            [
                "dae562d71b9ae21c",
                "d043340fbb846d3b"
            ],
            [
                "4c8ebe9638c55c70",
                "8c3dd26e3857506d"
            ]
        ],
        "l": false
    },
    {
        "id": "b439be6284f42bd5",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "temp is bad",
        "func": "if (isNaN(msg.payload) || msg.payload == 32) {\n    //flow.set('upper_thermocouple_bad', true)\n    msg.payload = true\n    msg.delay = 10000\n} else {\n    //flow.set('upper_thermocouple_bad', false)\n    msg.payload = false\n    msg.delay = 5000\n}\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 405,
        "y": 540,
        "wires": [
            [
                "dc3a71b261563fe2"
            ]
        ],
        "l": false
    },
    {
        "id": "7da29b2e3863d1aa",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "lower_thermocouple_bad",
                "pt": "flow",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 695,
        "y": 520,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "ae394a8879fd0b69",
        "type": "trigger",
        "z": "3154c44d1a91de38",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "nul",
        "op2type": "str",
        "duration": "5",
        "extend": false,
        "overrideDelay": true,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 635,
        "y": 560,
        "wires": [
            [
                "4bd08057d4fc464e"
            ]
        ],
        "l": false
    },
    {
        "id": "dae562d71b9ae21c",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 515,
        "y": 520,
        "wires": [
            [
                "ae394a8879fd0b69"
            ]
        ],
        "l": false
    },
    {
        "id": "4bd08057d4fc464e",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "lower_thermocouple_bad",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 695,
        "y": 560,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "d043340fbb846d3b",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "lower_thermocouple_bad",
        "propertyType": "flow",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 575,
        "y": 520,
        "wires": [
            [
                "e4959970166cb7b8"
            ]
        ],
        "l": false
    },
    {
        "id": "8c3dd26e3857506d",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "lower_thermocouple_bad",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 575,
        "y": 560,
        "wires": [
            [
                "ae394a8879fd0b69"
            ]
        ],
        "l": false
    },
    {
        "id": "badbd5684182eea0",
        "type": "comment",
        "z": "3154c44d1a91de38",
        "name": "monitor thermocouple failure",
        "info": "this section of nodes will start a timer when \nthe thermocouple returned data is either\n32 or NaN.\n\nafter the timer has expired the thermocouple\nwill be considered faulty.\n\nwhen the thermocouple begins transmitting \nvalues other than 32 or NaN again another\ntimer will start.\n\nonce this timer expires then the thermocouple\nwill be considered ok again.",
        "x": 580,
        "y": 180,
        "wires": []
    },
    {
        "id": "3aa120f2e22a021e",
        "type": "comment",
        "z": "3154c44d1a91de38",
        "name": "monitor thermocouple failure",
        "info": "this section of nodes will start a timer when \nthe thermocouple returned data is either\n32 or NaN.\n\nafter the timer has expired the thermocouple\nwill be considered faulty.\n\nwhen the thermocouple begins transmitting \nvalues other than 32 or NaN again another\ntimer will start.\n\nonce this timer expires then the thermocouple\nwill be considered ok again.",
        "x": 580,
        "y": 540,
        "wires": []
    },
    {
        "id": "60ed4618490b6af6",
        "type": "comment",
        "z": "3154c44d1a91de38",
        "name": "data collection",
        "info": "",
        "x": 720,
        "y": 360,
        "wires": []
    },
    {
        "id": "cfb3bf9c5adf407a",
        "type": "comment",
        "z": "3154c44d1a91de38",
        "name": "smooth and scale",
        "info": "",
        "x": 110,
        "y": 460,
        "wires": []
    },
    {
        "id": "6005d5278907e1eb",
        "type": "comment",
        "z": "3154c44d1a91de38",
        "name": "smooth and scale",
        "info": "",
        "x": 110,
        "y": 260,
        "wires": []
    },
    {
        "id": "0b65910feb0dca3b",
        "type": "comment",
        "z": "3154c44d1a91de38",
        "name": "utility dashboard",
        "info": "",
        "x": 100,
        "y": 880,
        "wires": []
    },
    {
        "id": "480f5fe1d4ea8460",
        "type": "comment",
        "z": "3154c44d1a91de38",
        "name": "detect when connect to dashboard tab",
        "info": "",
        "x": 390,
        "y": 1020,
        "wires": []
    },
    {
        "id": "5807025409385d2f",
        "type": "ui_button",
        "z": "3154c44d1a91de38",
        "name": "",
        "group": "112aa19380852c23",
        "order": 24,
        "width": 7,
        "height": 1,
        "passthru": false,
        "label": "Calculate",
        "tooltip": "",
        "color": "",
        "bgcolor": "orange",
        "className": "",
        "icon": "warning",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 480,
        "y": 1340,
        "wires": [
            [
                "39644811da3119d6"
            ]
        ]
    },
    {
        "id": "39644811da3119d6",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "var selected_input = global.get('analoginput.selected_input')\nvar input = global.get('analoginput.input['+selected_input+']')\n\ntry {\n    // m = y2*y1/x2*x1\n    input.calibration.span = (input.calibration.y.max - input.calibration.y.min) / (input.calibration.x.max - input.calibration.x.min)\n\n    // b = y-mx\n    input.calibration.offset = input.calibration.y.max - input.calibration.span * input.calibration.x.max\n\n} catch (error) {\n    node.warn(error)\n};\n\nglobal.set('analoginput.input[' + selected_input + ']', input)\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 575,
        "y": 1340,
        "wires": [
            [
                "60667a7d4305efa8"
            ]
        ],
        "l": false
    },
    {
        "id": "60667a7d4305efa8",
        "type": "link out",
        "z": "3154c44d1a91de38",
        "name": "",
        "mode": "link",
        "links": [
            "cfd69a7faaed9708"
        ],
        "x": 635,
        "y": 1340,
        "wires": []
    },
    {
        "id": "cfd69a7faaed9708",
        "type": "link in",
        "z": "3154c44d1a91de38",
        "name": "",
        "links": [
            "60667a7d4305efa8",
            "23106acb85b27ca6"
        ],
        "x": 215,
        "y": 1200,
        "wires": [
            [
                "59e10ec9698b12e7"
            ]
        ]
    },
    {
        "id": "23106acb85b27ca6",
        "type": "link out",
        "z": "3154c44d1a91de38",
        "name": "",
        "mode": "link",
        "links": [
            "cfd69a7faaed9708"
        ],
        "x": 575,
        "y": 960,
        "wires": []
    },
    {
        "id": "ba082e8df156fb74",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "//msg.payload = parseFloat(msg.input.scaled.toFixed(2))\nmsg.payload = msg.input.scaled.toFixed(4)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 615,
        "y": 1100,
        "wires": [
            [
                "9d1d6fc5b853b597"
            ]
        ],
        "l": false
    },
    {
        "id": "6934e6c8ca5ac2db",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "tab",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "5",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 155,
        "y": 1160,
        "wires": [
            [
                "22af8d6fdc6cd5a3"
            ]
        ],
        "l": false
    },
    {
        "id": "22af8d6fdc6cd5a3",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "lost",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "connect",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "change",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 215,
        "y": 1160,
        "wires": [
            [],
            [
                "59e10ec9698b12e7"
            ],
            [
                "59e10ec9698b12e7"
            ]
        ],
        "l": false
    },
    {
        "id": "c5671e6fa247bedc",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "tab",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "5",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 155,
        "y": 940,
        "wires": [
            [
                "b5f1d5271f421130"
            ]
        ],
        "l": false
    },
    {
        "id": "b5f1d5271f421130",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "lost",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "connect",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "change",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 215,
        "y": 940,
        "wires": [
            [],
            [
                "477ed7158a34c5bf",
                "d9fcdb3e4f6fe46a"
            ],
            [
                "d9fcdb3e4f6fe46a",
                "477ed7158a34c5bf"
            ]
        ],
        "l": false
    },
    {
        "id": "c0707caf85c10e83",
        "type": "link in",
        "z": "3154c44d1a91de38",
        "name": "dashboard events",
        "links": [
            "0d7362ca2edd72c6"
        ],
        "x": 110,
        "y": 1060,
        "wires": [
            [
                "6934e6c8ca5ac2db",
                "57fabf8420eb8b51",
                "c5671e6fa247bedc"
            ]
        ],
        "l": true
    },
    {
        "id": "f6ef36916a7aab3d",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "client count 0",
        "property": "client_count",
        "propertyType": "msg",
        "rules": [
            {
                "t": "lte",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 335,
        "y": 1100,
        "wires": [
            [
                "06678430389b644d"
            ]
        ],
        "l": false
    },
    {
        "id": "a7a9eeb897d0ea64",
        "type": "link in",
        "z": "3154c44d1a91de38",
        "name": "Timer 1",
        "links": [
            "62eccecdbb37e6f8"
        ],
        "x": 75,
        "y": 360,
        "wires": [
            [
                "f45e246dbf521446"
            ]
        ],
        "icon": "node-red/timer.svg"
    },
    {
        "id": "faad1abb6ddb40e6",
        "type": "link in",
        "z": "3154c44d1a91de38",
        "name": "Oneshot Inject at Startup",
        "links": [
            "7fa2d20f4131fc60"
        ],
        "x": 335,
        "y": 20,
        "wires": [
            [
                "11d1503b33735b7a"
            ]
        ],
        "icon": "node-red/timer.svg"
    },
    {
        "id": "d82dade01e8d0ee6",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "kiln_01.SimulateTemperature",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 345,
        "y": 340,
        "wires": [
            [
                "95dfe0dda7683c18"
            ]
        ],
        "l": false
    },
    {
        "id": "95dfe0dda7683c18",
        "type": "kettle-sim",
        "z": "3154c44d1a91de38",
        "name": "",
        "diam": 35,
        "volume": 40,
        "temp": "20",
        "power": "10",
        "ambientTemp": 20,
        "x": 405,
        "y": 340,
        "wires": [
            [
                "0e07f59ed1058b14"
            ]
        ],
        "l": false
    },
    {
        "id": "e4f78a9a9ff9d4e2",
        "type": "kettle-sim",
        "z": "3154c44d1a91de38",
        "name": "",
        "diam": 35,
        "volume": 40,
        "temp": "20",
        "power": "10",
        "ambientTemp": 20,
        "x": 405,
        "y": 380,
        "wires": [
            [
                "4fe3e275d255b3e7"
            ]
        ],
        "l": false
    },
    {
        "id": "0e07f59ed1058b14",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "msg.payload = parseFloat(msg.payload.toFixed(2))\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 465,
        "y": 340,
        "wires": [
            [
                "aec3c2c38a63dd10",
                "dcbc073ea7b777ee",
                "bd45525a6924a5c5"
            ]
        ],
        "l": false
    },
    {
        "id": "4fe3e275d255b3e7",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "msg.payload = parseFloat(msg.payload.toFixed(2))\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 465,
        "y": 380,
        "wires": [
            [
                "6c490df17d1de881",
                "e65201e766b76bfd",
                "6ab284ac808bee4a"
            ]
        ],
        "l": false
    },
    {
        "id": "bb7dea3f1a0bf84c",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "kiln_01.SimulateTemperature",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 345,
        "y": 380,
        "wires": [
            [
                "e4f78a9a9ff9d4e2"
            ]
        ],
        "l": false
    },
    {
        "id": "9e92d7c40ff4483a",
        "type": "comment",
        "z": "3154c44d1a91de38",
        "name": "handle simulate temps",
        "info": "",
        "x": 420,
        "y": 360,
        "wires": []
    },
    {
        "id": "36c3f72d59bfed4f",
        "type": "link in",
        "z": "3154c44d1a91de38",
        "name": "",
        "links": [
            "6631d9fb2726ad04",
            "c25d091e1fa28879",
            "521b312bd5cbf03e"
        ],
        "x": 285,
        "y": 380,
        "wires": [
            [
                "bb7dea3f1a0bf84c"
            ]
        ]
    },
    {
        "id": "174a695dc7533b2c",
        "type": "link in",
        "z": "3154c44d1a91de38",
        "name": "",
        "links": [
            "9e015528e0fb2d1b",
            "b7e5087d46e58c68",
            "2f886e4da63e4cde",
            "32e3becf505d02e8"
        ],
        "x": 285,
        "y": 340,
        "wires": [
            [
                "d82dade01e8d0ee6"
            ]
        ]
    },
    {
        "id": "0174d9742bec95c7",
        "type": "debug",
        "z": "3154c44d1a91de38",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 595,
        "y": 20,
        "wires": [],
        "l": false
    },
    {
        "id": "19c89045bda88732",
        "type": "debug",
        "z": "3154c44d1a91de38",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 455,
        "y": 640,
        "wires": [],
        "l": false
    },
    {
        "id": "bc8323ef9436386d",
        "type": "debug",
        "z": "3154c44d1a91de38",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 455,
        "y": 740,
        "wires": [],
        "l": false
    },
    {
        "id": "01fee8c005244e85",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "//msg.payload = parseFloat(msg.input.scaled.toFixed(2))\nmsg.payload = msg.input.raw.toFixed(4)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 615,
        "y": 1060,
        "wires": [
            [
                "dd5fa1a2a7edec40"
            ]
        ],
        "l": false
    },
    {
        "id": "138195432c3badec",
        "type": "smooth",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "payload",
        "action": "low",
        "count": "50",
        "round": "",
        "mult": "single",
        "reduce": false,
        "x": 525,
        "y": 260,
        "wires": [
            [
                "aec3c2c38a63dd10",
                "dcbc073ea7b777ee",
                "bd45525a6924a5c5"
            ]
        ],
        "l": false
    },
    {
        "id": "465fe5024865b9db",
        "type": "smooth",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "payload",
        "action": "low",
        "count": "50",
        "round": "",
        "mult": "single",
        "reduce": false,
        "x": 525,
        "y": 460,
        "wires": [
            [
                "6c490df17d1de881",
                "e65201e766b76bfd",
                "6ab284ac808bee4a"
            ]
        ],
        "l": false
    },
    {
        "id": "3e2dce38cedf347d",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "initialize variables",
        "func": "var output = []\nvar outputcount = 2\nfor (let index = 0; index < outputcount; index++) {\n    output.push({ id: '', duty_cycle: 0 })\n}\nvar digitaloutput = { selected_output: 0, output }\nglobal.set('digitaloutput', digitaloutput)\nmsg.payload = { digitaloutput }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 535,
        "y": 40,
        "wires": [
            [
                "0174d9742bec95c7"
            ]
        ],
        "l": false
    },
    {
        "id": "8bf694674abe662a",
        "type": "inject",
        "z": "3154c44d1a91de38",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 475,
        "y": 40,
        "wires": [
            [
                "3e2dce38cedf347d"
            ]
        ],
        "l": false
    },
    {
        "id": "82caf18907cb8198",
        "type": "link in",
        "z": "3154c44d1a91de38",
        "name": "Timer 1",
        "links": [
            "62eccecdbb37e6f8"
        ],
        "x": 135,
        "y": 680,
        "wires": [
            []
        ],
        "icon": "node-red/timer.svg"
    },
    {
        "id": "01f8509ce68a75b8",
        "type": "link in",
        "z": "3154c44d1a91de38",
        "name": "Timer 1",
        "links": [
            "62eccecdbb37e6f8"
        ],
        "x": 135,
        "y": 780,
        "wires": [
            []
        ],
        "icon": "node-red/timer.svg"
    },
    {
        "id": "100246e8654fe664",
        "type": "inject",
        "z": "3154c44d1a91de38",
        "name": "dedicated 1 second timer",
        "props": [],
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 160,
        "y": 720,
        "wires": [
            [
                "d4cb1a52a4fe0d75",
                "5bb8a83cadcb2ba3"
            ]
        ]
    },
    {
        "id": "1c9e79b136a623e2",
        "type": "catch",
        "z": "98e4246c87add39e",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 60,
        "y": 20,
        "wires": [
            [
                "d3aa01638e9fef28"
            ]
        ]
    },
    {
        "id": "d3aa01638e9fef28",
        "type": "debug",
        "z": "98e4246c87add39e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 155,
        "y": 20,
        "wires": [],
        "l": false
    },
    {
        "id": "0f5d38dea1f9fdf8",
        "type": "inject",
        "z": "98e4246c87add39e",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 85,
        "y": 160,
        "wires": [
            [
                "f14af351da1b05c1"
            ]
        ],
        "l": false
    },
    {
        "id": "f14af351da1b05c1",
        "type": "exec",
        "z": "98e4246c87add39e",
        "command": "node-red-restart",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 270,
        "y": 160,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "680c5276908a542b",
        "type": "inject",
        "z": "98e4246c87add39e",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 85,
        "y": 200,
        "wires": [
            [
                "3b38d7ad7142ae99"
            ]
        ],
        "l": false
    },
    {
        "id": "3b38d7ad7142ae99",
        "type": "exec",
        "z": "98e4246c87add39e",
        "command": "sudo shutdown now",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 290,
        "y": 200,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "300160ca9486c7ff",
        "type": "inject",
        "z": "98e4246c87add39e",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 85,
        "y": 240,
        "wires": [
            [
                "5bb9693f827a8916"
            ]
        ],
        "l": false
    },
    {
        "id": "5bb9693f827a8916",
        "type": "exec",
        "z": "98e4246c87add39e",
        "command": "sudo reboot now",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 280,
        "y": 240,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "5e1d74212376e4f3",
        "type": "exec",
        "z": "98e4246c87add39e",
        "command": "hostname",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 250,
        "y": 280,
        "wires": [
            [
                "f619121c08077343"
            ],
            [],
            []
        ]
    },
    {
        "id": "f619121c08077343",
        "type": "change",
        "z": "98e4246c87add39e",
        "name": "set hostname",
        "rules": [
            {
                "t": "set",
                "p": "hostname",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "f9460b8af28fe098",
        "type": "comment",
        "z": "98e4246c87add39e",
        "name": "system commands",
        "info": "",
        "x": 110,
        "y": 100,
        "wires": []
    },
    {
        "id": "f5033733f707ca3b",
        "type": "ui_button",
        "z": "98e4246c87add39e",
        "name": "",
        "group": "5331d4d4d2257e9c",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Restart Node-RED",
        "tooltip": "",
        "color": "",
        "bgcolor": "orange",
        "className": "",
        "icon": "warning",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 145,
        "y": 160,
        "wires": [
            [
                "f14af351da1b05c1"
            ]
        ],
        "l": false
    },
    {
        "id": "a642f1f2e5e98baf",
        "type": "ui_button",
        "z": "98e4246c87add39e",
        "name": "",
        "group": "5331d4d4d2257e9c",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Reboot OpenKiln",
        "tooltip": "",
        "color": "",
        "bgcolor": "orange",
        "className": "",
        "icon": "warning",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 145,
        "y": 240,
        "wires": [
            [
                "5bb9693f827a8916"
            ]
        ],
        "l": false
    },
    {
        "id": "b22998e6d78aeec1",
        "type": "inject",
        "z": "98e4246c87add39e",
        "name": "Oneshot Timer at Startup",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "x": 190,
        "y": 500,
        "wires": [
            [
                "7fa2d20f4131fc60"
            ]
        ]
    },
    {
        "id": "99697af708a701c0",
        "type": "inject",
        "z": "98e4246c87add39e",
        "name": "Timer 1",
        "props": [],
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 240,
        "y": 520,
        "wires": [
            [
                "62eccecdbb37e6f8"
            ]
        ]
    },
    {
        "id": "88f077fb53d14a6b",
        "type": "inject",
        "z": "98e4246c87add39e",
        "name": "Timer 2",
        "props": [],
        "repeat": "5",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 240,
        "y": 540,
        "wires": [
            [
                "024e0212ac6e8812"
            ]
        ]
    },
    {
        "id": "7fa2d20f4131fc60",
        "type": "link out",
        "z": "98e4246c87add39e",
        "name": "Oneshot Inject at Startup",
        "mode": "link",
        "links": [
            "1fcd1d351b927c92",
            "67fd6dcf0c009872",
            "3a10314de81e4ea3",
            "b5bc3f51e5bd08f9",
            "b7093a504612f6ed",
            "8025efa4ec2e5944",
            "0f779fd67e9e72b8",
            "faad1abb6ddb40e6",
            "229639664257214b"
        ],
        "x": 375,
        "y": 500,
        "wires": []
    },
    {
        "id": "62eccecdbb37e6f8",
        "type": "link out",
        "z": "98e4246c87add39e",
        "name": "Timer 1",
        "mode": "link",
        "links": [
            "926b0d1549693d67",
            "98c5268e979c7dcb",
            "83d1eeca2821fcac",
            "c271444bdafb92be",
            "a7a9eeb897d0ea64",
            "c47ff922f0cbee22",
            "3a7f735dd215d856",
            "3043fcde283df23d",
            "5d841c9bdcfb313f",
            "a84605821808c573",
            "82caf18907cb8198",
            "01f8509ce68a75b8"
        ],
        "x": 375,
        "y": 520,
        "wires": []
    },
    {
        "id": "024e0212ac6e8812",
        "type": "link out",
        "z": "98e4246c87add39e",
        "name": "Timer 2",
        "mode": "link",
        "links": [
            "5cb7a543f0243acf",
            "7e2fa6ed953dcc19"
        ],
        "x": 375,
        "y": 540,
        "wires": []
    },
    {
        "id": "8e7b143f03fe4151",
        "type": "inject",
        "z": "98e4246c87add39e",
        "name": "Timer 3",
        "props": [],
        "repeat": "10",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 240,
        "y": 560,
        "wires": [
            [
                "0023bda6c99b9785"
            ]
        ]
    },
    {
        "id": "0023bda6c99b9785",
        "type": "link out",
        "z": "98e4246c87add39e",
        "name": "Timer 3",
        "mode": "link",
        "links": [],
        "x": 375,
        "y": 560,
        "wires": []
    },
    {
        "id": "229639664257214b",
        "type": "link in",
        "z": "98e4246c87add39e",
        "name": "",
        "links": [
            "7fa2d20f4131fc60"
        ],
        "x": 145,
        "y": 280,
        "wires": [
            [
                "5e1d74212376e4f3"
            ]
        ]
    },
    {
        "id": "af4553bb581c655e",
        "type": "exec",
        "z": "98e4246c87add39e",
        "command": "echo \"get battery\" | nc -q 0 127.0.0.1 8423",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 360,
        "y": 320,
        "wires": [
            [
                "6f5afb9a88e70a05"
            ],
            [],
            []
        ]
    },
    {
        "id": "d38d9c73aca28d87",
        "type": "inject",
        "z": "98e4246c87add39e",
        "name": "Timer 4",
        "props": [],
        "repeat": "60",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 240,
        "y": 580,
        "wires": [
            [
                "baf5017e8f62ab32"
            ]
        ]
    },
    {
        "id": "baf5017e8f62ab32",
        "type": "link out",
        "z": "98e4246c87add39e",
        "name": "Timer 3",
        "mode": "link",
        "links": [
            "70a6135b55b68537"
        ],
        "x": 375,
        "y": 580,
        "wires": []
    },
    {
        "id": "70a6135b55b68537",
        "type": "link in",
        "z": "98e4246c87add39e",
        "name": "",
        "links": [
            "baf5017e8f62ab32"
        ],
        "x": 145,
        "y": 320,
        "wires": [
            [
                "af4553bb581c655e"
            ]
        ]
    },
    {
        "id": "6f5afb9a88e70a05",
        "type": "function",
        "z": "98e4246c87add39e",
        "name": "",
        "func": "var stringlist = msg.payload.split(\":\")\nvar Battery = stringlist[1]\nvar msg_influx = {measurement: 'Battery', payload: parseFloat(parseFloat(Battery).toFixed(2))}\nreturn msg_influx;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 585,
        "y": 320,
        "wires": [
            [
                "75379ff884a7a0ec"
            ]
        ],
        "l": false
    },
    {
        "id": "75379ff884a7a0ec",
        "type": "influxdb out",
        "z": "98e4246c87add39e",
        "influxdb": "1a7d214ba0ada216",
        "name": "",
        "measurement": "",
        "precision": "",
        "retentionPolicy": "",
        "database": "database",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "",
        "org": "organisation",
        "bucket": "bucket",
        "x": 645,
        "y": 320,
        "wires": [],
        "l": false
    },
    {
        "id": "696ae3ae2eebb551",
        "type": "comment",
        "z": "98e4246c87add39e",
        "name": "timers",
        "info": "",
        "x": 80,
        "y": 460,
        "wires": []
    },
    {
        "id": "0ff7e04c8ee2db0a",
        "type": "ui_ui_control",
        "z": "98e4246c87add39e",
        "name": "",
        "events": "all",
        "x": 540,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "3d9aac9a08adde21",
        "type": "ui_button",
        "z": "98e4246c87add39e",
        "name": "",
        "group": "353b1d92547b4d5b",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Show System",
        "tooltip": "",
        "color": "",
        "bgcolor": "orange",
        "className": "",
        "icon": "warning",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 355,
        "y": 720,
        "wires": [
            [
                "a9f1cbb6fb0bccc8"
            ]
        ],
        "l": false
    },
    {
        "id": "a9f1cbb6fb0bccc8",
        "type": "change",
        "z": "98e4246c87add39e",
        "name": "show",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"group\":{\"hide\":[\"Utility_Enable_System\"],\"show\":[\"Utility_System\"],\"focus\":true}}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 415,
        "y": 720,
        "wires": [
            [
                "0ff7e04c8ee2db0a"
            ]
        ],
        "l": false
    },
    {
        "id": "416636774a322b91",
        "type": "change",
        "z": "98e4246c87add39e",
        "name": "hide",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"group\":{\"hide\":[\"Utility_System\"],\"show\":[\"Utility_Enable_System\"],\"focus\":false}}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 415,
        "y": 760,
        "wires": [
            [
                "0ff7e04c8ee2db0a"
            ]
        ],
        "l": false
    },
    {
        "id": "41f5fb056a65a202",
        "type": "switch",
        "z": "98e4246c87add39e",
        "name": "",
        "property": "tab",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "5",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 295,
        "y": 760,
        "wires": [
            [
                "b71eb5ffe356396d"
            ]
        ],
        "l": false
    },
    {
        "id": "b71eb5ffe356396d",
        "type": "switch",
        "z": "98e4246c87add39e",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "lost",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "connect",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "change",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 355,
        "y": 760,
        "wires": [
            [],
            [
                "416636774a322b91"
            ],
            [
                "416636774a322b91"
            ]
        ],
        "l": false
    },
    {
        "id": "47cdbbef8944aef2",
        "type": "link in",
        "z": "98e4246c87add39e",
        "name": "dashboard events",
        "links": [
            "0d7362ca2edd72c6"
        ],
        "x": 170,
        "y": 760,
        "wires": [
            [
                "41f5fb056a65a202"
            ]
        ],
        "l": true
    }
]