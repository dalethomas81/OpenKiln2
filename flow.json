[
    {
        "id": "592b686edd11b813",
        "type": "tab",
        "label": "Dashboard",
        "disabled": false,
        "info": ""
    },
    {
        "id": "e9cef8706a9cf7f6",
        "type": "tab",
        "label": "Logic",
        "disabled": false,
        "info": ""
    },
    {
        "id": "b83fb43068cdf48f",
        "type": "tab",
        "label": "pid",
        "disabled": false,
        "info": ""
    },
    {
        "id": "3154c44d1a91de38",
        "type": "tab",
        "label": "I/O",
        "disabled": false,
        "info": ""
    },
    {
        "id": "98e4246c87add39e",
        "type": "tab",
        "label": "Utility",
        "disabled": false,
        "info": ""
    },
    {
        "id": "8775e5df1b6887a4",
        "type": "ui_tab",
        "d": true,
        "name": "Historical",
        "icon": "timeline",
        "order": 4,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "443a1fa760cb1696",
        "type": "ui_base",
        "theme": {
            "name": "theme-dark",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#097479",
                    "value": "#097479",
                    "edited": true
                },
                "page-titlebar-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#111111",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#0eb8c0",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#555555",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#eeeeee",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#333333",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "OpenKiln Dashboard",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "MMM-DD-YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "b96e65c991e4f663",
        "type": "ui_group",
        "name": "Historical Data",
        "tab": "8775e5df1b6887a4",
        "order": 1,
        "disp": true,
        "width": "20",
        "collapse": false
    },
    {
        "id": "1a7d214ba0ada216",
        "type": "influxdb",
        "hostname": "127.0.0.1",
        "port": "8086",
        "protocol": "http",
        "database": "home",
        "name": "",
        "usetls": false,
        "tls": "",
        "influxdbVersion": "1.x",
        "url": "http://localhost:8086",
        "rejectUnauthorized": true
    },
    {
        "id": "afede006ffb47acb",
        "type": "ui_link",
        "name": "Node-Red Editor",
        "link": "NodeRed",
        "icon": "developer_dashboard",
        "target": "iframe",
        "order": 6
    },
    {
        "id": "1f041bb493bd73c1",
        "type": "ui_tab",
        "name": "Schedule",
        "icon": "mode_edit",
        "order": 3,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "723f1e0d521d5671",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 3,
        "width": 1,
        "height": 1
    },
    {
        "id": "57fb49920731c540",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "b27a47450c3d7a3c",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 1,
        "width": 1,
        "height": 1
    },
    {
        "id": "739befb0e899ed56",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "32c790dff519b120",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "a046a28b2ea5f0be",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "af4a79934426a42a",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "2dc617e815eb563a",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "c3291b77297c1a32",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "62c47bf35fc1331e",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "ddf52b8312f3dcfe",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "ccb56bf9e6cc2677",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "6ea6176457413f77",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "8e2e9fc7c1febf99",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "f6d092fb3bd13b06",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "50a6ad9370071ac2",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "0ed7068150cfb65f",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "2595b0b597065044",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "916cddc083aed4b1",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "388c16a271ef1c2d",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "a766471096c0346a",
        "type": "ui_spacer",
        "z": "592b686edd11b813",
        "name": "spacer",
        "group": "",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "5e1bdbab1ef4cbe6",
        "type": "ui_group",
        "name": "Schedule",
        "tab": "1f041bb493bd73c1",
        "order": 1,
        "disp": true,
        "width": 9,
        "collapse": false
    },
    {
        "id": "abf790e2f9501fc7",
        "type": "ui_group",
        "name": "Segments",
        "tab": "1f041bb493bd73c1",
        "order": 2,
        "disp": true,
        "width": "15",
        "collapse": false
    },
    {
        "id": "90879df8d2ee4c5d",
        "type": "ui_group",
        "name": "Control",
        "tab": "6e4426eb24a8676f",
        "order": 2,
        "disp": true,
        "width": "7",
        "collapse": false
    },
    {
        "id": "2201d496820b415d",
        "type": "ui_group",
        "name": "Status",
        "tab": "6e4426eb24a8676f",
        "order": 1,
        "disp": true,
        "width": "7",
        "collapse": false
    },
    {
        "id": "d86c6f681ae35c78",
        "type": "ui_link",
        "name": "PiSugar",
        "link": "PiSugar",
        "icon": "battery_charging_full",
        "target": "iframe",
        "order": 7
    },
    {
        "id": "450b79efd321b8c4",
        "type": "ui_link",
        "name": "Grafana",
        "link": "Grafana",
        "icon": "timeline",
        "target": "iframe",
        "order": 5
    },
    {
        "id": "de5db1c89316833e",
        "type": "ui_tab",
        "name": "Utility",
        "icon": "build",
        "order": 8,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "112aa19380852c23",
        "type": "ui_group",
        "name": "Settings",
        "tab": "de5db1c89316833e",
        "order": 4,
        "disp": true,
        "width": 12,
        "collapse": false
    },
    {
        "id": "f86f065176941099",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 7,
        "width": 1,
        "height": 1
    },
    {
        "id": "7a35b0f792e9846a",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 10,
        "width": 1,
        "height": 1
    },
    {
        "id": "f68e02645d7738c1",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 1,
        "width": 1,
        "height": 1
    },
    {
        "id": "b3be2f849e8ab7b8",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 3,
        "width": 2,
        "height": 1
    },
    {
        "id": "37407a3c1ee7bb79",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 5,
        "width": 1,
        "height": 1
    },
    {
        "id": "4cfc717b29133d4a",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "c7c99b97c361a432",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 8,
        "width": 2,
        "height": 1
    },
    {
        "id": "9e570445ee458c7e",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 10,
        "width": 1,
        "height": 1
    },
    {
        "id": "ad31e06a0c424f07",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 11,
        "width": 1,
        "height": 1
    },
    {
        "id": "e2919be3bfd4465c",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 13,
        "width": 2,
        "height": 1
    },
    {
        "id": "3bbf9d04d13b2787",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 15,
        "width": 1,
        "height": 1
    },
    {
        "id": "49c26116852ae508",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 16,
        "width": 2,
        "height": 1
    },
    {
        "id": "baaca26601c1e496",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "",
        "order": 18,
        "width": 2,
        "height": 1
    },
    {
        "id": "6e4426eb24a8676f",
        "type": "ui_tab",
        "name": "Main",
        "icon": "whatshot",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "02cafb3276498790",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "",
        "order": 3,
        "width": 1,
        "height": 1
    },
    {
        "id": "efcd4096ea60e7d9",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "",
        "order": 8,
        "width": 1,
        "height": 1
    },
    {
        "id": "60a8bcb74a3c379f",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "",
        "order": 10,
        "width": 1,
        "height": 1
    },
    {
        "id": "867133fef42b3b35",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "",
        "order": 11,
        "width": 1,
        "height": 1
    },
    {
        "id": "89e70d732b86427b",
        "type": "ui_spacer",
        "z": "b83fb43068cdf48f",
        "name": "spacer",
        "group": "",
        "order": 13,
        "width": 1,
        "height": 1
    },
    {
        "id": "a91f3f1520863187",
        "type": "ui_group",
        "name": "PID Auto Tuning",
        "tab": "de5db1c89316833e",
        "order": 1,
        "disp": true,
        "width": 12,
        "collapse": false
    },
    {
        "id": "92429f8f445aacdf",
        "type": "ui_group",
        "name": "PID Settings",
        "tab": "de5db1c89316833e",
        "order": 3,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "54f5b9405598d975",
        "type": "ui_group",
        "name": "Process",
        "tab": "de5db1c89316833e",
        "order": 2,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "49fcda6d9133abc2",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 1,
        "width": 1,
        "height": 1
    },
    {
        "id": "efc449170141f9a4",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 3,
        "width": 1,
        "height": 1
    },
    {
        "id": "eeb08ad3642e0f1b",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "d4e3c52da64379f9",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "f39f94b921a42ce7",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 7,
        "width": 4,
        "height": 1
    },
    {
        "id": "c08a221c4e872992",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 9,
        "width": 4,
        "height": 1
    },
    {
        "id": "d4874b276043bfa3",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 10,
        "width": 1,
        "height": 1
    },
    {
        "id": "29756c3f743b8ae0",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 12,
        "width": 2,
        "height": 1
    },
    {
        "id": "2457fa3a4dfd227e",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "a91f3f1520863187",
        "order": 14,
        "width": 1,
        "height": 1
    },
    {
        "id": "6224a8707f3b389f",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "54f5b9405598d975",
        "order": 1,
        "width": 1,
        "height": 1
    },
    {
        "id": "a9bb5f1769377627",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "54f5b9405598d975",
        "order": 3,
        "width": 1,
        "height": 1
    },
    {
        "id": "918070598fed21e3",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "92429f8f445aacdf",
        "order": 1,
        "width": 1,
        "height": 1
    },
    {
        "id": "43e32e6a5cb7ee79",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "92429f8f445aacdf",
        "order": 3,
        "width": 2,
        "height": 1
    },
    {
        "id": "b9c36ea2180aa683",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "92429f8f445aacdf",
        "order": 5,
        "width": 1,
        "height": 1
    },
    {
        "id": "83fa173e373aa4c4",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "92429f8f445aacdf",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "58b3e302d5c3d8cb",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "92429f8f445aacdf",
        "order": 8,
        "width": 2,
        "height": 1
    },
    {
        "id": "68a1fefd47212535",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "92429f8f445aacdf",
        "order": 10,
        "width": 1,
        "height": 1
    },
    {
        "id": "91e3fed30b5d7847",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "92429f8f445aacdf",
        "order": 11,
        "width": 1,
        "height": 1
    },
    {
        "id": "78790ced5ae13a43",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "92429f8f445aacdf",
        "order": 13,
        "width": 2,
        "height": 1
    },
    {
        "id": "741b14e9ee37da05",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "92429f8f445aacdf",
        "order": 15,
        "width": 1,
        "height": 1
    },
    {
        "id": "ea6bc3d4358c2952",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "92429f8f445aacdf",
        "order": 16,
        "width": 12,
        "height": 1
    },
    {
        "id": "dad613413f9810d4",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "92429f8f445aacdf",
        "order": 17,
        "width": 3,
        "height": 1
    },
    {
        "id": "f7ded2354a462c98",
        "type": "ui_spacer",
        "z": "98e4246c87add39e",
        "name": "spacer",
        "group": "92429f8f445aacdf",
        "order": 19,
        "width": 3,
        "height": 1
    },
    {
        "id": "e78c211a864b4657",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "2201d496820b415d",
        "order": 8,
        "width": 1,
        "height": 1
    },
    {
        "id": "81b7b37ff10b3df1",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "2201d496820b415d",
        "order": 10,
        "width": 1,
        "height": 1
    },
    {
        "id": "796ef493768b6034",
        "type": "ui_spacer",
        "z": "3154c44d1a91de38",
        "name": "spacer",
        "group": "90879df8d2ee4c5d",
        "order": 3,
        "width": 1,
        "height": 1
    },
    {
        "id": "d3de24e635754f29",
        "type": "influxdb in",
        "z": "592b686edd11b813",
        "influxdb": "1a7d214ba0ada216",
        "name": "",
        "query": "",
        "rawOutput": true,
        "precision": "",
        "retentionPolicy": "",
        "org": "organisation",
        "x": 1520,
        "y": 120,
        "wires": [
            [
                "fe5eba49bd6ec407"
            ]
        ]
    },
    {
        "id": "20098afb1eb3b578",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "select kiln temps",
        "rules": [
            {
                "t": "set",
                "p": "query",
                "pt": "msg",
                "to": "select * from Kiln_01_UpperTemperature, Kiln_01_LowerTemperature WHERE time > now() - 12h LIMIT 1000",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 120,
        "wires": [
            [
                "d3de24e635754f29"
            ]
        ]
    },
    {
        "id": "c375c2d46ab804f0",
        "type": "comment",
        "z": "592b686edd11b813",
        "name": "https://docs.influxdata.com/influxdb/v1.8/query_language/explore-data/",
        "info": "",
        "x": 1300,
        "y": 80,
        "wires": []
    },
    {
        "id": "b9f05874cb2439dc",
        "type": "catch",
        "z": "592b686edd11b813",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 60,
        "y": 20,
        "wires": [
            [
                "21cec14cfdce048d"
            ]
        ]
    },
    {
        "id": "21cec14cfdce048d",
        "type": "debug",
        "z": "592b686edd11b813",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 190,
        "y": 20,
        "wires": []
    },
    {
        "id": "fde73e3afa0924f7",
        "type": "ui_button",
        "z": "592b686edd11b813",
        "name": "",
        "group": "b96e65c991e4f663",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Show Last 48 Hours",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 160,
        "y": 1720,
        "wires": [
            [
                "d640cbec48042332"
            ]
        ]
    },
    {
        "id": "51523551dd33a6f6",
        "type": "switch",
        "z": "592b686edd11b813",
        "name": "",
        "property": "#:(memoryOnly)::kiln_01.dashboard.auto_refresh",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 315,
        "y": 1340,
        "wires": [
            [
                "a65357c5f5e0b6d3"
            ]
        ],
        "l": false
    },
    {
        "id": "a8d03f2954ef1460",
        "type": "inject",
        "z": "592b686edd11b813",
        "name": "auto refresh",
        "props": [],
        "repeat": "10",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 210,
        "y": 1340,
        "wires": [
            [
                "51523551dd33a6f6"
            ]
        ]
    },
    {
        "id": "018ef11ba74cb510",
        "type": "ui_form",
        "z": "592b686edd11b813",
        "name": "",
        "label": "",
        "group": "5e1bdbab1ef4cbe6",
        "order": 8,
        "width": 0,
        "height": 0,
        "options": [
            {
                "label": "Segment Name",
                "value": "name",
                "type": "text",
                "required": true,
                "rows": null
            },
            {
                "label": "Enabled",
                "value": "enabled",
                "type": "checkbox",
                "required": true,
                "rows": null
            },
            {
                "label": "Hold Enabled",
                "value": "hold",
                "type": "checkbox",
                "required": true,
                "rows": null
            },
            {
                "label": "Setpoint",
                "value": "setpoint",
                "type": "number",
                "required": true,
                "rows": null
            },
            {
                "label": "Ramp Rate",
                "value": "ramp_rate",
                "type": "number",
                "required": true,
                "rows": null
            },
            {
                "label": "Soak Time",
                "value": "soak_time",
                "type": "number",
                "required": true,
                "rows": null
            }
        ],
        "formValue": {
            "name": "",
            "enabled": false,
            "hold": false,
            "setpoint": "",
            "ramp_rate": "",
            "soak_time": ""
        },
        "payload": "",
        "submit": "submit",
        "cancel": "cancel",
        "topic": "topic",
        "topicType": "msg",
        "splitLayout": "",
        "className": "",
        "x": 490,
        "y": 320,
        "wires": [
            [
                "f5070cef209d87e2"
            ]
        ]
    },
    {
        "id": "f7a42259283f2fc9",
        "type": "ui_dropdown",
        "z": "592b686edd11b813",
        "name": "",
        "label": "Schedule",
        "tooltip": "",
        "place": "Select option",
        "group": "5e1bdbab1ef4cbe6",
        "order": 1,
        "width": 5,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [],
        "payload": "",
        "topic": "topic",
        "topicType": "msg",
        "className": "",
        "x": 500,
        "y": 240,
        "wires": [
            [
                "338932c551eabbf7",
                "bbb665c4fceb800d"
            ]
        ]
    },
    {
        "id": "338932c551eabbf7",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "#:(memoryOnly)::schedule_index",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 655,
        "y": 240,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "f5070cef209d87e2",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "//global.set('kiln_01.selected_schedule', temp);\nvar schedule_index = flow.get('schedule_index', 'memoryOnly');\nvar segment_index = flow.get('segment_index', 'memoryOnly');\nvar segment = 'kiln_01.schedules['+ schedule_index.toString() + '].segments[' + segment_index.toString() + ']'\nglobal.set(segment, msg.payload);\nmsg.payload = segment\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 635,
        "y": 320,
        "wires": [
            [
                "6b534a21adf47fbc"
            ]
        ],
        "l": false
    },
    {
        "id": "9256680a1dd25943",
        "type": "ui_dropdown",
        "z": "592b686edd11b813",
        "name": "",
        "label": "Segment",
        "tooltip": "",
        "place": "Select option",
        "group": "5e1bdbab1ef4cbe6",
        "order": 4,
        "width": 5,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [],
        "payload": "",
        "topic": "topic",
        "topicType": "msg",
        "className": "",
        "x": 500,
        "y": 280,
        "wires": [
            [
                "b88e332b4ed39aac",
                "bbb665c4fceb800d"
            ]
        ]
    },
    {
        "id": "b88e332b4ed39aac",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "#:(memoryOnly)::segment_index",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 655,
        "y": 280,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "5192f533b0238631",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "update form",
        "func": "//global.set('kiln_01.selected_schedule', temp, 'memoryOnly');\nvar schedule_index = flow.get('schedule_index', 'memoryOnly');\nvar segment_index = flow.get('segment_index', 'memoryOnly');\nmsg.payload = global.get('kiln_01.schedules['+ schedule_index.toString() + '].segments[' + segment_index.toString() + ']');\nvar msg2 = {}\nmsg2.payload = global.get('kiln_01.schedules['+ schedule_index.toString() + '].segments');\nreturn [msg,msg2];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 530,
        "y": 620,
        "wires": [
            [
                "3fda2bd34a7c89b2"
            ],
            [
                "338980eff32a3206"
            ]
        ]
    },
    {
        "id": "49136d0a89f16ce8",
        "type": "inject",
        "z": "592b686edd11b813",
        "name": "Initialize",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 135,
        "y": 240,
        "wires": [
            [
                "26aedf9d4f3e92fc",
                "63be7f287f0bdc31",
                "f4bb65861a8f2d49"
            ]
        ],
        "l": false
    },
    {
        "id": "26aedf9d4f3e92fc",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "set default index",
        "rules": [
            {
                "t": "set",
                "p": "#:(memoryOnly)::schedule_index",
                "pt": "flow",
                "to": "0",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "#:(memoryOnly)::segment_index",
                "pt": "flow",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 235,
        "y": 200,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "782f21bebe74bd1c",
        "type": "ui_dropdown",
        "z": "592b686edd11b813",
        "name": "",
        "label": "Active Schedule",
        "tooltip": "",
        "place": "Select option",
        "group": "90879df8d2ee4c5d",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "multiple": false,
        "options": [
            {
                "label": "schedule 1",
                "value": 0,
                "type": "num"
            },
            {
                "label": "schedule 2",
                "value": 1,
                "type": "num"
            },
            {
                "label": "schedule 3",
                "value": 2,
                "type": "num"
            },
            {
                "label": "schedule 4",
                "value": 3,
                "type": "num"
            },
            {
                "label": "schedule 5",
                "value": 4,
                "type": "num"
            },
            {
                "label": "schedule 6",
                "value": 5,
                "type": "num"
            },
            {
                "label": "schedule 7",
                "value": 6,
                "type": "num"
            },
            {
                "label": "schedule 8",
                "value": 7,
                "type": "num"
            },
            {
                "label": "schedule 9",
                "value": 8,
                "type": "num"
            }
        ],
        "payload": "",
        "topic": "topic",
        "topicType": "msg",
        "x": 660,
        "y": 740,
        "wires": [
            [
                "245aecb0a76e7750"
            ]
        ]
    },
    {
        "id": "245aecb0a76e7750",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "set schedule index",
        "func": "\n//var selected_schedule = global.get('kiln_01.schedules['+ msg.payload + ']')\n//global.set('kiln_01.active_schedule', selected_schedule);\nglobal.set('kiln_01.active_schedule_index', msg.payload);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 775,
        "y": 740,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "b5b651e02428cab0",
        "type": "comment",
        "z": "592b686edd11b813",
        "name": "Control Dashboard",
        "info": "",
        "x": 110,
        "y": 700,
        "wires": []
    },
    {
        "id": "71b520a30c4deec4",
        "type": "ui_button",
        "z": "592b686edd11b813",
        "name": "",
        "group": "90879df8d2ee4c5d",
        "order": 2,
        "width": 3,
        "height": 1,
        "passthru": false,
        "label": "Start",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "play_arrow",
        "payload": "Start",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 290,
        "y": 840,
        "wires": [
            [
                "c03c7fb7458a9e9f"
            ]
        ]
    },
    {
        "id": "ae53f4a3aef75fe8",
        "type": "ui_button",
        "z": "592b686edd11b813",
        "name": "",
        "group": "90879df8d2ee4c5d",
        "order": 4,
        "width": 3,
        "height": 1,
        "passthru": false,
        "label": "Stop",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "stop",
        "payload": "Stop",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 290,
        "y": 880,
        "wires": [
            [
                "c03c7fb7458a9e9f"
            ]
        ]
    },
    {
        "id": "95a54e2f0c9b2382",
        "type": "ui_button",
        "z": "592b686edd11b813",
        "name": "",
        "group": "90879df8d2ee4c5d",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Release",
        "tooltip": "",
        "color": "",
        "bgcolor": "orange",
        "icon": "restore",
        "payload": "Release",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 280,
        "y": 960,
        "wires": [
            [
                "c03c7fb7458a9e9f"
            ]
        ]
    },
    {
        "id": "c03c7fb7458a9e9f",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "Output - Buttons",
        "mode": "link",
        "links": [
            "defcc28b265151c2",
            "81fb9a528731184e"
        ],
        "x": 435,
        "y": 900,
        "wires": []
    },
    {
        "id": "219b6df02966d0e3",
        "type": "ui_text",
        "z": "592b686edd11b813",
        "group": "2201d496820b415d",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Segment State",
        "format": "<font color='green'>{{msg.payload}}</font>",
        "layout": "row-spread",
        "x": 320,
        "y": 1140,
        "wires": []
    },
    {
        "id": "8095bbd934bc130c",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - Current Segment State",
        "links": [
            "fb11495e37bdb84b"
        ],
        "x": 175,
        "y": 1140,
        "wires": [
            [
                "219b6df02966d0e3"
            ]
        ]
    },
    {
        "id": "1de58add27ec2baf",
        "type": "ui_text",
        "z": "592b686edd11b813",
        "group": "2201d496820b415d",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Schedule State",
        "format": "<font color='green'>{{msg.payload}}</font>",
        "layout": "row-spread",
        "x": 320,
        "y": 1100,
        "wires": []
    },
    {
        "id": "44901a155449dc95",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - Current Schedule State",
        "links": [
            "b33e0726c17b668b"
        ],
        "x": 175,
        "y": 1100,
        "wires": [
            [
                "1de58add27ec2baf"
            ]
        ]
    },
    {
        "id": "2e9532e03f213fb4",
        "type": "ui_text",
        "z": "592b686edd11b813",
        "group": "2201d496820b415d",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Setpoint",
        "format": "<font color='green'>{{msg.payload}} °F</font>",
        "layout": "row-spread",
        "x": 300,
        "y": 1260,
        "wires": []
    },
    {
        "id": "a8bc30bb3ce76d5e",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - Status Setpoint",
        "links": [
            "edf985d2d969c4b4"
        ],
        "x": 175,
        "y": 1260,
        "wires": [
            [
                "2e9532e03f213fb4"
            ]
        ]
    },
    {
        "id": "85642d7408d49cd8",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - schedule selection dropdown",
        "links": [
            "7b896f97e70ee242",
            "75b14d458cd1e761",
            "a898206a716472e9"
        ],
        "x": 535,
        "y": 740,
        "wires": [
            [
                "782f21bebe74bd1c"
            ]
        ]
    },
    {
        "id": "91047655c7bbfdd5",
        "type": "ui_ui_control",
        "z": "592b686edd11b813",
        "name": "",
        "events": "all",
        "x": 155,
        "y": 740,
        "wires": [
            [
                "c35a667653959ba3"
            ]
        ],
        "l": false
    },
    {
        "id": "c35a667653959ba3",
        "type": "switch",
        "z": "592b686edd11b813",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "change",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 215,
        "y": 740,
        "wires": [
            [
                "d1b9dbb996bc65fd"
            ]
        ],
        "l": false
    },
    {
        "id": "d1b9dbb996bc65fd",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "update schedule dropdown with selected schedule index",
        "func": "\n\nmsg.payload = global.get('kiln_01.active_schedule_index');\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 275,
        "y": 740,
        "wires": [
            [
                "75b14d458cd1e761"
            ]
        ],
        "l": false
    },
    {
        "id": "75b14d458cd1e761",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "",
        "mode": "link",
        "links": [
            "85642d7408d49cd8"
        ],
        "x": 335,
        "y": 740,
        "wires": []
    },
    {
        "id": "ed6864b464819bbc",
        "type": "ui_ui_control",
        "z": "592b686edd11b813",
        "name": "",
        "events": "all",
        "x": 255,
        "y": 600,
        "wires": [
            [
                "52e7c1f8dff102dc"
            ]
        ],
        "l": false
    },
    {
        "id": "52e7c1f8dff102dc",
        "type": "switch",
        "z": "592b686edd11b813",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "lost",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "connect",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "change",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 315,
        "y": 600,
        "wires": [
            [],
            [
                "5192f533b0238631",
                "c43fe6a6eabba842"
            ],
            [
                "5192f533b0238631"
            ]
        ],
        "l": false
    },
    {
        "id": "87d7118f46499bc1",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - release button",
        "links": [
            "f59050e178b63b1a"
        ],
        "x": 155,
        "y": 960,
        "wires": [
            [
                "95a54e2f0c9b2382"
            ]
        ]
    },
    {
        "id": "bd741c9362f990e9",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - advance button",
        "links": [],
        "x": 155,
        "y": 920,
        "wires": [
            [
                "7bfd8d56a8dba80e"
            ]
        ]
    },
    {
        "id": "a585d96564013b99",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - stop button",
        "links": [],
        "x": 155,
        "y": 880,
        "wires": [
            [
                "ae53f4a3aef75fe8"
            ]
        ]
    },
    {
        "id": "0642571f7ecac918",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - start button",
        "links": [],
        "x": 155,
        "y": 840,
        "wires": [
            [
                "71b520a30c4deec4"
            ]
        ]
    },
    {
        "id": "e5aec5149ce37d5d",
        "type": "ui_text",
        "z": "592b686edd11b813",
        "group": "2201d496820b415d",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Current Segment",
        "format": "<font color='green'>{{msg.payload}}</font>",
        "layout": "row-spread",
        "x": 330,
        "y": 1180,
        "wires": []
    },
    {
        "id": "1d2a7e1b14ed985d",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - current segment",
        "links": [
            "3ab377921817af3f"
        ],
        "x": 175,
        "y": 1180,
        "wires": [
            [
                "e5aec5149ce37d5d"
            ]
        ]
    },
    {
        "id": "f9d4fdfcb6abeb41",
        "type": "ui_text",
        "z": "592b686edd11b813",
        "group": "2201d496820b415d",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Soak Remaining",
        "format": "<font color='green'>{{msg.payload}} min</font>",
        "layout": "row-spread",
        "x": 320,
        "y": 1220,
        "wires": []
    },
    {
        "id": "bc808949af0e238a",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - Segment remaining",
        "links": [
            "355d9c4e737fdfe5",
            "9272078ab32e5e81",
            "f1d4774590c51f3d"
        ],
        "x": 175,
        "y": 1220,
        "wires": [
            [
                "f9d4fdfcb6abeb41"
            ]
        ]
    },
    {
        "id": "4610f0d05bf3b4b1",
        "type": "ui_gauge",
        "z": "592b686edd11b813",
        "name": "",
        "group": "2201d496820b415d",
        "order": 7,
        "width": 3,
        "height": 2,
        "gtype": "gage",
        "title": "Upper Temperature",
        "label": "°F",
        "format": "{{value}}",
        "min": 0,
        "max": "2500",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 790,
        "y": 1140,
        "wires": []
    },
    {
        "id": "1a904f944ba81c1b",
        "type": "ui_gauge",
        "z": "592b686edd11b813",
        "name": "",
        "group": "2201d496820b415d",
        "order": 9,
        "width": 3,
        "height": 2,
        "gtype": "gage",
        "title": "Lower Temperature",
        "label": "°F",
        "format": "{{value}}",
        "min": 0,
        "max": "2500",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 790,
        "y": 1180,
        "wires": []
    },
    {
        "id": "9b6b7f2249d013ba",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - Upper Temperature",
        "links": [
            "dcbc073ea7b777ee"
        ],
        "x": 635,
        "y": 1140,
        "wires": [
            [
                "4610f0d05bf3b4b1"
            ]
        ]
    },
    {
        "id": "4ea9f6ce194f1281",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - Lower Temperature",
        "links": [
            "e65201e766b76bfd"
        ],
        "x": 635,
        "y": 1180,
        "wires": [
            [
                "1a904f944ba81c1b"
            ]
        ]
    },
    {
        "id": "0ced5c373a61386b",
        "type": "ui_chart",
        "z": "592b686edd11b813",
        "name": "",
        "group": "2201d496820b415d",
        "order": 11,
        "width": 7,
        "height": 5,
        "label": "",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "Refresh to see data",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 790,
        "y": 1340,
        "wires": [
            []
        ]
    },
    {
        "id": "89090e12b153c6a4",
        "type": "ui_template",
        "z": "592b686edd11b813",
        "group": "abf790e2f9501fc7",
        "name": "",
        "order": 1,
        "width": 15,
        "height": 10,
        "format": "<style>\n.table\n{\nwidth: 100%;\n//width:500px;\n//background:lightblue;\n//border:1px solid black;\n//border-collapse: collapse;\n//font-size:10px;\ntext-align: center;\nvertical-align: center;\n}\n.data {\n  //width: 15%\n  //white-space: nowrap\n  //white-space: normal\n}\n.main\n{\n//height:400px;\n}\n</style>\n<div class=\"main\">\n    <table class=\"table\">  \n        <tr>\n        <th style=\"text-decoration: underline;\">Index</th>\n        <th class=\"data\" style=\"text-decoration: underline;\">Name</th>\n        <th class=\"data\" style=\"text-decoration: underline;\">Enabled</th>\n        <th class=\"data\" style=\"text-decoration: underline;\">Hold</th>\n        <th class=\"data\" style=\"text-decoration: underline;\">Setpoint (°F)</th>\n        <th class=\"data\" style=\"text-decoration: underline;\">Ramp (deg/h)</th>\n        <th class=\"data\" style=\"text-decoration: underline;\">Soak (min)</th>\n        </tr>\n        <tr ng-repeat = \"payload in msg.payload\"><td>{{$index+1}}</td><td ng-repeat =\"(key,value) in payload\">{{value}}</td></tr>\n    </table>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 500,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "22fd3eb6907ee40d",
        "type": "ui_button",
        "z": "592b686edd11b813",
        "d": true,
        "name": "delete segment",
        "group": "5e1bdbab1ef4cbe6",
        "order": 6,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Delete",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 520,
        "y": 400,
        "wires": [
            [
                "d815b4776bb0f1aa"
            ]
        ]
    },
    {
        "id": "d815b4776bb0f1aa",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "var schedule_index = flow.get('schedule_index', 'memoryOnly');\nvar segment_index = flow.get('segment_index', 'memoryOnly');\nvar segment = 'kiln_01.schedules['+ schedule_index.toString() + '].segments[' + segment_index.toString() + ']'\n\nglobal.set(segment, undefined);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 635,
        "y": 400,
        "wires": [
            [
                "6b534a21adf47fbc"
            ]
        ],
        "l": false
    },
    {
        "id": "e0f89df2c8e81cd9",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "",
        "links": [
            "3fda2bd34a7c89b2"
        ],
        "x": 395,
        "y": 320,
        "wires": [
            [
                "018ef11ba74cb510"
            ]
        ]
    },
    {
        "id": "ae2b5be430abc93f",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "",
        "links": [
            "338980eff32a3206"
        ],
        "x": 395,
        "y": 360,
        "wires": [
            [
                "89090e12b153c6a4"
            ]
        ]
    },
    {
        "id": "3fda2bd34a7c89b2",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "",
        "mode": "link",
        "links": [
            "e0f89df2c8e81cd9"
        ],
        "x": 655,
        "y": 600,
        "wires": []
    },
    {
        "id": "338980eff32a3206",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "",
        "mode": "link",
        "links": [
            "ae2b5be430abc93f"
        ],
        "x": 655,
        "y": 640,
        "wires": []
    },
    {
        "id": "006321a7d5098eed",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "",
        "links": [
            "6b534a21adf47fbc",
            "bbb665c4fceb800d",
            "beee976f9bb8a5fd"
        ],
        "x": 395,
        "y": 640,
        "wires": [
            [
                "5192f533b0238631"
            ]
        ]
    },
    {
        "id": "6b534a21adf47fbc",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "",
        "mode": "link",
        "links": [
            "006321a7d5098eed"
        ],
        "x": 715,
        "y": 360,
        "wires": []
    },
    {
        "id": "bbb665c4fceb800d",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "",
        "mode": "link",
        "links": [
            "006321a7d5098eed",
            "223bca47aa31a4da"
        ],
        "x": 655,
        "y": 200,
        "wires": []
    },
    {
        "id": "63be7f287f0bdc31",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "set segment names",
        "rules": [
            {
                "t": "set",
                "p": "options",
                "pt": "msg",
                "to": "[{\"segment 1\":\"0\"},{\"segment 2\":\"1\"},{\"segment 3\":\"2\"},{\"segment 4\":\"3\"},{\"segment 5\":\"4\"},{\"segment 6\":\"5\"},{\"segment 7\":\"6\"},{\"segment 8\":\"7\"},{\"segment 9\":\"8\"},{\"segment 10\":\"9\"},{\"segment 11\":\"10\"},{\"segment 12\":\"11\"},{\"segment 13\":\"12\"},{\"segment 14\":\"13\"},{\"segment 15\":\"14\"}]",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 235,
        "y": 280,
        "wires": [
            [
                "9256680a1dd25943"
            ]
        ],
        "l": false
    },
    {
        "id": "7bfd8d56a8dba80e",
        "type": "ui_button",
        "z": "592b686edd11b813",
        "name": "",
        "group": "90879df8d2ee4c5d",
        "order": 7,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Advance",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "skip_next",
        "payload": "Advance",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 280,
        "y": 920,
        "wires": [
            [
                "c03c7fb7458a9e9f"
            ]
        ]
    },
    {
        "id": "8058b979887ff4eb",
        "type": "ui_button",
        "z": "592b686edd11b813",
        "name": "",
        "group": "90879df8d2ee4c5d",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Hold",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "pause",
        "payload": "Hold",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 290,
        "y": 1000,
        "wires": [
            [
                "c03c7fb7458a9e9f"
            ]
        ]
    },
    {
        "id": "87ef55ffe3ea2883",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - hold button",
        "links": [],
        "x": 155,
        "y": 1000,
        "wires": [
            [
                "8058b979887ff4eb"
            ]
        ]
    },
    {
        "id": "f03679a3e4397812",
        "type": "comment",
        "z": "592b686edd11b813",
        "name": "https://klarsys.github.io/angular-material-icons/",
        "info": "",
        "x": 300,
        "y": 800,
        "wires": []
    },
    {
        "id": "ae4c90c0ed49a0c2",
        "type": "ui_ui_control",
        "z": "592b686edd11b813",
        "name": "",
        "events": "all",
        "x": 280,
        "y": 1400,
        "wires": [
            [
                "cf385be5a48bd527"
            ]
        ]
    },
    {
        "id": "cf385be5a48bd527",
        "type": "switch",
        "z": "592b686edd11b813",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "lost",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "connect",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "change",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 410,
        "y": 1400,
        "wires": [
            [
                "2f728d5ae34b85ed"
            ],
            [
                "ce863fe5718c88a5"
            ],
            []
        ]
    },
    {
        "id": "2f728d5ae34b85ed",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "Clear Auto Refresh",
        "rules": [
            {
                "t": "set",
                "p": "#:(memoryOnly)::kiln_01.dashboard.auto_refresh",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 1380,
        "wires": [
            []
        ]
    },
    {
        "id": "ce863fe5718c88a5",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "Set Auto Refresh",
        "rules": [
            {
                "t": "set",
                "p": "#:(memoryOnly)::kiln_01.dashboard.auto_refresh",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 1400,
        "wires": [
            []
        ]
    },
    {
        "id": "2b7d853b4ddd2588",
        "type": "ui_text",
        "z": "592b686edd11b813",
        "group": "2201d496820b415d",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Ramp Rate",
        "format": "<font color='green'>{{msg.payload}} deg/h</font>",
        "layout": "row-spread",
        "x": 770,
        "y": 1100,
        "wires": []
    },
    {
        "id": "899c85f172cb1839",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "Input - status ramp rate",
        "links": [
            "233d081ef7b67749",
            "59ca3789e4efaf36",
            "c5180a0a450ebd11"
        ],
        "x": 635,
        "y": 1100,
        "wires": [
            [
                "2b7d853b4ddd2588"
            ]
        ]
    },
    {
        "id": "fe5eba49bd6ec407",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "\n\n// enable \"raw output\" from the influxdb node\n// use this query: select * from Kiln_01_UpperTemperature, Kiln_01_LowerTemperature WHERE time > now() - 12h LIMIT 1000\nvar msg_out = {\"payload\":[{\"series\":[],\"data\":[],\"labels\":[]}]};\n\n// series 1\nvar series_data0 = [];\nfor(i = 0; i < msg.payload.results[0].series[0].values.length-1; i++){\n    series_data0.push({\n        x: msg.payload.results[0].series[0].values[i][0],\n        y: msg.payload.results[0].series[0].values[i][1],\n    })\n}\nmsg_out.payload[0].series[0] = msg.payload.results[0].series[0].name\nmsg_out.payload[0].labels[0] = \"Upper Temp Label\"\n\n// series 2\nvar series_data1 = [];\nfor(i = 0; i < msg.payload.results[0].series[1].values.length-1; i++){\n    series_data1.push({\n        x: msg.payload.results[0].series[1].values[i][0],\n        y: msg.payload.results[0].series[1].values[i][1],\n    })\n}\nmsg_out.payload[0].series[1] = msg.payload.results[0].series[1].name\nmsg_out.payload[0].labels[1] = \"Lower Temp Label\"\n\n// add all series to the data array\nvar data_array = [];\ndata_array[0] = series_data0\ndata_array[1] = series_data1\n\n// \nmsg_out.payload[0].data = data_array\n\nreturn msg_out;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1720,
        "y": 120,
        "wires": [
            [
                "c046e58693cda480"
            ]
        ]
    },
    {
        "id": "03352599cb88060e",
        "type": "inject",
        "z": "592b686edd11b813",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1120,
        "y": 120,
        "wires": [
            [
                "20098afb1eb3b578"
            ]
        ]
    },
    {
        "id": "c046e58693cda480",
        "type": "debug",
        "z": "592b686edd11b813",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1850,
        "y": 120,
        "wires": []
    },
    {
        "id": "2882f7e30e663921",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "downsampled data",
        "rules": [
            {
                "t": "set",
                "p": "query",
                "pt": "msg",
                "to": "SELECT * FROM downsampled_temps LIMIT 1000",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 220,
        "wires": [
            [
                "d34470a9082d1d2b"
            ]
        ]
    },
    {
        "id": "298be23ac3138047",
        "type": "inject",
        "z": "592b686edd11b813",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1120,
        "y": 220,
        "wires": [
            [
                "2882f7e30e663921"
            ]
        ]
    },
    {
        "id": "d2a1f5087f7e1ded",
        "type": "debug",
        "z": "592b686edd11b813",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1850,
        "y": 220,
        "wires": []
    },
    {
        "id": "231c417032f6e1d5",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "\n\n// enable \"raw output\" from the influxdb node\n// use this query: select * from kiln_upper_temperature_01, kiln_lower_temperature_01 WHERE time > now() - 1h;\nvar msg_out = {\"payload\":[{\"series\":[],\"data\":[],\"labels\":[]}]};\n\n// series 1\nvar series_data0 = [];\nfor(i = 0; i < msg.payload.length-1; i++){\n    series_data0.push({\n        x: msg.payload[i].TIMESTAMP,\n        y: msg.payload[i].VALUE,\n    })\n}\nmsg_out.payload[0].series[0] = msg.payload[0].DEVICE\nmsg_out.payload[0].labels[0] = \"Upper Temp Label\"\n\n// series 2\n/*var series_data1 = [];\nfor(i = 0; i < msg.payload.results[0].series[1].values.length-1; i++){\n    series_data1.push({\n        x: msg.payload.results[0].series[1].values[i][0],\n        y: msg.payload.results[0].series[1].values[i][1],\n    })\n}\nmsg_out.payload[0].series[1] = msg.payload.results[0].series[1].name\nmsg_out.payload[0].labels[1] = \"Lower Temp Label\"*/\n\n// add all series to the data array\nvar data_array = [];\ndata_array[0] = series_data0\n//data_array[1] = series_data1\n\n// \nmsg_out.payload[0].data = data_array\n\nreturn msg_out;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1660,
        "y": 380,
        "wires": [
            [
                "c0240b58df242afe"
            ]
        ]
    },
    {
        "id": "e90eada40cfeaa9c",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "SELECT * FROM temperature WHERE TIMESTAMP >= strftime('%s','now', '-12 hours')*1000 LIMIT 2000",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "c0240b58df242afe",
        "type": "debug",
        "z": "592b686edd11b813",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1810,
        "y": 380,
        "wires": []
    },
    {
        "id": "fa51981d0ffeaaa3",
        "type": "inject",
        "z": "592b686edd11b813",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1120,
        "y": 380,
        "wires": [
            [
                "e90eada40cfeaa9c"
            ]
        ]
    },
    {
        "id": "fb07d106257c09b8",
        "type": "influxdb in",
        "z": "592b686edd11b813",
        "influxdb": "1a7d214ba0ada216",
        "name": "",
        "query": "",
        "rawOutput": true,
        "precision": "",
        "retentionPolicy": "",
        "org": "organisation",
        "x": 540,
        "y": 1340,
        "wires": [
            [
                "566ce4114146f76d"
            ]
        ]
    },
    {
        "id": "a65357c5f5e0b6d3",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "select kiln temps",
        "rules": [
            {
                "t": "set",
                "p": "query",
                "pt": "msg",
                "to": "select * from Kiln_01_UpperTemperature, Kiln_01_LowerTemperature WHERE time > now() - 12h;",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 375,
        "y": 1340,
        "wires": [
            [
                "fb07d106257c09b8"
            ]
        ],
        "l": false
    },
    {
        "id": "566ce4114146f76d",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "parse query results",
        "func": "if (msg.payload.results[0].series !== undefined){\n    // enable \"raw output\" from the influxdb node\n    // use this query: select * from kiln_upper_temperature_01, kiln_lower_temperature_01 WHERE time > now() - 1h;\n    var msg_out = {\"payload\":[{\"series\":[],\"data\":[],\"labels\":[]}]};\n    \n    // series 1\n    var series_data0 = [];\n    for(i = 0; i < msg.payload.results[0].series[0].values.length-1; i++){\n        series_data0.push({\n            x: msg.payload.results[0].series[0].values[i][0],\n            y: msg.payload.results[0].series[0].values[i][1],\n        })\n    }\n    msg_out.payload[0].series[0] = msg.payload.results[0].series[0].name\n    msg_out.payload[0].labels[0] = \"Upper Temp Label\"\n    \n    // series 2\n    var series_data1 = [];\n    for(i = 0; i < msg.payload.results[0].series[1].values.length-1; i++){\n        series_data1.push({\n            x: msg.payload.results[0].series[1].values[i][0],\n            y: msg.payload.results[0].series[1].values[i][1],\n        })\n    }\n    msg_out.payload[0].series[1] = msg.payload.results[0].series[1].name\n    msg_out.payload[0].labels[1] = \"Lower Temp Label\"\n    \n    // add all series to the data array\n    var data_array = [];\n    data_array[0] = series_data0\n    data_array[1] = series_data1\n    \n    // \n    msg_out.payload[0].data = data_array\n    \n    return msg_out;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 1340,
        "wires": [
            [
                "0ced5c373a61386b"
            ]
        ],
        "l": false
    },
    {
        "id": "2aef5c2b2b4a8586",
        "type": "comment",
        "z": "592b686edd11b813",
        "name": "https://docs.influxdata.com/influxdb/v1.7/guides/downsampling_and_retention/",
        "info": "",
        "x": 1320,
        "y": 180,
        "wires": []
    },
    {
        "id": "d34470a9082d1d2b",
        "type": "influxdb in",
        "z": "592b686edd11b813",
        "influxdb": "1a7d214ba0ada216",
        "name": "",
        "query": "",
        "rawOutput": true,
        "precision": "",
        "retentionPolicy": "",
        "org": "organisation",
        "x": 1520,
        "y": 220,
        "wires": [
            [
                "7afdb6d5377e9abc",
                "c65e63dccc35ee06"
            ]
        ]
    },
    {
        "id": "7afdb6d5377e9abc",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "\n\n// enable \"raw output\" from the influxdb node\n// use this query: SELECT * FROM downsampled_temps LIMIT 1000\nvar msg_out = {\"payload\":[{\"series\":[],\"data\":[],\"labels\":[]}]};\n\n// series 1\nvar series_data0 = [];\nvar series_data1 = [];\nfor(i = 0; i < msg.payload.results[0].series[0].values.length-1; i++){\n    series_data0.push({\n        x: msg.payload.results[0].series[0].values[i][0],\n        y: msg.payload.results[0].series[0].values[i][1],\n    })\n    series_data1.push({\n        x: msg.payload.results[0].series[0].values[i][0],\n        y: msg.payload.results[0].series[0].values[i][2],\n    })\n}\nmsg_out.payload[0].series[0] = msg.payload.results[0].series[0].columns[1]\n//msg_out.payload[0].labels[0] = \"Upper Temp Label\"\nmsg_out.payload[0].series[1] = msg.payload.results[0].series[0].columns[2]\n//msg_out.payload[0].labels[1] = \"Lower Temp Label\"\n\n// add all series to the data array\nvar data_array = [];\ndata_array[0] = series_data0\ndata_array[1] = series_data1\n\n// \nmsg_out.payload[0].data = data_array\n\nreturn msg_out;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1720,
        "y": 220,
        "wires": [
            [
                "d2a1f5087f7e1ded"
            ]
        ]
    },
    {
        "id": "2a1f183bb4e05864",
        "type": "ui_chart",
        "z": "592b686edd11b813",
        "name": "",
        "group": "b96e65c991e4f663",
        "order": 1,
        "width": 0,
        "height": 0,
        "label": "",
        "chartType": "line",
        "legend": "true",
        "xformat": "Y-M-D",
        "interpolate": "linear",
        "nodata": "Refresh to see data",
        "dot": true,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 790,
        "y": 1680,
        "wires": [
            []
        ]
    },
    {
        "id": "d640cbec48042332",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "downsampled data",
        "rules": [
            {
                "t": "set",
                "p": "query",
                "pt": "msg",
                "to": "SELECT * FROM downsampled_temps WHERE time > now() - 48h",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 310,
        "y": 1680,
        "wires": [
            [
                "a5b1ee57491885ff"
            ]
        ]
    },
    {
        "id": "9dbd945c8b6f4bd5",
        "type": "inject",
        "z": "592b686edd11b813",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 155,
        "y": 1680,
        "wires": [
            [
                "d640cbec48042332"
            ]
        ],
        "l": false
    },
    {
        "id": "a5b1ee57491885ff",
        "type": "influxdb in",
        "z": "592b686edd11b813",
        "influxdb": "1a7d214ba0ada216",
        "name": "",
        "query": "",
        "rawOutput": true,
        "precision": "",
        "retentionPolicy": "",
        "org": "organisation",
        "x": 540,
        "y": 1680,
        "wires": [
            [
                "0c676b6e43885baa"
            ]
        ]
    },
    {
        "id": "0c676b6e43885baa",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "\n\n// enable \"raw output\" from the influxdb node\n// use this query: SELECT * FROM downsampled_temps LIMIT 1000\nvar msg_out = {\"payload\":[{\"series\":[],\"data\":[],\"labels\":[]}]};\n\n// series 1\nvar series_data0 = [];\nvar series_data1 = [];\nfor(i = 0; i < msg.payload.results[0].series[0].values.length-1; i++){\n    series_data0.push({\n        x: msg.payload.results[0].series[0].values[i][0],\n        y: msg.payload.results[0].series[0].values[i][1],\n    })\n    series_data1.push({\n        x: msg.payload.results[0].series[0].values[i][0],\n        y: msg.payload.results[0].series[0].values[i][2],\n    })\n}\nmsg_out.payload[0].series[0] = msg.payload.results[0].series[0].columns[1]\n//msg_out.payload[0].labels[0] = \"Upper Temp Label\"\nmsg_out.payload[0].series[1] = msg.payload.results[0].series[0].columns[2]\n//msg_out.payload[0].labels[1] = \"Lower Temp Label\"\n\n// add all series to the data array\nvar data_array = [];\ndata_array[0] = series_data0\ndata_array[1] = series_data1\n\n// \nmsg_out.payload[0].data = data_array\n\nreturn msg_out;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 1680,
        "wires": [
            [
                "2a1f183bb4e05864"
            ]
        ],
        "l": false
    },
    {
        "id": "33d03b8549555671",
        "type": "comment",
        "z": "592b686edd11b813",
        "name": "Historical dashboard",
        "info": "",
        "x": 110,
        "y": 1640,
        "wires": []
    },
    {
        "id": "0c9d08cd9424255c",
        "type": "comment",
        "z": "592b686edd11b813",
        "name": "Recipe Dashboard",
        "info": "",
        "x": 110,
        "y": 80,
        "wires": []
    },
    {
        "id": "a898206a716472e9",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "",
        "mode": "link",
        "links": [
            "85642d7408d49cd8"
        ],
        "x": 295,
        "y": 200,
        "wires": []
    },
    {
        "id": "92026a952d5a807a",
        "type": "comment",
        "z": "592b686edd11b813",
        "name": "Test area",
        "info": "",
        "x": 1100,
        "y": 40,
        "wires": []
    },
    {
        "id": "f14cba79aa9d3c56",
        "type": "ui_date_picker",
        "z": "592b686edd11b813",
        "name": "",
        "label": "From",
        "group": "b96e65c991e4f663",
        "order": 2,
        "width": 10,
        "height": 1,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "x": 110,
        "y": 1760,
        "wires": [
            [
                "081cd5a0f31c258c"
            ]
        ]
    },
    {
        "id": "8909036cd50a1331",
        "type": "ui_date_picker",
        "z": "592b686edd11b813",
        "name": "",
        "label": "To",
        "group": "b96e65c991e4f663",
        "order": 3,
        "width": 10,
        "height": 1,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "x": 110,
        "y": 1800,
        "wires": [
            [
                "550ca7227c50c4c1"
            ]
        ]
    },
    {
        "id": "6a85377603e9249c",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "downsampled data",
        "rules": [
            {
                "t": "set",
                "p": "query",
                "pt": "msg",
                "to": "SELECT * FROM downsampled_temps WHERE time >= 1641945600000000 and time <= now()",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 280,
        "wires": [
            [
                "d34470a9082d1d2b"
            ]
        ]
    },
    {
        "id": "610f4d3f8b61c249",
        "type": "inject",
        "z": "592b686edd11b813",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1110,
        "y": 280,
        "wires": [
            [
                "6a85377603e9249c"
            ]
        ]
    },
    {
        "id": "c65e63dccc35ee06",
        "type": "debug",
        "z": "592b686edd11b813",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1730,
        "y": 260,
        "wires": []
    },
    {
        "id": "081cd5a0f31c258c",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "set from",
        "func": "global.set('kiln_01.dashboard.history_from',msg.payload*1000)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 240,
        "y": 1760,
        "wires": [
            [
                "0874c32ca8bcb2e3"
            ]
        ]
    },
    {
        "id": "550ca7227c50c4c1",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "set to",
        "func": "global.set('kiln_01.dashboard.history_to',msg.payload*1000)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 230,
        "y": 1800,
        "wires": [
            [
                "0874c32ca8bcb2e3"
            ]
        ]
    },
    {
        "id": "0874c32ca8bcb2e3",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "create query",
        "func": "// SELECT * FROM downsampled_temps WHERE time >= 1641945600000000 and time <= now()\n// note: timestamp should be in microseconds format. multiply node-red timestamp by 1000\n\nvar history_from = global.get('kiln_01.dashboard.history_from')\nvar history_to = global.get('kiln_01.dashboard.history_to')\n\nmsg.query = \"SELECT * FROM downsampled_temps WHERE time >= \"+ history_from + \" and time <= \"+ history_to + \" LIMIT 2000\"\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 1780,
        "wires": [
            [
                "a5b1ee57491885ff",
                "f03ea226c20560aa"
            ]
        ]
    },
    {
        "id": "f03ea226c20560aa",
        "type": "debug",
        "z": "592b686edd11b813",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 570,
        "y": 1780,
        "wires": []
    },
    {
        "id": "255d64aa75db5203",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "clear chart",
        "func": "var msg_out = {\"payload\":[{\"series\":[],\"data\":[],\"labels\":[]}]};\n\nvar series_data0 = [];\nvar series_data1 = [];\n\nvar data_array = [];\ndata_array[0] = series_data0\ndata_array[1] = series_data1\n\n// \nmsg_out.payload[0].data = data_array\n\nreturn msg_out;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 670,
        "y": 1720,
        "wires": [
            [
                "2a1f183bb4e05864"
            ]
        ]
    },
    {
        "id": "77121f3416ca897f",
        "type": "inject",
        "z": "592b686edd11b813",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 555,
        "y": 1720,
        "wires": [
            [
                "255d64aa75db5203"
            ]
        ],
        "l": false
    },
    {
        "id": "74140b605a6c3c6b",
        "type": "comment",
        "z": "592b686edd11b813",
        "name": "TODO: this isnt working well",
        "info": "",
        "x": 300,
        "y": 1780,
        "wires": []
    },
    {
        "id": "c8796bffe6a96967",
        "type": "ui_audio",
        "z": "592b686edd11b813",
        "name": "",
        "group": "2201d496820b415d",
        "voice": "com.apple.speech.synthesis.voice.Alex",
        "always": true,
        "x": 420,
        "y": 1500,
        "wires": []
    },
    {
        "id": "5aac6d66af0d0e21",
        "type": "inject",
        "z": "592b686edd11b813",
        "name": "The Kiln is on fire.",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "The Kiln is on fire.",
        "payloadType": "str",
        "x": 150,
        "y": 1500,
        "wires": [
            [
                "c8796bffe6a96967"
            ]
        ]
    },
    {
        "id": "be787bb7f9bb0c5c",
        "type": "comment",
        "z": "592b686edd11b813",
        "name": "announcements",
        "info": "",
        "x": 100,
        "y": 1460,
        "wires": []
    },
    {
        "id": "b1abc1b4bcb481ab",
        "type": "inject",
        "z": "592b686edd11b813",
        "name": "Kiln has entered a hold.",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "Kiln has entered a hold.",
        "payloadType": "str",
        "x": 160,
        "y": 1540,
        "wires": [
            [
                "c8796bffe6a96967"
            ]
        ]
    },
    {
        "id": "e4bb3457a8359d15",
        "type": "inject",
        "z": "592b686edd11b813",
        "name": "Kiln schedule is complete.",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "Kiln schedule is complete.",
        "payloadType": "str",
        "x": 170,
        "y": 1580,
        "wires": [
            [
                "c8796bffe6a96967"
            ]
        ]
    },
    {
        "id": "11c01c157ecfd3ef",
        "type": "comment",
        "z": "592b686edd11b813",
        "name": "Status dashboard",
        "info": "",
        "x": 110,
        "y": 1060,
        "wires": []
    },
    {
        "id": "096ffc209c7be3fb",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "#:(memoryOnly)::schedule_index",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 375,
        "y": 220,
        "wires": [
            [
                "f7a42259283f2fc9"
            ]
        ],
        "l": false
    },
    {
        "id": "c43fe6a6eabba842",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "",
        "mode": "link",
        "links": [
            "b5f8918b49462031",
            "223bca47aa31a4da"
        ],
        "x": 395,
        "y": 580,
        "wires": []
    },
    {
        "id": "b5f8918b49462031",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "",
        "links": [
            "c43fe6a6eabba842"
        ],
        "x": 295,
        "y": 260,
        "wires": [
            [
                "096ffc209c7be3fb",
                "c8f11a608c8dcf6f"
            ]
        ]
    },
    {
        "id": "c8f11a608c8dcf6f",
        "type": "change",
        "z": "592b686edd11b813",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "#:(memoryOnly)::segment_index",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 375,
        "y": 260,
        "wires": [
            [
                "9256680a1dd25943"
            ]
        ],
        "l": false
    },
    {
        "id": "023f6eeca8781228",
        "type": "ui_text_input",
        "z": "592b686edd11b813",
        "name": "",
        "label": "Schedule Name",
        "tooltip": "",
        "group": "5e1bdbab1ef4cbe6",
        "order": 7,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "text",
        "delay": "0",
        "topic": "topic",
        "sendOnBlur": true,
        "className": "",
        "topicType": "msg",
        "x": 500,
        "y": 120,
        "wires": [
            [
                "7d3f232e7739f144"
            ]
        ]
    },
    {
        "id": "7d3f232e7739f144",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "var schedule_index = flow.get('schedule_index', 'memoryOnly');\nvar segment = 'kiln_01.schedules['+ schedule_index.toString() + '].name'\n\nglobal.set(segment, msg.payload);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 615,
        "y": 120,
        "wires": [
            [
                "7ada905b810b30c6"
            ]
        ],
        "l": false
    },
    {
        "id": "223bca47aa31a4da",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "",
        "links": [
            "c43fe6a6eabba842",
            "bbb665c4fceb800d",
            "beee976f9bb8a5fd"
        ],
        "x": 295,
        "y": 120,
        "wires": [
            [
                "7560c351d622b7c2"
            ]
        ]
    },
    {
        "id": "7560c351d622b7c2",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "var schedule_index = flow.get('schedule_index', 'memoryOnly');\nvar name = 'kiln_01.schedules['+ schedule_index.toString() + '].name'\n\nmsg.payload = global.get(name);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 375,
        "y": 120,
        "wires": [
            [
                "023f6eeca8781228"
            ]
        ],
        "l": false
    },
    {
        "id": "f4bb65861a8f2d49",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "get schedule names",
        "func": "var schedules = global.get('kiln_01.schedules')\nvar schedule_names = []\nfor (let index = 0; index < schedules.length; index++) {\n    var name = {}\n    name[schedules[index].name] = index.toString()\n    schedule_names.push(name)\n}\nmsg.options = schedule_names\nreturn msg;\n\n/*\n[\n    {\n        \"schedule 1\": \"0\"\n    },\n    {\n        \"schedule 2\": \"1\"\n    }\n\n]\n[\n    {\n        \"Cone 04 Bisque\":\"0\"\n    },\n    {\n        \"Cone 6 Glaze\":\"1\"\n    }\n]\n*/",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 235,
        "y": 240,
        "wires": [
            [
                "a898206a716472e9",
                "096ffc209c7be3fb"
            ]
        ],
        "l": false
    },
    {
        "id": "d72368991af180f7",
        "type": "ui_button",
        "z": "592b686edd11b813",
        "d": true,
        "name": "new schedule",
        "group": "5e1bdbab1ef4cbe6",
        "order": 2,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "New",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 520,
        "y": 440,
        "wires": [
            [
                "63dcf2f8335202df"
            ]
        ]
    },
    {
        "id": "63dcf2f8335202df",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "var schedules = global.get('kiln_01.schedules')\nvar segment = {name:\"new segment\",enabled:true,hold:false,setpoint:0,ramp_rate:0,soak_time:0}\n//var segment = Object.create(obj)\nvar segments = []\nsegments.push(segment)\nvar schedule = {name:\"new schedule\", segments}\n//var schedule = Object.create(obj2)\nschedules.push(schedule)\nglobal.set('kiln_01.schedules', schedules)\n\nflow.set('schedule_index', schedules.length - 1, 'memoryOnly');\n//msg.payload = schedules.length - 1 //  this should make the schedules dropdown go to this new schedule\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 635,
        "y": 440,
        "wires": [
            [
                "beee976f9bb8a5fd"
            ]
        ],
        "l": false
    },
    {
        "id": "8ffc6beb541bf7e0",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "var schedule_index = flow.get('schedule_index', 'memoryOnly');\nvar schedule = 'kiln_01.schedules['+ schedule_index.toString() + ']'\n\nglobal.set(schedule, undefined);\n\nflow.set('schedule_index', 0, 'memoryOnly');\n//msg.payload = 0 // send this so the drop down menu goes back to index 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 635,
        "y": 480,
        "wires": [
            [
                "beee976f9bb8a5fd"
            ]
        ],
        "l": false
    },
    {
        "id": "b14e70c4caa1f3f5",
        "type": "ui_button",
        "z": "592b686edd11b813",
        "d": true,
        "name": "delete schedule",
        "group": "5e1bdbab1ef4cbe6",
        "order": 3,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Delete",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 520,
        "y": 480,
        "wires": [
            [
                "8ffc6beb541bf7e0"
            ]
        ]
    },
    {
        "id": "beee976f9bb8a5fd",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "",
        "mode": "link",
        "links": [
            "af271e715f494e25",
            "006321a7d5098eed",
            "223bca47aa31a4da"
        ],
        "x": 725,
        "y": 460,
        "wires": []
    },
    {
        "id": "af271e715f494e25",
        "type": "link in",
        "z": "592b686edd11b813",
        "name": "",
        "links": [
            "beee976f9bb8a5fd",
            "7ada905b810b30c6"
        ],
        "x": 135,
        "y": 280,
        "wires": [
            [
                "f4bb65861a8f2d49"
            ]
        ]
    },
    {
        "id": "7ada905b810b30c6",
        "type": "link out",
        "z": "592b686edd11b813",
        "name": "",
        "mode": "link",
        "links": [
            "af271e715f494e25"
        ],
        "x": 685,
        "y": 120,
        "wires": []
    },
    {
        "id": "8dfa5897ec9ede7f",
        "type": "ui_button",
        "z": "592b686edd11b813",
        "d": true,
        "name": "new segment",
        "group": "5e1bdbab1ef4cbe6",
        "order": 5,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "New",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 520,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "61684fbcc4722255",
        "type": "function",
        "z": "592b686edd11b813",
        "name": "",
        "func": "var schedules = global.get('kiln_01.schedules')\nvar segment = {name:\"new segment\",enabled:true,hold:false,setpoint:0,ramp_rate:0,soak_time:0}\n//var segment = Object.create(obj)\nvar segments = []\nsegments.push(segment)\nvar schedule = {name:\"new schedule\", segments}\n//var schedule = Object.create(obj2)\nschedules.push(schedule)\nglobal.set('kiln_01.schedules', schedules)\n\nflow.set('schedule_index', schedules.length - 1, 'memoryOnly');\n//msg.payload = schedules.length - 1 //  this should make the schedules dropdown go to this new schedule\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 635,
        "y": 520,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "0f56f86bd83c9233",
        "type": "finite-state-machine",
        "z": "e9cef8706a9cf7f6",
        "name": "Schedule",
        "fsmDefinition": "{\"state\":{\"status\":\"IDLE\",\"data\":{\"x\":99}},\"transitions\":{\"IDLE\":{\"run\":{\"status\":\"RUNNING\"},\"end\":{\"status\":\"IDLE\"}},\"STOPPING\":{\"end\":{\"status\":\"IDLE\"}},\"RUNNING\":{\"stop\":{\"status\":\"STOPPING\"}}}}",
        "sendInitialState": true,
        "sendStateWithoutChange": true,
        "showTransitionErrors": true,
        "x": 260,
        "y": 180,
        "wires": [
            [
                "2fc3804edce15c2a",
                "69c087d9cb1a75f4",
                "84a2b0552ff4b157"
            ]
        ]
    },
    {
        "id": "04a3129b472d39fb",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "https://github.com/lutzer/node-red-contrib-finite-statemachine/blob/master/MANUAL.md",
        "info": "",
        "x": 350,
        "y": 480,
        "wires": []
    },
    {
        "id": "9001b19272cdde7c",
        "type": "catch",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 60,
        "y": 20,
        "wires": [
            [
                "82c478cdd58a5695"
            ]
        ]
    },
    {
        "id": "82c478cdd58a5695",
        "type": "debug",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 190,
        "y": 20,
        "wires": []
    },
    {
        "id": "fd8e3125439d8507",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "https://www.npmjs.com/package/javascript-state-machine",
        "info": "",
        "x": 250,
        "y": 560,
        "wires": []
    },
    {
        "id": "6f7c5ec76b48cc9b",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "https://flows.nodered.org/node/node-red-contrib-finite-statemachine",
        "info": "",
        "x": 290,
        "y": 520,
        "wires": []
    },
    {
        "id": "b92a5a9283774411",
        "type": "finite-state-machine",
        "z": "e9cef8706a9cf7f6",
        "name": "Segment",
        "fsmDefinition": "{\"state\":{\"status\":\"IDLE\",\"data\":{\"segment_data\":{\"elapsed_time\":0,\"max_temperature\":0},\"segment_settings\":{\"name\":\"\",\"enabled\":true,\"hold\":false,\"setpoint\":0,\"ramp_rate\":0,\"soak_time\":0}}},\"transitions\":{\"IDLE\":{\"end\":\"IDLE\",\"init\":\"INITIALIZING\",\"set\":\"IDLE\"},\"INITIALIZING\":{\"ramp\":\"RAMPING\",\"end\":\"IDLE\",\"set\":\"INITIALIZING\"},\"RAMPING\":{\"soak\":\"SOAKING\",\"hold\":\"HOLDING\",\"init\":\"INITIALIZING\",\"end\":\"IDLE\",\"set\":\"RAMPING\"},\"SOAKING\":{\"hold\":\"HOLDING\",\"ramp\":\"RAMPING\",\"init\":\"INITIALIZING\",\"end\":\"IDLE\",\"set\":\"SOAKING\"},\"HOLDING\":{\"ramp\":\"RAMPING\",\"init\":\"INITIALIZING\",\"end\":\"IDLE\",\"set\":\"HOLDING\"}}}",
        "sendInitialState": true,
        "sendStateWithoutChange": true,
        "showTransitionErrors": true,
        "x": 260,
        "y": 700,
        "wires": [
            [
                "4df2a1d5facc0bfb",
                "f3bfd11d3b3fad40",
                "2eb008bbf30d2804",
                "c214fb80818d8c8f",
                "6c6e56db4e40ac7d",
                "a846cb12c824f26b"
            ]
        ]
    },
    {
        "id": "defcc28b265151c2",
        "type": "link in",
        "z": "e9cef8706a9cf7f6",
        "name": "Input - Control Buttons",
        "links": [
            "c03c7fb7458a9e9f"
        ],
        "x": 155,
        "y": 340,
        "wires": [
            [
                "334e3822e1c7c5ac"
            ]
        ]
    },
    {
        "id": "fb11495e37bdb84b",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "Output - Current Segment State",
        "mode": "link",
        "links": [
            "8095bbd934bc130c"
        ],
        "x": 475,
        "y": 720,
        "wires": []
    },
    {
        "id": "b33e0726c17b668b",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "Output - Current Schedule State",
        "mode": "link",
        "links": [
            "44901a155449dc95"
        ],
        "x": 455,
        "y": 140,
        "wires": []
    },
    {
        "id": "4df2a1d5facc0bfb",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "segment_settings",
                "pt": "msg",
                "to": "payload.data.segment_settings",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.status",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 415,
        "y": 720,
        "wires": [
            [
                "fb11495e37bdb84b"
            ]
        ],
        "l": false
    },
    {
        "id": "2fc3804edce15c2a",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.status",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 395,
        "y": 140,
        "wires": [
            [
                "b33e0726c17b668b"
            ]
        ],
        "l": false
    },
    {
        "id": "334e3822e1c7c5ac",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Start",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Stop",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 215,
        "y": 340,
        "wires": [
            [
                "1ed2d6a8bc75d663"
            ],
            [
                "0d25f4bbb98a1706"
            ]
        ],
        "l": false
    },
    {
        "id": "1ed2d6a8bc75d663",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "run",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "run",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 275,
        "y": 320,
        "wires": [
            [
                "819aacf3762935b7"
            ]
        ],
        "l": false
    },
    {
        "id": "0d25f4bbb98a1706",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "stop",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "stop",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 275,
        "y": 360,
        "wires": [
            [
                "819aacf3762935b7"
            ]
        ],
        "l": false
    },
    {
        "id": "6a57983382d3490e",
        "type": "link in",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "links": [
            "819aacf3762935b7",
            "c96334b38e278286",
            "af8f2e69ea9f27c2"
        ],
        "x": 155,
        "y": 180,
        "wires": [
            [
                "0f56f86bd83c9233"
            ]
        ]
    },
    {
        "id": "819aacf3762935b7",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "6a57983382d3490e"
        ],
        "x": 355,
        "y": 340,
        "wires": []
    },
    {
        "id": "81fb9a528731184e",
        "type": "link in",
        "z": "e9cef8706a9cf7f6",
        "name": "Input - Control Buttons",
        "links": [
            "c03c7fb7458a9e9f"
        ],
        "x": 155,
        "y": 860,
        "wires": [
            [
                "5b4645244b57514e"
            ]
        ]
    },
    {
        "id": "5b4645244b57514e",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Release",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Advance",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Hold",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 215,
        "y": 860,
        "wires": [
            [
                "12bfd2f54cfcaae9"
            ],
            [
                "12bfd2f54cfcaae9"
            ],
            [
                "e5d4e9ed610e164f"
            ]
        ],
        "l": false
    },
    {
        "id": "fdfa744fcee6a3dd",
        "type": "link in",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "links": [
            "338986178aea2e9e",
            "2e45cc4d57a385c0",
            "edb935f4183746b0",
            "7ab1dfdba11abf46",
            "5b05096dea13f2c2",
            "94a351c8d74cd63c",
            "20db894294ad2264",
            "48e55a20a9c39344"
        ],
        "x": 155,
        "y": 700,
        "wires": [
            [
                "b92a5a9283774411"
            ]
        ]
    },
    {
        "id": "84a2b0552ff4b157",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "STOPPING",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "STARTING",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "RUNNING",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "IDLE",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 4,
        "x": 395,
        "y": 220,
        "wires": [
            [
                "6348c0ed609dce8b"
            ],
            [],
            [
                "0c385503f68c2897",
                "2d50278b266fca54"
            ],
            [
                "04cf21296804ae19",
                "b692ebb29e65c022"
            ]
        ],
        "l": false
    },
    {
        "id": "c214fb80818d8c8f",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "IDLE",
                "vt": "str"
            },
            {
                "t": "neq",
                "v": "IDLE",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "INITIALIZING",
                "vt": "str"
            },
            {
                "t": "neq",
                "v": "INITIALIZING",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 4,
        "x": 475,
        "y": 660,
        "wires": [
            [
                "26a5dc0ca7be4550"
            ],
            [],
            [
                "d73d6c1dd682f172"
            ],
            []
        ],
        "l": false
    },
    {
        "id": "edb935f4183746b0",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "fdfa744fcee6a3dd",
            "c70cd7dd26e8bb29"
        ],
        "x": 715,
        "y": 220,
        "wires": []
    },
    {
        "id": "0c385503f68c2897",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "set segment settings and start segment ramp",
        "func": "\nvar active_schedule_index = global.get('kiln_01.active_schedule_index');\nvar active_schedule = global.get('kiln_01.schedules['+ active_schedule_index + ']')\nglobal.set('kiln_01.active_schedule', active_schedule);\n\nvar topic = \"init\"\nvar segment_settings = global.get('kiln_01.active_schedule.segments[0]')\nvar data = {segment_settings}\n\nvar msg_out = {topic,data}\n\nglobal.set('kiln_01.active_segment_index', 0)\n\nreturn msg_out;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 495,
        "y": 220,
        "wires": [
            [
                "edb935f4183746b0"
            ]
        ],
        "l": false
    },
    {
        "id": "f3bfd11d3b3fad40",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.data.segment_settings.setpoint",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "#:(memoryOnly)::kiln_01.Setpoint",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 415,
        "y": 740,
        "wires": [
            [
                "edf985d2d969c4b4"
            ]
        ],
        "l": false
    },
    {
        "id": "edf985d2d969c4b4",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "a8bc30bb3ce76d5e"
        ],
        "x": 475,
        "y": 740,
        "wires": []
    },
    {
        "id": "b209d1c9da6cb3c2",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "end and clear segment settings",
        "func": "global.set('kiln_01.UpperSetpoint', 0, 'memoryOnly')\nglobal.set('kiln_01.LowerSetpoint', 0, 'memoryOnly')\n\nvar topic = \"end\"\nvar segment_settings = {\"name\":\"\",\"enabled\":false,\"hold\":false,\"setpoint\":0,\"ramp_rate\":0,\"soak_time\":0}\nvar data = {segment_settings}\n\nvar msg_out = {topic,data}\n\nreturn msg_out;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 655,
        "y": 200,
        "wires": [
            [
                "edb935f4183746b0"
            ]
        ],
        "l": false
    },
    {
        "id": "2d50278b266fca54",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "disable the schedule selection when running",
        "rules": [
            {
                "t": "set",
                "p": "enabled",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "kiln_01.active_schedule_index",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 495,
        "y": 240,
        "wires": [
            [
                "7b896f97e70ee242"
            ]
        ],
        "l": false
    },
    {
        "id": "04cf21296804ae19",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "enable the schedule selection when idle",
        "rules": [
            {
                "t": "set",
                "p": "enabled",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "kiln_01.active_schedule_index",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 495,
        "y": 260,
        "wires": [
            [
                "7b896f97e70ee242"
            ]
        ],
        "l": false
    },
    {
        "id": "7b896f97e70ee242",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "Output - enable/disable schedule selection",
        "mode": "link",
        "links": [
            "85642d7408d49cd8"
        ],
        "x": 575,
        "y": 260,
        "wires": []
    },
    {
        "id": "585e8b1656cbef91",
        "type": "trigger",
        "z": "e9cef8706a9cf7f6",
        "name": "Monitor temperature",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-1000",
        "extend": false,
        "overrideDelay": true,
        "units": "ms",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 955,
        "y": 620,
        "wires": [
            [
                "6cfcbd486aa01dca",
                "6621e559cca764ed"
            ]
        ],
        "l": false
    },
    {
        "id": "2293ffac501997ba",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "Reset trigger",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 815,
        "y": 620,
        "wires": [
            [
                "585e8b1656cbef91"
            ]
        ],
        "l": false
    },
    {
        "id": "7ab1dfdba11abf46",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "fdfa744fcee6a3dd"
        ],
        "x": 1135,
        "y": 840,
        "wires": []
    },
    {
        "id": "ec192310dbd48cdd",
        "type": "link in",
        "z": "e9cef8706a9cf7f6",
        "name": "stop or advance",
        "links": [
            "12bfd2f54cfcaae9",
            "d30ec35d1e580d54",
            "4205218abe56d8f3"
        ],
        "x": 1015,
        "y": 820,
        "wires": [
            [
                "b17e75bc51a86d9f"
            ]
        ]
    },
    {
        "id": "12bfd2f54cfcaae9",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "ec192310dbd48cdd"
        ],
        "x": 295,
        "y": 840,
        "wires": []
    },
    {
        "id": "c96334b38e278286",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "4840d3b8dd483cff",
            "53681c7211103452",
            "6a57983382d3490e"
        ],
        "x": 1135,
        "y": 800,
        "wires": []
    },
    {
        "id": "73d963005cc1351a",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "disable the release button",
        "rules": [
            {
                "t": "set",
                "p": "enabled",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 815,
        "y": 840,
        "wires": [
            [
                "f59050e178b63b1a"
            ]
        ],
        "l": false
    },
    {
        "id": "717c700de0abd324",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "enable the release button",
        "rules": [
            {
                "t": "set",
                "p": "enabled",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 815,
        "y": 800,
        "wires": [
            [
                "f59050e178b63b1a"
            ]
        ],
        "l": false
    },
    {
        "id": "f59050e178b63b1a",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "Output - enable/disable release button",
        "mode": "link",
        "links": [
            "87d7118f46499bc1"
        ],
        "x": 895,
        "y": 820,
        "wires": []
    },
    {
        "id": "b17e75bc51a86d9f",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "stop schedule or advance",
        "func": "var UpperTemperature = global.get('kiln_01.UpperTemperature', 'memoryOnly')\nvar LowerTemperature = global.get('kiln_01.LowerTemperature', 'memoryOnly')\nvar Setpoint = global.get('kiln_01.Setpoint', 'memoryOnly')\nvar UpperSetpoint = global.get('kiln_01.UpperSetpoint', 'memoryOnly')\nvar LowerSetpoint = global.get('kiln_01.LowerSetpoint', 'memoryOnly')\nvar RampDirection = global.get('kiln_01.RampDirection', 'memoryOnly')\nvar active_schedule = global.get('kiln_01.active_schedule')\nvar segment_count = active_schedule.segments.length\nvar active_segment_index = global.get('kiln_01.active_segment_index')\nvar topic\nvar payload\nvar segment_settings\nvar data\nvar msg_out\nvar temps_at_setpoint = global.get('kiln_01.SetpointReached', 'memoryOnly')\n//var tolerance = 20 // degrees\n//var temps_at_setpoint =  (RampDirection == 'Increasing' && UpperTemperature >= (Setpoint - tolerance) && LowerTemperature >= (Setpoint - tolerance)) \n//                        ||(RampDirection == 'Decreasing' && UpperTemperature <= (Setpoint + tolerance) && LowerTemperature <= (Setpoint + tolerance))\n\n// check if temps have been reached or advance is commanded\nif ((temps_at_setpoint && msg.payload == 'Release') ||\n    msg.payload == 'Advance'){\n\n    if (segment_count - 1 > active_segment_index) {\n        // advance to next segment\n        active_segment_index = active_segment_index + 1\n        global.set('kiln_01.active_segment_index', active_segment_index)\n        segment_settings = active_schedule.segments[active_segment_index]\n        data = {segment_settings}\n        topic = \"init\"\n        msg_out = {topic,data}\n        return [null,msg_out]\n    } else {\n        // end the schedule\n        topic = \"stop\"\n        payload = 0 // this will go to PID setpoints\n        msg_out = {topic, payload}\n        return [msg_out,null]\n    }\n    \n} else { // continue and try to reach temps\n    topic = \"ramp\"\n    msg_out = {topic}\n    return [null,msg_out]\n}",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1075,
        "y": 820,
        "wires": [
            [
                "c96334b38e278286"
            ],
            [
                "7ab1dfdba11abf46"
            ]
        ],
        "l": false
    },
    {
        "id": "f1169a5a0d122c16",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "check segment enabled",
        "property": "payload.data.segment_settings.enabled",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 815,
        "y": 660,
        "wires": [
            [
                "024377df3ae20b3c"
            ],
            [
                "14cf0c63e8349ec6"
            ]
        ],
        "l": false
    },
    {
        "id": "3ab377921817af3f",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "Output - active segment",
        "mode": "link",
        "links": [
            "1d2a7e1b14ed985d"
        ],
        "x": 475,
        "y": 760,
        "wires": []
    },
    {
        "id": "09fb86f278b3d8bb",
        "type": "delay",
        "z": "e9cef8706a9cf7f6",
        "name": "Soak Timer",
        "pauseType": "delayv",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 550,
        "y": 1440,
        "wires": [
            [
                "e3d6a327375e4f52"
            ]
        ]
    },
    {
        "id": "e3d6a327375e4f52",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "done",
        "property": "remaining_milliseconds",
        "propertyType": "msg",
        "rules": [
            {
                "t": "lte",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "gt",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 690,
        "y": 1440,
        "wires": [
            [
                "fa143e9381f1e1bd",
                "08c074c12dcb6141"
            ],
            [
                "09b4d93def762a30"
            ]
        ]
    },
    {
        "id": "09b4d93def762a30",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "status",
        "func": "var time\n\nif (!msg.reset){\n    msg.remaining_milliseconds = msg.remaining_milliseconds - 1000\n    if (msg.remaining_milliseconds <= 0) {\n        msg.delay = 0;\n        msg.flush = true;\n    }\n} else {\n    msg.remaining_milliseconds = 0\n}\n\ntime = { minutes: msg.remaining_milliseconds / 1000.0 / 60.0, seconds: msg.remaining_milliseconds / 1000.0, milliseconds: msg.remaining_milliseconds };\ntime.minutes = time.minutes.toFixed(2);\ntime.seconds = time.seconds.toFixed(2);\ntime.milliseconds = time.milliseconds.toFixed(2);\n\nif (time.milliseconds >= 0){\n    return [msg,time];\n} else {\n    return [msg,null];\n}",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 530,
        "y": 1500,
        "wires": [
            [
                "09fb86f278b3d8bb"
            ],
            [
                "b67b488fb3853a42",
                "b90c962fa16f8039"
            ]
        ]
    },
    {
        "id": "b67b488fb3853a42",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "Output - Remaining soak time",
        "mode": "link",
        "links": [],
        "x": 635,
        "y": 1500,
        "wires": []
    },
    {
        "id": "2eb008bbf30d2804",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "show active segment",
        "func": "var active_schedule = global.get('kiln_01.active_schedule')\nvar segment_count = active_schedule.segments.length\nvar active_segment_index = global.get('kiln_01.active_segment_index')\nactive_segment_index++\n\nif (msg.payload.status === 'IDLE') {\n    msg.payload = '0 of ' + segment_count.toString()\n} else {\n    msg.payload = active_segment_index.toString() + ' of ' + segment_count.toString()\n}\n\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 415,
        "y": 760,
        "wires": [
            [
                "3ab377921817af3f"
            ]
        ],
        "l": false
    },
    {
        "id": "6b27feab56b1402a",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "reset",
        "rules": [
            {
                "t": "set",
                "p": "remaining_milliseconds",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 370,
        "y": 1500,
        "wires": [
            [
                "09b4d93def762a30"
            ]
        ]
    },
    {
        "id": "26a5dc0ca7be4550",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "end",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "end",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 555,
        "y": 640,
        "wires": [
            [
                "af8f2e69ea9f27c2"
            ]
        ],
        "l": false
    },
    {
        "id": "6348c0ed609dce8b",
        "type": "trigger",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "-250",
        "extend": false,
        "overrideDelay": false,
        "units": "ms",
        "reset": "IDLE",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 595,
        "y": 200,
        "wires": [
            [
                "b209d1c9da6cb3c2"
            ]
        ],
        "l": false
    },
    {
        "id": "af8f2e69ea9f27c2",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "4840d3b8dd483cff",
            "53681c7211103452",
            "6a57983382d3490e"
        ],
        "x": 615,
        "y": 640,
        "wires": []
    },
    {
        "id": "0afd5835b34c3f7e",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "check soak",
        "func": "var SoakTime = msg.payload.data.segment_settings.soak_time\n\nif (SoakTime > 0) {\n    msg.delay = SoakTime * 1000 * 60 // convert min to milliseconds\n    msg.topic = \"soak\"\n    return [null,msg];\n} else {\n    return [msg,null];\n}",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 960,
        "wires": [
            [
                "93a841c73beae51f"
            ],
            [
                "5e52028c66e776b3"
            ]
        ],
        "outputLabels": [
            "advance",
            "soak"
        ],
        "l": false
    },
    {
        "id": "fa143e9381f1e1bd",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "done",
        "mode": "link",
        "links": [],
        "x": 795,
        "y": 1440,
        "wires": []
    },
    {
        "id": "6cfcbd486aa01dca",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "check temps and start soak",
        "func": "var UpperTemperature = global.get('kiln_01.UpperTemperature', 'memoryOnly')\nvar LowerTemperature = global.get('kiln_01.LowerTemperature', 'memoryOnly')\nvar Setpoint = global.get('kiln_01.Setpoint', 'memoryOnly')\nvar UpperSetpoint = global.get('kiln_01.UpperSetpoint', 'memoryOnly')\nvar LowerSetpoint = global.get('kiln_01.LowerSetpoint', 'memoryOnly')\nvar RampDirection = global.get('kiln_01.RampDirection', 'memoryOnly')\nvar RampRate = msg.payload.data.segment_settings.ramp_rate // per hour\nvar DeltaTime = 1000.0 / (1000.0 * 60.0 * 60.0) // the pulse timer is set for 1000ms. how many 1000 ms in 1 hour?\nvar DeltaTemp = DeltaTime * RampRate\nvar Tolerance = 5 // degrees\nvar MaxTempDiff = 10.0\n\n// ramp the setpoints\nif (RampDirection == 'Increasing') {\n    if (UpperSetpoint < Setpoint \n        && UpperSetpoint - UpperTemperature < MaxTempDiff \n        && LowerSetpoint - LowerTemperature < MaxTempDiff) {\n        UpperSetpoint = UpperSetpoint + DeltaTemp;\n        LowerSetpoint = UpperSetpoint;\n    }\n    //if (LowerSetpoint < Setpoint && LowerSetpoint - LowerTemperature < MaxTempDiff) LowerSetpoint = LowerSetpoint + DeltaTemp;\n} else if (RampDirection == 'Decreasing') {\n    if (UpperSetpoint > Setpoint \n        && UpperTemperature - UpperSetpoint < MaxTempDiff \n        && LowerTemperature - LowerSetpoint < MaxTempDiff) {\n        UpperSetpoint = UpperSetpoint - DeltaTemp;\n        LowerSetpoint = UpperSetpoint;\n    }\n    //if (LowerSetpoint > Setpoint && LowerTemperature - LowerSetpoint < MaxTempDiff) LowerSetpoint = LowerSetpoint - DeltaTemp;\n} else {\n    // uh oh...\n}\nglobal.set('kiln_01.UpperSetpoint',UpperSetpoint, 'memoryOnly')\nglobal.set('kiln_01.LowerSetpoint',LowerSetpoint, 'memoryOnly')\n\nvar msg1 = { payload: UpperSetpoint }\nvar msg2 = { payload: LowerSetpoint }\n\n// check if temps have been reached\n// TODO: add a confidence timer here to filter out spikes in temp\nif ((RampDirection == 'Increasing' \n    && UpperTemperature >= (Setpoint - Tolerance) \n    && LowerTemperature >= (Setpoint - Tolerance)) || \n    (RampDirection == 'Decreasing' \n    && UpperTemperature <= (Setpoint + Tolerance) \n    && LowerTemperature <= (Setpoint + Tolerance))){\n        global.set('kiln_01.SetpointReached', true, 'memoryOnly')\n        msg.topic = 'soak'\n        return [msg1, msg2, msg];\n} else {\n    return [msg1, msg2, null];\n}",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1035,
        "y": 620,
        "wires": [
            [
                "9715dba2fc1ab553"
            ],
            [
                "6f66fd670975be35"
            ],
            [
                "20db894294ad2264"
            ]
        ],
        "l": false
    },
    {
        "id": "024377df3ae20b3c",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "set ramp direction",
        "func": "var UpperTemperature = global.get('kiln_01.UpperTemperature', 'memoryOnly')\nvar LowerTemperature = global.get('kiln_01.LowerTemperature', 'memoryOnly')\nvar AverageTemperature = (UpperTemperature + LowerTemperature) / 2.0\nvar Setpoint = global.get('kiln_01.Setpoint', 'memoryOnly')\n//var UpperSetpoint = global.get('kiln_01.UpperSetpoint', 'memoryOnly')\n//var LowerSetpoint = global.get('kiln_01.LowerSetpoint', 'memoryOnly')\n\n// determine ramping direction\nif (AverageTemperature > Setpoint) {\n    global.set('kiln_01.RampDirection', 'Decreasing', 'memoryOnly')\n} else {\n    global.set('kiln_01.RampDirection', 'Increasing', 'memoryOnly')\n}\n\n// seed the starting temperature\nglobal.set('kiln_01.UpperSetpoint',UpperTemperature, 'memoryOnly')\nglobal.set('kiln_01.LowerSetpoint',LowerTemperature, 'memoryOnly')\n\nglobal.set('kiln_01.SetpointReached', false, 'memoryOnly')\n\nmsg.delay = 1000 // set duration between ramp calculations\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 875,
        "y": 640,
        "wires": [
            [
                "585e8b1656cbef91"
            ]
        ],
        "l": false
    },
    {
        "id": "cc0f47bb7c2fcf67",
        "type": "inject",
        "z": "e9cef8706a9cf7f6",
        "name": "oneshot on startup",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "x": 430,
        "y": 40,
        "wires": [
            [
                "6202fbcb0c1e1b73"
            ]
        ]
    },
    {
        "id": "6202fbcb0c1e1b73",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "set active schedule",
        "rules": [
            {
                "t": "set",
                "p": "kiln_01.active_schedule",
                "pt": "global",
                "to": "kiln_01.schedules[0]",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 630,
        "y": 40,
        "wires": [
            []
        ]
    },
    {
        "id": "93a841c73beae51f",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "check hold",
        "func": "var HoldEnabled = msg.payload.data.segment_settings.hold\n\nif (HoldEnabled) {\n    msg.topic = 'hold';\n    return [null,msg];\n} else {\n    msg.payload = 'Advance'\n    return [msg,null];\n}",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1095,
        "y": 960,
        "wires": [
            [
                "4205218abe56d8f3"
            ],
            [
                "48e55a20a9c39344"
            ]
        ],
        "outputLabels": [
            "advance",
            "hold"
        ],
        "l": false
    },
    {
        "id": "d73d6c1dd682f172",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "ramp",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "ramp",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 555,
        "y": 680,
        "wires": [
            [
                "5b05096dea13f2c2"
            ]
        ],
        "l": false
    },
    {
        "id": "5b05096dea13f2c2",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "fdfa744fcee6a3dd"
        ],
        "x": 615,
        "y": 680,
        "wires": []
    },
    {
        "id": "e5d4e9ed610e164f",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "hold",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "hold",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 295,
        "y": 880,
        "wires": [
            [
                "94a351c8d74cd63c"
            ]
        ],
        "l": false
    },
    {
        "id": "94a351c8d74cd63c",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "fdfa744fcee6a3dd"
        ],
        "x": 355,
        "y": 880,
        "wires": []
    },
    {
        "id": "c70cd7dd26e8bb29",
        "type": "link in",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "links": [
            "edb935f4183746b0"
        ],
        "x": 675,
        "y": 300,
        "wires": [
            [
                "dc2c386dedaeed7e"
            ]
        ]
    },
    {
        "id": "dc2c386dedaeed7e",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "get ramp rate",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.data.segment_settings.ramp_rate",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 735,
        "y": 300,
        "wires": [
            [
                "233d081ef7b67749"
            ]
        ],
        "l": false
    },
    {
        "id": "233d081ef7b67749",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "Output - ramp rate",
        "mode": "link",
        "links": [
            "899c85f172cb1839"
        ],
        "x": 795,
        "y": 300,
        "wires": []
    },
    {
        "id": "e2406de38b14e0d9",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "custom timer with status output",
        "info": "",
        "x": 550,
        "y": 1540,
        "wires": []
    },
    {
        "id": "a4e1c63f7192b11c",
        "type": "inject",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "soak",
        "payload": "10000",
        "payloadType": "num",
        "x": 230,
        "y": 1440,
        "wires": [
            [
                "6580da1466ddcdf1"
            ]
        ]
    },
    {
        "id": "968607645a8d7068",
        "type": "inject",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 275,
        "y": 1500,
        "wires": [
            [
                "6b27feab56b1402a"
            ]
        ],
        "l": false
    },
    {
        "id": "08c074c12dcb6141",
        "type": "debug",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 800,
        "y": 1360,
        "wires": []
    },
    {
        "id": "b90c962fa16f8039",
        "type": "debug",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 750,
        "y": 1520,
        "wires": []
    },
    {
        "id": "cf4a3d91ef7eb56e",
        "type": "inject",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "ramp",
        "payload": "5000",
        "payloadType": "num",
        "x": 220,
        "y": 1400,
        "wires": [
            [
                "6580da1466ddcdf1"
            ]
        ]
    },
    {
        "id": "be296861cf96f889",
        "type": "delay",
        "z": "e9cef8706a9cf7f6",
        "name": "Soak Timer",
        "pauseType": "delayv",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 975,
        "y": 980,
        "wires": [
            [
                "b2be957b0b8f3b28"
            ]
        ],
        "l": false
    },
    {
        "id": "b2be957b0b8f3b28",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "done",
        "property": "remaining_milliseconds",
        "propertyType": "msg",
        "rules": [
            {
                "t": "lte",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "gt",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1035,
        "y": 980,
        "wires": [
            [
                "93a841c73beae51f"
            ],
            [
                "57da66cbb8664644"
            ]
        ],
        "l": false
    },
    {
        "id": "57da66cbb8664644",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "status",
        "func": "var time\n\nif (!msg.reset){\n    msg.remaining_milliseconds = msg.remaining_milliseconds - 1000\n    if (msg.remaining_milliseconds <= 0) {\n        msg.delay = 0;\n        msg.flush = true;\n    }\n} else {\n    msg.remaining_milliseconds = 0\n}\n\ntime = { minutes: msg.remaining_milliseconds / 1000.0 / 60.0, seconds: msg.remaining_milliseconds / 1000.0, milliseconds: msg.remaining_milliseconds };\ntime.minutes = time.minutes.toFixed(2);\ntime.seconds = time.seconds.toFixed(2);\ntime.milliseconds = time.milliseconds.toFixed(2);\n\nif (time.milliseconds >= 0){\n    return [msg,time];\n} else {\n    return [msg,null];\n}",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 975,
        "y": 1040,
        "wires": [
            [
                "be296861cf96f889"
            ],
            [
                "dbbb8ea68ee4121f"
            ]
        ],
        "l": false
    },
    {
        "id": "5e52028c66e776b3",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "start",
        "rules": [
            {
                "t": "set",
                "p": "remaining_milliseconds",
                "pt": "msg",
                "to": "delay",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "1000",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 895,
        "y": 980,
        "wires": [
            [
                "be296861cf96f889"
            ]
        ],
        "l": false
    },
    {
        "id": "b79bc4ea4760e612",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "reset",
        "rules": [
            {
                "t": "set",
                "p": "remaining_milliseconds",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 895,
        "y": 1040,
        "wires": [
            [
                "57da66cbb8664644"
            ]
        ],
        "l": false
    },
    {
        "id": "cb32bc877d76c6f3",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "custom timer with status output",
        "info": "",
        "x": 990,
        "y": 1100,
        "wires": []
    },
    {
        "id": "dbbb8ea68ee4121f",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "send minutes",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "minutes",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1055,
        "y": 1040,
        "wires": [
            [
                "f1d4774590c51f3d"
            ]
        ],
        "l": false
    },
    {
        "id": "f1d4774590c51f3d",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "status",
        "mode": "link",
        "links": [
            "bc808949af0e238a"
        ],
        "x": 1115,
        "y": 1040,
        "wires": []
    },
    {
        "id": "6580da1466ddcdf1",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "start",
        "rules": [
            {
                "t": "set",
                "p": "remaining_milliseconds",
                "pt": "msg",
                "to": "delay",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "1000",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 390,
        "y": 1440,
        "wires": [
            [
                "09fb86f278b3d8bb"
            ]
        ]
    },
    {
        "id": "9715dba2fc1ab553",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "53681c7211103452"
        ],
        "x": 1095,
        "y": 600,
        "wires": []
    },
    {
        "id": "6f66fd670975be35",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "4840d3b8dd483cff"
        ],
        "x": 1095,
        "y": 620,
        "wires": []
    },
    {
        "id": "69c087d9cb1a75f4",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "func": "if (msg.topic == 'state') {\n    global.set('kiln_01.FsmStatus_Schedule', msg.payload.status, 'memoryOnly')\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 395,
        "y": 160,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "6c6e56db4e40ac7d",
        "type": "function",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "func": "if (msg.topic == 'state') {\n    global.set('kiln_01.FsmStatus_Segment', msg.payload.status, 'memoryOnly')\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 415,
        "y": 780,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "20db894294ad2264",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "fdfa744fcee6a3dd"
        ],
        "x": 1095,
        "y": 640,
        "wires": []
    },
    {
        "id": "48e55a20a9c39344",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "fdfa744fcee6a3dd"
        ],
        "x": 1155,
        "y": 980,
        "wires": []
    },
    {
        "id": "d30ec35d1e580d54",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "ec192310dbd48cdd"
        ],
        "x": 935,
        "y": 680,
        "wires": []
    },
    {
        "id": "4205218abe56d8f3",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "ec192310dbd48cdd"
        ],
        "x": 1155,
        "y": 940,
        "wires": []
    },
    {
        "id": "a2e12771c467bedb",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "SOAKING",
                "vt": "str"
            },
            {
                "t": "neq",
                "v": "SOAKING",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 735,
        "y": 1000,
        "wires": [
            [
                "0afd5835b34c3f7e"
            ],
            [
                "b79bc4ea4760e612"
            ]
        ],
        "l": false
    },
    {
        "id": "7debe7ed67a097f5",
        "type": "link in",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "links": [
            "a846cb12c824f26b"
        ],
        "x": 675,
        "y": 1000,
        "wires": [
            [
                "a2e12771c467bedb"
            ]
        ]
    },
    {
        "id": "40014b96c9ae727f",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "soaking logic",
        "info": "",
        "x": 730,
        "y": 920,
        "wires": []
    },
    {
        "id": "a846cb12c824f26b",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "mode": "link",
        "links": [
            "7debe7ed67a097f5",
            "57f37c997ce9b505",
            "df378f817d41c61d"
        ],
        "x": 415,
        "y": 660,
        "wires": []
    },
    {
        "id": "57f37c997ce9b505",
        "type": "link in",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "links": [
            "a846cb12c824f26b"
        ],
        "x": 675,
        "y": 820,
        "wires": [
            [
                "5b0d8dc236de50a5"
            ]
        ]
    },
    {
        "id": "5b0d8dc236de50a5",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "HOLDING",
                "vt": "str"
            },
            {
                "t": "neq",
                "v": "HOLDING",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 755,
        "y": 820,
        "wires": [
            [
                "717c700de0abd324"
            ],
            [
                "73d963005cc1351a"
            ]
        ],
        "l": false
    },
    {
        "id": "88d1596c700f5ab1",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "holding logic",
        "info": "",
        "x": 730,
        "y": 760,
        "wires": []
    },
    {
        "id": "df378f817d41c61d",
        "type": "link in",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "links": [
            "a846cb12c824f26b"
        ],
        "x": 675,
        "y": 640,
        "wires": [
            [
                "da94c6de412c0890"
            ]
        ]
    },
    {
        "id": "da94c6de412c0890",
        "type": "switch",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "RAMPING",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "RAMPING",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 735,
        "y": 640,
        "wires": [
            [
                "2293ffac501997ba"
            ],
            [
                "f1169a5a0d122c16"
            ]
        ],
        "l": false
    },
    {
        "id": "3207fc059e95ca8d",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "ramping logic",
        "info": "",
        "x": 730,
        "y": 580,
        "wires": []
    },
    {
        "id": "ef9ca1c1540d2a09",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "transition logic",
        "info": "",
        "x": 1080,
        "y": 760,
        "wires": []
    },
    {
        "id": "6621e559cca764ed",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "get ramp rate",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.data.segment_settings.ramp_rate",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1035,
        "y": 580,
        "wires": [
            [
                "c5180a0a450ebd11"
            ]
        ],
        "l": false
    },
    {
        "id": "c5180a0a450ebd11",
        "type": "link out",
        "z": "e9cef8706a9cf7f6",
        "name": "Output - ramp rate",
        "mode": "link",
        "links": [
            "899c85f172cb1839"
        ],
        "x": 1095,
        "y": 580,
        "wires": []
    },
    {
        "id": "88183c4473e0f66d",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "buttons",
        "info": "",
        "x": 190,
        "y": 800,
        "wires": []
    },
    {
        "id": "65289c32824bc573",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "buttons",
        "info": "",
        "x": 190,
        "y": 280,
        "wires": []
    },
    {
        "id": "b692ebb29e65c022",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 495,
        "y": 300,
        "wires": [
            [
                "6348c0ed609dce8b"
            ]
        ],
        "l": false
    },
    {
        "id": "14cf0c63e8349ec6",
        "type": "change",
        "z": "e9cef8706a9cf7f6",
        "name": "segment is disabled so advance to next",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Advance",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 875,
        "y": 680,
        "wires": [
            [
                "d30ec35d1e580d54"
            ]
        ],
        "l": false
    },
    {
        "id": "95ecab1d3e67b319",
        "type": "comment",
        "z": "e9cef8706a9cf7f6",
        "name": "TODO: Test new \"SetpointReached\" token for the release button",
        "info": "",
        "x": 930,
        "y": 720,
        "wires": []
    },
    {
        "id": "0d21e53eb5db0544",
        "type": "catch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 60,
        "y": 20,
        "wires": [
            [
                "3e7097f5bd1c065c"
            ]
        ]
    },
    {
        "id": "3e7097f5bd1c065c",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 190,
        "y": 20,
        "wires": []
    },
    {
        "id": "9f8f243cf0171822",
        "type": "PID",
        "z": "b83fb43068cdf48f",
        "name": "",
        "setpoint": "0",
        "pb": 1,
        "ti": 9999,
        "td": 0,
        "integral_default": 0.5,
        "smooth_factor": 3,
        "max_interval": 600,
        "enable": 1,
        "disabled_op": 0,
        "x": 195,
        "y": 360,
        "wires": [
            [
                "79e8d734b498031e"
            ]
        ],
        "l": false
    },
    {
        "id": "b33d04d72da3a5c7",
        "type": "inject",
        "z": "b83fb43068cdf48f",
        "name": "",
        "props": [
            {
                "p": "topic",
                "vt": "str"
            },
            {
                "p": "payload"
            },
            {
                "p": "setpoint",
                "v": "pid.zone[0].parameters.setpoint",
                "vt": "global"
            },
            {
                "p": "prop_band",
                "v": "pid.zone[0].settings.accepted.time.PB",
                "vt": "global"
            },
            {
                "p": "t_integral",
                "v": "pid.zone[0].settings.accepted.time.Ti",
                "vt": "global"
            },
            {
                "p": "t_derivative",
                "v": "pid.zone[0].settings.accepted.time.Td",
                "vt": "global"
            },
            {
                "p": "integral_default",
                "v": "0.5",
                "vt": "num"
            },
            {
                "p": "max_interval",
                "v": "600",
                "vt": "num"
            },
            {
                "p": "smooth_factor",
                "v": "3",
                "vt": "num"
            },
            {
                "p": "disabled_op",
                "v": "0",
                "vt": "num"
            }
        ],
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "process",
        "payload": "pid.zone[0].parameters.process",
        "payloadType": "global",
        "x": 75,
        "y": 360,
        "wires": [
            [
                "385287d0010ada53"
            ]
        ],
        "l": false
    },
    {
        "id": "70c0bc1ae3c6d12d",
        "type": "pid-autotune",
        "z": "b83fb43068cdf48f",
        "name": "",
        "outstep": 100,
        "maxout": 100,
        "lookback": 30,
        "setpoint": "setpoint",
        "setpointType": "msg",
        "tempVariable": "payload",
        "tempVariableType": "msg",
        "tempVariableMsgTopic": "temp-BK",
        "autoStart": "false",
        "triggeredStartValue": "start",
        "x": 215,
        "y": 500,
        "wires": [
            [
                "7fa4d2bb4f6f7d6d",
                "1f4cc5c39e564a05"
            ],
            [
                "68516e3a2a90088c"
            ],
            [
                "7e795aafec1fe140",
                "57220e0bca51df16"
            ]
        ],
        "l": false
    },
    {
        "id": "ce594852aefd69d9",
        "type": "kettle-sim",
        "z": "b83fb43068cdf48f",
        "name": "",
        "diam": 35,
        "volume": 40,
        "temp": 20,
        "power": 2.5,
        "ambientTemp": "20",
        "x": 620,
        "y": 120,
        "wires": [
            [
                "3904534e196d6bad"
            ]
        ]
    },
    {
        "id": "7fa4d2bb4f6f7d6d",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 275,
        "y": 460,
        "wires": [],
        "l": false
    },
    {
        "id": "7e795aafec1fe140",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 275,
        "y": 540,
        "wires": [],
        "l": false
    },
    {
        "id": "fcf34e6662f8df35",
        "type": "inject",
        "z": "b83fb43068cdf48f",
        "name": "start",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 75,
        "y": 460,
        "wires": [
            [
                "27787572425fc29d"
            ]
        ],
        "l": false
    },
    {
        "id": "4e3a914816059153",
        "type": "inject",
        "z": "b83fb43068cdf48f",
        "name": "stop",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 75,
        "y": 500,
        "wires": [
            [
                "c3273409af651b10"
            ]
        ],
        "l": false
    },
    {
        "id": "425ae74daf907ee2",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temp-BK",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 135,
        "y": 540,
        "wires": [
            [
                "70c0bc1ae3c6d12d"
            ]
        ],
        "l": false
    },
    {
        "id": "57220e0bca51df16",
        "type": "ui_text",
        "z": "b83fb43068cdf48f",
        "group": "a91f3f1520863187",
        "order": 5,
        "width": 10,
        "height": 1,
        "name": "",
        "label": "State:",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "x": 275,
        "y": 540,
        "wires": [],
        "l": false
    },
    {
        "id": "2190dcfd34562e8b",
        "type": "ui_button",
        "z": "b83fb43068cdf48f",
        "name": "",
        "group": "a91f3f1520863187",
        "order": 11,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Start",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 75,
        "y": 460,
        "wires": [
            [
                "27787572425fc29d"
            ]
        ],
        "l": false
    },
    {
        "id": "f0d273c59370d13e",
        "type": "ui_button",
        "z": "b83fb43068cdf48f",
        "name": "",
        "group": "a91f3f1520863187",
        "order": 13,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Stop",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "payload",
        "topicType": "msg",
        "x": 75,
        "y": 500,
        "wires": [
            [
                "c3273409af651b10"
            ]
        ],
        "l": false
    },
    {
        "id": "2f8672009c6d6836",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "",
        "label": "Kp",
        "tooltip": "",
        "group": "92429f8f445aacdf",
        "order": 2,
        "width": 4,
        "height": 1,
        "wrap": false,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": 0,
        "max": "100",
        "step": "0.001",
        "x": 755,
        "y": 460,
        "wires": [
            [
                "e1f8a85890d565e8"
            ]
        ],
        "l": false
    },
    {
        "id": "f0e9726a7e9db3cb",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "",
        "label": "Ki",
        "tooltip": "",
        "group": "92429f8f445aacdf",
        "order": 7,
        "width": 4,
        "height": 1,
        "wrap": false,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": 0,
        "max": "100",
        "step": "0.001",
        "x": 755,
        "y": 480,
        "wires": [
            [
                "05e45c99b2ce990a"
            ]
        ],
        "l": false
    },
    {
        "id": "562413ea1577bce5",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "",
        "label": "Kd",
        "tooltip": "",
        "group": "92429f8f445aacdf",
        "order": 12,
        "width": 4,
        "height": 1,
        "wrap": false,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": 0,
        "max": "1000",
        "step": "0.001",
        "x": 755,
        "y": 500,
        "wires": [
            [
                "96d9ca4a298d0a70"
            ]
        ],
        "l": false
    },
    {
        "id": "59d65a5a6cfe74b3",
        "type": "ui_ui_control",
        "z": "b83fb43068cdf48f",
        "name": "dashboard events",
        "events": "connect",
        "x": 515,
        "y": 540,
        "wires": [
            [
                "a2cccb12b627c0e7"
            ]
        ],
        "l": false
    },
    {
        "id": "92ddf9e5188bd64e",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "process in",
        "links": [
            "bee9b0aaa92de05c",
            "b533e4fa8c93b24a"
        ],
        "x": 75,
        "y": 540,
        "wires": [
            [
                "425ae74daf907ee2"
            ]
        ]
    },
    {
        "id": "68516e3a2a90088c",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "process out",
        "mode": "link",
        "links": [
            "51197ff3f70a4013"
        ],
        "x": 275,
        "y": 500,
        "wires": []
    },
    {
        "id": "f105876bb8452e6f",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "set zone",
        "rules": [
            {
                "t": "set",
                "p": "pid.selected_zone",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 815,
        "y": 600,
        "wires": [
            [
                "362eeead535475d1"
            ]
        ],
        "l": false
    },
    {
        "id": "299b028606dbaba5",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "get zone",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "pid.selected_zone",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 695,
        "y": 600,
        "wires": [
            [
                "3145db745f792654"
            ]
        ],
        "l": false
    },
    {
        "id": "463811f49227d71d",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].settings.tuned.gain.Kp') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 460,
        "wires": [
            [
                "2f8672009c6d6836"
            ]
        ],
        "l": false
    },
    {
        "id": "72a2a0f74ba06894",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].settings.tuned.gain.Ki') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 480,
        "wires": [
            [
                "f0e9726a7e9db3cb"
            ]
        ],
        "l": false
    },
    {
        "id": "4901de71268c6dc2",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].settings.tuned.gain.Kd') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 500,
        "wires": [
            [
                "562413ea1577bce5"
            ]
        ],
        "l": false
    },
    {
        "id": "ad72ca96abbbda04",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].parameters.setpoint') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 580,
        "wires": [
            [
                "62fbfbaaf7103238"
            ]
        ],
        "l": false
    },
    {
        "id": "e1f8a85890d565e8",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].settings.tuned.gain.Kp', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 460,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "05e45c99b2ce990a",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].settings.tuned.gain.Ki', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 480,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "96d9ca4a298d0a70",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].settings.tuned.gain.Kd', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 500,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "dc7fd3f39f82034f",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].parameters.setpoint', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 580,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "27787572425fc29d",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].autotune.active', true)\nmsg.setpoint = global.get('pid.zone[' + selected_zone + '].autotune.setpoint') || 0\nmsg.topic = 'temp-BK'\nmsg.cmd = 'start'\nmsg.payload = 0\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 135,
        "y": 460,
        "wires": [
            [
                "70c0bc1ae3c6d12d"
            ]
        ],
        "l": false
    },
    {
        "id": "c3273409af651b10",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].autotune.active', false)\nmsg.cmd = 'stop'\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 135,
        "y": 500,
        "wires": [
            [
                "70c0bc1ae3c6d12d"
            ]
        ],
        "l": false
    },
    {
        "id": "1f4cc5c39e564a05",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].autotune.active', false)\n\nif (msg.state == 'succeeded') {\n    global.set('pid.zone[' + selected_zone + '].settings.tuned.gain.Kp', msg.payload.Kp)\n    global.set('pid.zone[' + selected_zone + '].settings.tuned.gain.Ki', msg.payload.Ki)\n    global.set('pid.zone[' + selected_zone + '].settings.tuned.gain.Kd', msg.payload.Kd)\n} \n\nvar msg_out = { enabled: true } // enable any dashboard ui\nreturn msg_out",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 275,
        "y": 460,
        "wires": [
            [
                "ba4e7459b18e1a54"
            ]
        ],
        "l": false
    },
    {
        "id": "facb43dbf4d57ae0",
        "type": "inject",
        "z": "b83fb43068cdf48f",
        "name": "on startup",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 75,
        "y": 580,
        "wires": [
            [
                "b0cf339b6f16ca16"
            ]
        ],
        "l": false
    },
    {
        "id": "b0cf339b6f16ca16",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "init",
        "rules": [
            {
                "t": "set",
                "p": "pid.selected_zone",
                "pt": "global",
                "to": "0",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "pid.zone[0].autotune.active",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "pid.zone[1].autotune.active",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 135,
        "y": 580,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "3e140d1276e2a28d",
        "type": "ui_button",
        "z": "b83fb43068cdf48f",
        "name": "",
        "group": "92429f8f445aacdf",
        "order": 18,
        "width": 6,
        "height": 1,
        "passthru": false,
        "label": "Accept",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 755,
        "y": 620,
        "wires": [
            [
                "101e026ab1295209"
            ]
        ],
        "l": false
    },
    {
        "id": "101e026ab1295209",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nvar Kp = global.get('pid.zone[' + selected_zone + '].settings.tuned.gain.Kp') || 0\nvar Ki = global.get('pid.zone[' + selected_zone + '].settings.tuned.gain.Ki') || 0\nvar Kd = global.get('pid.zone[' + selected_zone + '].settings.tuned.gain.Kd') || 0\nglobal.set('pid.zone[' + selected_zone + '].settings.accepted.gain.Kp', Kp)\nglobal.set('pid.zone[' + selected_zone + '].settings.accepted.gain.Ki', Ki)\nglobal.set('pid.zone[' + selected_zone + '].settings.accepted.gain.Kd', Kd)\nglobal.set('pid.zone[' + selected_zone + '].settings.accepted.time.PB', 1/Kp)\nglobal.set('pid.zone[' + selected_zone + '].settings.accepted.time.Ti', 1/Ki)\nglobal.set('pid.zone[' + selected_zone + '].settings.accepted.time.Td', 1/Kd)\n\nreturn msg;\n\n//https://knowledge.ni.com/KnowledgeArticleDetails?id=kA00Z0000019L5TSAU&l=en-US\n//https://www.controleng.com/articles/understanding-derivative-in-pid-control/\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 620,
        "wires": [
            [
                "6c642e204f07ada4"
            ]
        ],
        "l": false
    },
    {
        "id": "6f0a2b0420a217c6",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "",
        "label": "Pb",
        "tooltip": "",
        "group": "92429f8f445aacdf",
        "order": 4,
        "width": 4,
        "height": 1,
        "wrap": false,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": 0,
        "max": "100",
        "step": "0.001",
        "x": 755,
        "y": 520,
        "wires": [
            [
                "16d2b807c8911037"
            ]
        ],
        "l": false
    },
    {
        "id": "2e2d8b482044aceb",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "",
        "label": "Ti",
        "tooltip": "",
        "group": "92429f8f445aacdf",
        "order": 9,
        "width": 4,
        "height": 1,
        "wrap": false,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": 0,
        "max": "100",
        "step": "0.001",
        "x": 755,
        "y": 540,
        "wires": [
            [
                "b3278848da3d3187"
            ]
        ],
        "l": false
    },
    {
        "id": "59104e20fbde50f9",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "",
        "label": "Td",
        "tooltip": "",
        "group": "92429f8f445aacdf",
        "order": 14,
        "width": 4,
        "height": 1,
        "wrap": false,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": 0,
        "max": "100",
        "step": "0.001",
        "x": 755,
        "y": 560,
        "wires": [
            [
                "72e5604feb0fec41"
            ]
        ],
        "l": false
    },
    {
        "id": "2e3cae4209b2ada3",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].settings.accepted.time.PB') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 520,
        "wires": [
            [
                "6f0a2b0420a217c6"
            ]
        ],
        "l": false
    },
    {
        "id": "421e168f1e21c8eb",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].settings.accepted.time.Ti') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 540,
        "wires": [
            [
                "2e2d8b482044aceb"
            ]
        ],
        "l": false
    },
    {
        "id": "89b465e16b59498c",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].settings.accepted.time.Td') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 560,
        "wires": [
            [
                "59104e20fbde50f9"
            ]
        ],
        "l": false
    },
    {
        "id": "16d2b807c8911037",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].settings.accepted.time.PB', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 520,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "b3278848da3d3187",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].settings.accepted.time.Ti', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 540,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "72e5604feb0fec41",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].settings.accepted.time.Td', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 560,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "6c642e204f07ada4",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "598a311988e79e25",
            "9ace848fd4fa953c"
        ],
        "x": 875,
        "y": 620,
        "wires": []
    },
    {
        "id": "fc98fd801ee9ea69",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 375,
        "y": 220,
        "wires": [],
        "l": false
    },
    {
        "id": "1f1e287e7011feb5",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "pid.zone[0].parameters.process",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 315,
        "y": 220,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "a7ac9ad8719beb31",
        "type": "ui_gauge",
        "z": "b83fb43068cdf48f",
        "name": "",
        "group": "54f5b9405598d975",
        "order": 7,
        "width": 4,
        "height": 4,
        "gtype": "gage",
        "title": "CV",
        "label": "",
        "format": "{{value}}%",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 795,
        "y": 780,
        "wires": [],
        "l": false
    },
    {
        "id": "0d10f69890a0aab8",
        "type": "ui_gauge",
        "z": "b83fb43068cdf48f",
        "name": "",
        "group": "54f5b9405598d975",
        "order": 5,
        "width": 4,
        "height": 4,
        "gtype": "gage",
        "title": "PV",
        "label": "units",
        "format": "{{value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 795,
        "y": 720,
        "wires": [],
        "l": false
    },
    {
        "id": "edf4d60398ebee66",
        "type": "ui_chart",
        "z": "b83fb43068cdf48f",
        "name": "",
        "group": "54f5b9405598d975",
        "order": 4,
        "width": 8,
        "height": 4,
        "label": "PV",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 795,
        "y": 740,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "b0db4a9bba41ecea",
        "type": "ui_chart",
        "z": "b83fb43068cdf48f",
        "name": "",
        "group": "54f5b9405598d975",
        "order": 6,
        "width": 8,
        "height": 4,
        "label": "CV",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 795,
        "y": 800,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "422b0453aa8d2e2b",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "msg.payload = msg.payload.toFixed(2)\nvar selected_zone = global.get('pid.selected_zone') || 0\nvar setpoint = parseFloat(global.get('pid.zone[' + selected_zone + '].autotune.setpoint'))\nsetpoint = setpoint * 1.5 // 130% of SP\nmsg = { payload: msg.payload, ui_control: { max: setpoint } }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 720,
        "wires": [
            [
                "0d10f69890a0aab8"
            ]
        ],
        "l": false
    },
    {
        "id": "4041ed0c8ac3b123",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.topic = global.get('pid.zone[' + selected_zone + '].id') || ''\nmsg.payload = msg.payload.toFixed(2)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 740,
        "wires": [
            [
                "edf4d60398ebee66"
            ]
        ],
        "l": false
    },
    {
        "id": "3009b2c13a269d18",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "msg.payload = msg.payload.toFixed(2)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 780,
        "wires": [
            [
                "a7ac9ad8719beb31"
            ]
        ],
        "l": false
    },
    {
        "id": "52a1b5a440697dbd",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.topic = global.get('pid.zone[' + selected_zone + '].id') || ''\nmsg.payload = msg.payload.toFixed(2)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 800,
        "wires": [
            [
                "b0db4a9bba41ecea"
            ]
        ],
        "l": false
    },
    {
        "id": "2ba532e7faaaf05f",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "clear chart",
        "func": "var msg_out = {\"payload\":[{\"series\":[],\"data\":[],\"labels\":[]}]};\n\nvar series_data0 = [];\nvar series_data1 = [];\n\nvar data_array = [];\ndata_array[0] = series_data0\ndata_array[1] = series_data1\n\n// \nmsg_out.payload[0].data = data_array\n\nreturn msg_out;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 840,
        "wires": [
            [
                "edf4d60398ebee66",
                "b0db4a9bba41ecea"
            ]
        ],
        "l": false
    },
    {
        "id": "90b25ac716e929c6",
        "type": "inject",
        "z": "b83fb43068cdf48f",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 635,
        "y": 840,
        "wires": [
            [
                "2ba532e7faaaf05f"
            ]
        ],
        "l": false
    },
    {
        "id": "79e8d734b498031e",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "set control if auto tune not active",
        "func": "if (!global.get('pid.zone[0].autotune.active')) {\n    global.set('pid.zone[0].parameters.control', msg.payload * 100)\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 255,
        "y": 360,
        "wires": [
            [
                "a7d4d1f6e66847a4"
            ]
        ],
        "l": false
    },
    {
        "id": "51197ff3f70a4013",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "",
        "links": [
            "68516e3a2a90088c"
        ],
        "x": 275,
        "y": 580,
        "wires": [
            [
                "4f6c495a3f7424e0"
            ]
        ]
    },
    {
        "id": "8fac31ef752b986d",
        "type": "inject",
        "z": "b83fb43068cdf48f",
        "name": "",
        "props": [],
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 75,
        "y": 220,
        "wires": [
            [
                "82f39574ad2ae492"
            ]
        ],
        "l": false
    },
    {
        "id": "82f39574ad2ae492",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "pid.zone[0].parameters.control",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 135,
        "y": 220,
        "wires": [
            [
                "29405e958220b21d",
                "094e9b28f33ff867"
            ]
        ],
        "l": false
    },
    {
        "id": "62fbfbaaf7103238",
        "type": "ui_slider",
        "z": "b83fb43068cdf48f",
        "name": "",
        "label": "SP",
        "tooltip": "",
        "group": "54f5b9405598d975",
        "order": 8,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "topic",
        "topicType": "msg",
        "min": 0,
        "max": "2500",
        "step": 1,
        "x": 755,
        "y": 580,
        "wires": [
            [
                "dc7fd3f39f82034f"
            ]
        ],
        "l": false
    },
    {
        "id": "3145db745f792654",
        "type": "ui_dropdown",
        "z": "b83fb43068cdf48f",
        "name": "",
        "label": "Zone",
        "tooltip": "",
        "place": "Select zone",
        "group": "a91f3f1520863187",
        "order": 2,
        "width": 10,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "Zone 0",
                "value": 0,
                "type": "num"
            },
            {
                "label": "Zone 1",
                "value": 1,
                "type": "num"
            }
        ],
        "payload": "",
        "topic": "topic",
        "topicType": "msg",
        "x": 755,
        "y": 600,
        "wires": [
            [
                "f105876bb8452e6f"
            ]
        ],
        "l": false
    },
    {
        "id": "9ace848fd4fa953c",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "",
        "links": [
            "362eeead535475d1",
            "6c642e204f07ada4"
        ],
        "x": 575,
        "y": 460,
        "wires": [
            [
                "463811f49227d71d",
                "72a2a0f74ba06894",
                "4901de71268c6dc2",
                "ad72ca96abbbda04",
                "89b465e16b59498c",
                "421e168f1e21c8eb",
                "2e3cae4209b2ada3",
                "9e758dbc39404bb8",
                "264235440a742302"
            ]
        ]
    },
    {
        "id": "362eeead535475d1",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "9ace848fd4fa953c"
        ],
        "x": 875,
        "y": 600,
        "wires": []
    },
    {
        "id": "ba4e7459b18e1a54",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "c825648e000f6977"
        ],
        "x": 335,
        "y": 460,
        "wires": []
    },
    {
        "id": "c825648e000f6977",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "",
        "links": [
            "a2cccb12b627c0e7",
            "ba4e7459b18e1a54"
        ],
        "x": 575,
        "y": 660,
        "wires": [
            [
                "463811f49227d71d",
                "72a2a0f74ba06894",
                "4901de71268c6dc2",
                "2e3cae4209b2ada3",
                "421e168f1e21c8eb",
                "89b465e16b59498c",
                "ad72ca96abbbda04",
                "299b028606dbaba5",
                "9e758dbc39404bb8",
                "264235440a742302"
            ]
        ]
    },
    {
        "id": "a2cccb12b627c0e7",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "c825648e000f6977"
        ],
        "x": 575,
        "y": 540,
        "wires": []
    },
    {
        "id": "45a06d0cb15ef15c",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "initialize variables",
        "func": "\n\nvar zone = []\nvar zone_count = 2\nfor (let index = 0; index < zone_count; index++) {\n    var obj1 = { gain: { Kp: 0, Ki: 0, Kd: 0 }, time: { PB: 0, Ti: 0, Td: 0 } }\n    var tuned = Object.create(obj1)\n    var obj2 = { gain: { Kp: 0, Ki: 0, Kd: 0 }, time: { PB: 0, Ti: 0, Td: 0 } }\n    var accepted = Object.create(obj2)\n    var obj3 = { tuned, accepted }\n    var settings = Object.create(obj3)\n    var obj4 = { setpoint: 0, control: 0, process: 0 }\n    var parameters = Object.create(obj4)\n    var obj5 = { active: false, setpoint: 0}\n    var autotune = Object.create(obj5)\n    zone.push({ id: '', autotune, parameters, settings })\n}\nvar pid = { selected_zone: 0, zone }\nglobal.set('pid', pid)\nmsg.payload = { pid }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 210,
        "y": 700,
        "wires": [
            [
                "bc663421e535970f"
            ]
        ]
    },
    {
        "id": "216bb83c577ca24b",
        "type": "inject",
        "z": "b83fb43068cdf48f",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 75,
        "y": 700,
        "wires": [
            [
                "45a06d0cb15ef15c"
            ]
        ],
        "l": false
    },
    {
        "id": "bc663421e535970f",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 335,
        "y": 700,
        "wires": [],
        "l": false
    },
    {
        "id": "4f6c495a3f7424e0",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "set control if auto tune active",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nif (global.get('pid.zone[' + selected_zone + '].autotune.active')) {\n    global.set('pid.zone[' + selected_zone + '].parameters.control', msg.payload)\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 335,
        "y": 580,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "385287d0010ada53",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "gate if auto tune active",
        "func": "if (global.get('pid.zone[0].autotune.active')) {\n    //node.status({ fill: \"red\", shape: \"ring\", text: \"blocked\" });\n    msg.enable = false\n} else {\n    //node.status({ fill: \"green\", shape: \"dot\", text: \"enabled\" });\n    msg.enable = true\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 135,
        "y": 360,
        "wires": [
            [
                "9f8f243cf0171822"
            ]
        ],
        "l": false
    },
    {
        "id": "0354f9fa940fc412",
        "type": "comment",
        "z": "b83fb43068cdf48f",
        "name": "pid zone 0",
        "info": "",
        "x": 80,
        "y": 320,
        "wires": []
    },
    {
        "id": "f7bef6a806c015d4",
        "type": "comment",
        "z": "b83fb43068cdf48f",
        "name": "auto tune",
        "info": "",
        "x": 80,
        "y": 420,
        "wires": []
    },
    {
        "id": "f44bbf38f57e5c57",
        "type": "PID",
        "z": "b83fb43068cdf48f",
        "name": "",
        "setpoint": "0",
        "pb": 1,
        "ti": 9999,
        "td": 0,
        "integral_default": 0.5,
        "smooth_factor": 3,
        "max_interval": 600,
        "enable": 1,
        "disabled_op": 0,
        "x": 655,
        "y": 360,
        "wires": [
            [
                "83caff269f9bed78"
            ]
        ],
        "l": false
    },
    {
        "id": "68721f01ae247e2e",
        "type": "inject",
        "z": "b83fb43068cdf48f",
        "name": "",
        "props": [
            {
                "p": "topic",
                "vt": "str"
            },
            {
                "p": "payload"
            },
            {
                "p": "setpoint",
                "v": "pid.zone[1].parameters.setpoint",
                "vt": "global"
            },
            {
                "p": "prop_band",
                "v": "pid.zone[1].settings.accepted.time.PB",
                "vt": "global"
            },
            {
                "p": "t_integral",
                "v": "pid.zone[1].settings.accepted.time.Ti",
                "vt": "global"
            },
            {
                "p": "t_derivative",
                "v": "pid.zone[1].settings.accepted.time.Td",
                "vt": "global"
            },
            {
                "p": "integral_default",
                "v": "0.5",
                "vt": "num"
            },
            {
                "p": "max_interval",
                "v": "600",
                "vt": "num"
            },
            {
                "p": "smooth_factor",
                "v": "3",
                "vt": "num"
            },
            {
                "p": "disabled_op",
                "v": "0",
                "vt": "num"
            }
        ],
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "process",
        "payload": "pid.zone[1].parameters.process",
        "payloadType": "global",
        "x": 535,
        "y": 360,
        "wires": [
            [
                "aa541d34f410d1e9"
            ]
        ],
        "l": false
    },
    {
        "id": "83caff269f9bed78",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "set control if auto tune not active",
        "func": "if (!global.get('pid.zone[1].autotune.active')) {\n    global.set('pid.zone[1].parameters.control', msg.payload * 100)\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 715,
        "y": 360,
        "wires": [
            [
                "33d46d048827346c"
            ]
        ],
        "l": false
    },
    {
        "id": "aa541d34f410d1e9",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "gate if auto tune active",
        "func": "if (global.get('pid.zone[1].autotune.active')) {\n    //node.status({ fill: \"red\", shape: \"ring\", text: \"blocked\" });\n    msg.enable = false\n} else {\n    //node.status({ fill: \"green\", shape: \"dot\", text: \"enabled\" });\n    msg.enable = true\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 595,
        "y": 360,
        "wires": [
            [
                "f44bbf38f57e5c57"
            ]
        ],
        "l": false
    },
    {
        "id": "905f3657bdd0e94b",
        "type": "comment",
        "z": "b83fb43068cdf48f",
        "name": "pid zone 1",
        "info": "",
        "x": 540,
        "y": 320,
        "wires": []
    },
    {
        "id": "f603fd46b7055148",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "",
        "links": [
            "f7d301c81543618a",
            "020de7ac1ec04a88"
        ],
        "x": 635,
        "y": 800,
        "wires": [
            [
                "52a1b5a440697dbd",
                "3009b2c13a269d18"
            ]
        ]
    },
    {
        "id": "f7d301c81543618a",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "f603fd46b7055148"
        ],
        "x": 255,
        "y": 260,
        "wires": []
    },
    {
        "id": "29405e958220b21d",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "pid.selected_zone",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 195,
        "y": 260,
        "wires": [
            [
                "f7d301c81543618a"
            ]
        ],
        "l": false
    },
    {
        "id": "bee9b0aaa92de05c",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "aa4193468fa51352",
            "92ddf9e5188bd64e",
            "287e0e0ceab0f3df"
        ],
        "x": 375,
        "y": 260,
        "wires": []
    },
    {
        "id": "8df48c7183182914",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "pid.selected_zone",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 315,
        "y": 260,
        "wires": [
            [
                "bee9b0aaa92de05c"
            ]
        ],
        "l": false
    },
    {
        "id": "aa4193468fa51352",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "",
        "links": [
            "bee9b0aaa92de05c",
            "b533e4fa8c93b24a"
        ],
        "x": 635,
        "y": 740,
        "wires": [
            [
                "422b0453aa8d2e2b",
                "4041ed0c8ac3b123"
            ]
        ]
    },
    {
        "id": "ebae959ae4626b66",
        "type": "comment",
        "z": "b83fb43068cdf48f",
        "name": "process zone 0",
        "info": "",
        "x": 100,
        "y": 180,
        "wires": []
    },
    {
        "id": "0f14e697e11af1c9",
        "type": "kettle-sim",
        "z": "b83fb43068cdf48f",
        "name": "",
        "diam": 35,
        "volume": 40,
        "temp": 20,
        "power": 2.5,
        "ambientTemp": "20",
        "x": 160,
        "y": 120,
        "wires": [
            [
                "9f719923c4346113"
            ]
        ]
    },
    {
        "id": "7bec29feb13d35ed",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 835,
        "y": 220,
        "wires": [],
        "l": false
    },
    {
        "id": "e506ed0cd0354fe6",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "pid.zone[1].parameters.process",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 775,
        "y": 220,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "0eb16bd0658e0cc5",
        "type": "inject",
        "z": "b83fb43068cdf48f",
        "name": "",
        "props": [],
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 535,
        "y": 220,
        "wires": [
            [
                "2173af95761ba16b"
            ]
        ],
        "l": false
    },
    {
        "id": "2173af95761ba16b",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "pid.zone[1].parameters.control",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 595,
        "y": 220,
        "wires": [
            [
                "27f7cbeff6ac667b",
                "4316bc9dff8ce9e9"
            ]
        ],
        "l": false
    },
    {
        "id": "020de7ac1ec04a88",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "f603fd46b7055148"
        ],
        "x": 715,
        "y": 260,
        "wires": []
    },
    {
        "id": "27f7cbeff6ac667b",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "pid.selected_zone",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "1",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 655,
        "y": 260,
        "wires": [
            [
                "020de7ac1ec04a88"
            ]
        ],
        "l": false
    },
    {
        "id": "b533e4fa8c93b24a",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [
            "aa4193468fa51352",
            "92ddf9e5188bd64e",
            "287e0e0ceab0f3df"
        ],
        "x": 835,
        "y": 260,
        "wires": []
    },
    {
        "id": "f05ced95d18386f1",
        "type": "switch",
        "z": "b83fb43068cdf48f",
        "name": "",
        "property": "pid.selected_zone",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "1",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 775,
        "y": 260,
        "wires": [
            [
                "b533e4fa8c93b24a"
            ]
        ],
        "l": false
    },
    {
        "id": "14d20276ab0fe471",
        "type": "comment",
        "z": "b83fb43068cdf48f",
        "name": "process zone 1",
        "info": "",
        "x": 560,
        "y": 180,
        "wires": []
    },
    {
        "id": "a7d4d1f6e66847a4",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 315,
        "y": 360,
        "wires": [],
        "l": false
    },
    {
        "id": "33d46d048827346c",
        "type": "debug",
        "z": "b83fb43068cdf48f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 775,
        "y": 360,
        "wires": [],
        "l": false
    },
    {
        "id": "dff5e7b57f1fa0d4",
        "type": "ui_numeric",
        "z": "b83fb43068cdf48f",
        "name": "",
        "label": "SP",
        "tooltip": "",
        "group": "a91f3f1520863187",
        "order": 8,
        "width": 4,
        "height": 1,
        "wrap": true,
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{msg.payload}}",
        "min": 0,
        "max": "10000",
        "step": 1,
        "x": 755,
        "y": 640,
        "wires": [
            [
                "d90c5421811f3d01"
            ]
        ],
        "l": false
    },
    {
        "id": "bdfba680ee386998",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "",
        "links": [],
        "x": 635,
        "y": 840,
        "wires": [
            [
                "2ba532e7faaaf05f"
            ]
        ]
    },
    {
        "id": "9e758dbc39404bb8",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].autotune.setpoint') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 640,
        "wires": [
            [
                "dff5e7b57f1fa0d4"
            ]
        ],
        "l": false
    },
    {
        "id": "d90c5421811f3d01",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].autotune.setpoint', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 640,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "53f27879023bc849",
        "type": "comment",
        "z": "b83fb43068cdf48f",
        "name": "dashboard",
        "info": "",
        "x": 540,
        "y": 420,
        "wires": []
    },
    {
        "id": "dd7c0ce30995f692",
        "type": "ui_text_input",
        "z": "b83fb43068cdf48f",
        "name": "",
        "label": "ID",
        "tooltip": "",
        "group": "54f5b9405598d975",
        "order": 2,
        "width": 10,
        "height": 1,
        "passthru": false,
        "mode": "text",
        "delay": "0",
        "topic": "topic",
        "topicType": "msg",
        "x": 755,
        "y": 660,
        "wires": [
            [
                "7a6d3d40ee58594a"
            ]
        ],
        "l": false
    },
    {
        "id": "264235440a742302",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nmsg.payload = global.get('pid.zone[' + selected_zone + '].id') || 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 695,
        "y": 660,
        "wires": [
            [
                "dd7c0ce30995f692"
            ]
        ],
        "l": false
    },
    {
        "id": "7a6d3d40ee58594a",
        "type": "function",
        "z": "b83fb43068cdf48f",
        "name": "",
        "func": "var selected_zone = global.get('pid.selected_zone') || 0\nglobal.set('pid.zone[' + selected_zone + '].id', msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 815,
        "y": 660,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "26cb94d0aa740af8",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "input - zone 0 - in from process (PV)",
        "links": [
            "dcbc073ea7b777ee"
        ],
        "x": 255,
        "y": 220,
        "wires": [
            [
                "1f1e287e7011feb5",
                "8df48c7183182914",
                "fc98fd801ee9ea69"
            ]
        ]
    },
    {
        "id": "094e9b28f33ff867",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "output - zone 0 - out to process (CV 0-100%)",
        "mode": "link",
        "links": [
            "0cfeb2a7be515599"
        ],
        "x": 195,
        "y": 220,
        "wires": []
    },
    {
        "id": "9fea36d4825b738a",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "input - zone 1 - in from process (PV)",
        "links": [
            "e65201e766b76bfd"
        ],
        "x": 715,
        "y": 220,
        "wires": [
            [
                "7bec29feb13d35ed",
                "e506ed0cd0354fe6",
                "f05ced95d18386f1"
            ]
        ]
    },
    {
        "id": "4316bc9dff8ce9e9",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "output - zone 1 - out to process (CV 0-100%)",
        "mode": "link",
        "links": [
            "f2bc62537768881d"
        ],
        "x": 655,
        "y": 220,
        "wires": []
    },
    {
        "id": "f72ddfd7a65c460f",
        "type": "comment",
        "z": "b83fb43068cdf48f",
        "name": "sim process 0",
        "info": "",
        "x": 90,
        "y": 80,
        "wires": []
    },
    {
        "id": "9f719923c4346113",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [],
        "x": 255,
        "y": 120,
        "wires": []
    },
    {
        "id": "23f8f6fa2795060e",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "",
        "links": [],
        "x": 55,
        "y": 120,
        "wires": [
            [
                "0f14e697e11af1c9"
            ]
        ]
    },
    {
        "id": "a1ae885d2516a171",
        "type": "comment",
        "z": "b83fb43068cdf48f",
        "name": "sim process 1",
        "info": "",
        "x": 550,
        "y": 80,
        "wires": []
    },
    {
        "id": "b6f64f1a60334477",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "",
        "links": [],
        "x": 515,
        "y": 120,
        "wires": [
            [
                "ce594852aefd69d9"
            ]
        ]
    },
    {
        "id": "3904534e196d6bad",
        "type": "link out",
        "z": "b83fb43068cdf48f",
        "name": "",
        "mode": "link",
        "links": [],
        "x": 715,
        "y": 120,
        "wires": []
    },
    {
        "id": "0c3ef84adfec1591",
        "type": "comment",
        "z": "b83fb43068cdf48f",
        "name": "utility",
        "info": "",
        "x": 70,
        "y": 660,
        "wires": []
    },
    {
        "id": "53681c7211103452",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "input - zone 0 - SP",
        "links": [
            "9715dba2fc1ab553",
            "c96334b38e278286",
            "af8f2e69ea9f27c2"
        ],
        "x": 75,
        "y": 260,
        "wires": [
            [
                "15a8037dcc3b6a5a"
            ]
        ]
    },
    {
        "id": "15a8037dcc3b6a5a",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "pid.zone[0].parameters.setpoint",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 135,
        "y": 260,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "4840d3b8dd483cff",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "input - zone 1 - SP",
        "links": [
            "6f66fd670975be35",
            "c96334b38e278286",
            "af8f2e69ea9f27c2"
        ],
        "x": 535,
        "y": 260,
        "wires": [
            [
                "9fa5332fb445e60b"
            ]
        ]
    },
    {
        "id": "9fa5332fb445e60b",
        "type": "change",
        "z": "b83fb43068cdf48f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "pid.zone[1].parameters.setpoint",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 595,
        "y": 260,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "287e0e0ceab0f3df",
        "type": "link in",
        "z": "b83fb43068cdf48f",
        "name": "",
        "links": [
            "b533e4fa8c93b24a",
            "bee9b0aaa92de05c"
        ],
        "x": 575,
        "y": 580,
        "wires": [
            [
                "ad72ca96abbbda04"
            ]
        ]
    },
    {
        "id": "c96f9cb61b158baf",
        "type": "inject",
        "z": "3154c44d1a91de38",
        "name": "",
        "props": [
            {
                "p": "timestamp",
                "v": "",
                "vt": "date"
            }
        ],
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 75,
        "y": 360,
        "wires": [
            [
                "f45e246dbf521446"
            ]
        ],
        "l": false
    },
    {
        "id": "35573d9f8cb557cc",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "get upper temp",
        "func": "// https://github.com/maugdog/max31855\n\n/**\n * Node.js module for driving the Adafruit MAX31855 thermocouple temperature amplifier on Raspberry Pi.\n *\n * Currently supports only hardware SPI configuration (as opposed to software SPI using GPIO pins).\n * Note: May require running under sudo for SPI permissions.\n * Note: The SPI master driver is disabled by default on Raspian Linux and must be enabled. see here:\n * https://www.raspberrypi.org/documentation/hardware/raspberrypi/spi/README.md\n */\n\n//var SPI = require('pi-spi');\n\nfunction MAX31855(spidev) {\n  // Initialize the SPI settings\n  //this._spi = SPI.initialize(\"/dev/spidev0.0\");\n  this._spi = SPI.initialize(spidev);\n  this._spi.clockSpeed(5000000);\n  this._spi.dataMode(0);\n  this._spi.bitOrder(SPI.order.MSB_FIRST);\n}\n\n/** Read 32 bits from the SPI bus. */\nMAX31855.prototype._read32 = function (callback) {\n  this._spi.read(4, function (error, bytes) {\n    if (error) {\n      console.error(error);\n    } else {\n      if (!bytes || bytes.length != 4) {\n        throw new Error('MAX31855: Did not read expected number of bytes from device!');\n      } else {\n        var value\n        value = bytes[0] << 24 | bytes[1] << 16 | bytes[2] << 8 | bytes[3];\n        //console.log('Raw value: ', value);\n        callback(value);\n      }\n    }\n  });\n};\n\n/** Returns the internal temperature value in degrees Celsius. */\nMAX31855.prototype.readInternalC = function (callback) {\n  if (callback) {\n    this._read32(function (value) {\n      // Ignore bottom 4 bits of thermocouple data.\n      value >>= 4;\n      // Grab bottom 11 bits as internal temperature data.\n      var internal = value & 0x7FF;\n      if (value & 0x800) {\n        // Negative value, take 2's compliment.\n        internal = ~internal + 1;\n      }\n      // Scale by 0.0625 degrees C per bit and return value.\n      callback(internal * 0.0625);\n    });\n  } else {\n    console.log('MAX31855: Read request issued with no callback.');\n  }\n};\n\n/** Return the thermocouple temperature value. Value is returned in degrees celsius */\nMAX31855.prototype.readTempC = function (callback) {\n  if (callback) {\n    var self = this; // Scope closure\n    this._read32(function (value) {\n      // Check for error reading value.\n      if (value & 0x7) {\n        callback(NaN);\n      } else {\n        if (value & 0x80000000) { // Check if signed bit is set.\n          // Negative value, shift the bits and take 2's compliment.\n          value >>= 18;\n          value = ~value + 1;\n        } else { // Positive value, just shift the bits to get the value.\n          value >>= 18;\n        }\n        // Scale by 0.25 degrees C per bit\n        callback(value * 0.25);\n      }\n    });\n  } else {\n    console.log('MAX31855: Read request issued with no callback.');\n  }\n};\n\nvar thermoSensor = new MAX31855(msg.spidev);\nthermoSensor.readTempC(function (temp) {\n  temp = temp * 9 / 5 + 32\n  node.status({ fill: \"green\", shape: \"dot\", text: temp + '°F' });\n  var newMsg = { \"payload\": temp }\n  node.send(newMsg); // node.send() is needed for async\n  node.done();\n});",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [
            {
                "var": "SPI",
                "module": "pi-spi"
            }
        ],
        "x": 255,
        "y": 340,
        "wires": [
            [
                "7287721824e53891"
            ]
        ],
        "l": false
    },
    {
        "id": "90d2df249ed5559d",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "get lower temp",
        "func": "// https://github.com/maugdog/max31855\n\n/**\n * Node.js module for driving the Adafruit MAX31855 thermocouple temperature amplifier on Raspberry Pi.\n *\n * Currently supports only hardware SPI configuration (as opposed to software SPI using GPIO pins).\n * Note: May require running under sudo for SPI permissions.\n * Note: The SPI master driver is disabled by default on Raspian Linux and must be enabled. see here:\n * https://www.raspberrypi.org/documentation/hardware/raspberrypi/spi/README.md\n */\n\n//var SPI = require('pi-spi');\n\nfunction MAX31855(spidev) {\n  // Initialize the SPI settings\n  //this._spi = SPI.initialize(\"/dev/spidev0.0\");\n  this._spi = SPI.initialize(spidev);\n  this._spi.clockSpeed(5000000);\n  this._spi.dataMode(0);\n  this._spi.bitOrder(SPI.order.MSB_FIRST);\n}\n\n/** Read 32 bits from the SPI bus. */\nMAX31855.prototype._read32 = function(callback) {\n  this._spi.read(4, function(error, bytes) {\n    if(error) {\n      console.error(error);\n    } else {\n      if(!bytes || bytes.length != 4) {\n        throw new Error('MAX31855: Did not read expected number of bytes from device!');\n      } else {\n        var value\n        value = bytes[0] << 24 | bytes[1] << 16 | bytes[2] << 8 | bytes[3];\n        //console.log('Raw value: ', value);\n        callback(value);\n      }\n    }\n  });\n};\n\n/** Returns the internal temperature value in degrees Celsius. */\nMAX31855.prototype.readInternalC = function(callback) {\n  if(callback) {\n    this._read32(function(value) {\n      // Ignore bottom 4 bits of thermocouple data.\n  \t\tvalue >>= 4;\n  \t\t// Grab bottom 11 bits as internal temperature data.\n  \t\tvar internal = value & 0x7FF;\n  \t\tif(value & 0x800) {\n        // Negative value, take 2's compliment.\n        internal = ~internal + 1;\n      }\n      // Scale by 0.0625 degrees C per bit and return value.\n      callback(internal * 0.0625);\n    });\n  } else {\n    console.log('MAX31855: Read request issued with no callback.');\n  }\n};\n\n/** Return the thermocouple temperature value. Value is returned in degrees celsius */\nMAX31855.prototype.readTempC = function(callback) {\n  if(callback) {\n    var self = this; // Scope closure\n    this._read32(function(value) {\n      // Check for error reading value.\n      if(value & 0x7) {\n        callback(NaN);\n      } else {\n        if(value & 0x80000000) { // Check if signed bit is set.\n          // Negative value, shift the bits and take 2's compliment.\n          value >>= 18;\n          value = ~value + 1;\n        } else { // Positive value, just shift the bits to get the value.\n          value >>= 18;\n        }\n        // Scale by 0.25 degrees C per bit\n        callback(value * 0.25);\n      }\n    });\n  } else {\n    console.log('MAX31855: Read request issued with no callback.');\n  }\n};\n\nvar thermoSensor = new MAX31855(msg.spidev);\nthermoSensor.readTempC(function (temp) {\n  temp = temp * 9 / 5 + 32\n  node.status({ fill: \"green\", shape: \"dot\", text: temp + '°F' });\n  var newMsg = { \"payload\": temp}\n  node.send(newMsg); // node.send() is needed for async\n  node.done();\n});",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [
            {
                "var": "SPI",
                "module": "pi-spi"
            }
        ],
        "x": 255,
        "y": 400,
        "wires": [
            [
                "9e74c237cf627626"
            ]
        ],
        "l": false
    },
    {
        "id": "774be46b1df4202c",
        "type": "catch",
        "z": "3154c44d1a91de38",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 60,
        "y": 20,
        "wires": [
            [
                "08d3626ca47817b7"
            ]
        ]
    },
    {
        "id": "08d3626ca47817b7",
        "type": "debug",
        "z": "3154c44d1a91de38",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 190,
        "y": 20,
        "wires": []
    },
    {
        "id": "6c490df17d1de881",
        "type": "rbe",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "deadbandEq",
        "gap": "1",
        "start": "",
        "inout": "out",
        "septopics": false,
        "property": "payload",
        "topi": "topic",
        "x": 495,
        "y": 260,
        "wires": [
            [
                "dbaab26e980063a4"
            ]
        ],
        "l": false
    },
    {
        "id": "bd45525a6924a5c5",
        "type": "rbe",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "deadbandEq",
        "gap": "1",
        "start": "",
        "inout": "out",
        "septopics": false,
        "property": "payload",
        "topi": "topic",
        "x": 495,
        "y": 220,
        "wires": [
            [
                "5cdb1e903b180a71"
            ]
        ],
        "l": false
    },
    {
        "id": "dcbc073ea7b777ee",
        "type": "link out",
        "z": "3154c44d1a91de38",
        "name": "Output - Upper Temperature",
        "mode": "link",
        "links": [
            "26cb94d0aa740af8",
            "9b6b7f2249d013ba"
        ],
        "x": 495,
        "y": 340,
        "wires": []
    },
    {
        "id": "e65201e766b76bfd",
        "type": "link out",
        "z": "3154c44d1a91de38",
        "name": "Output - Lower Temperature",
        "mode": "link",
        "links": [
            "4ea9f6ce194f1281",
            "9fea36d4825b738a"
        ],
        "x": 495,
        "y": 400,
        "wires": []
    },
    {
        "id": "ea802ed93ceeae42",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "sim temps",
        "rules": [
            {
                "t": "set",
                "p": "#:(memoryOnly)::kiln_01.UpperTemperature",
                "pt": "global",
                "to": "#:(memoryOnly)::kiln_01.UpperSetpoint",
                "tot": "global"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "#:(memoryOnly)::kiln_01.UpperSetpoint",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 315,
        "y": 220,
        "wires": [
            [
                "bbab6af088f829c2"
            ]
        ],
        "l": false
    },
    {
        "id": "1235c1dcd4711779",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "build measurement",
        "rules": [
            {
                "t": "delete",
                "p": "topic",
                "pt": "msg"
            },
            {
                "t": "set",
                "p": "measurement",
                "pt": "msg",
                "to": "Kiln_01_UpperTemperature",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 615,
        "y": 220,
        "wires": [
            [
                "2f036bde9aaff376"
            ]
        ],
        "l": false
    },
    {
        "id": "9468a3b6de1782db",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "build measurement",
        "rules": [
            {
                "t": "delete",
                "p": "topic",
                "pt": "msg"
            },
            {
                "t": "set",
                "p": "measurement",
                "pt": "msg",
                "to": "Kiln_01_LowerTemperature",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 615,
        "y": 260,
        "wires": [
            [
                "2f036bde9aaff376"
            ]
        ],
        "l": false
    },
    {
        "id": "819eacdd5b2d931c",
        "type": "trigger",
        "z": "3154c44d1a91de38",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "date",
        "op2type": "str",
        "duration": "-1000",
        "extend": false,
        "overrideDelay": false,
        "units": "ms",
        "reset": "false",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 235,
        "y": 240,
        "wires": [
            [
                "ea802ed93ceeae42",
                "79016fc241d79289"
            ]
        ],
        "l": false
    },
    {
        "id": "bc3e2212fd11e206",
        "type": "ui_switch",
        "z": "3154c44d1a91de38",
        "name": "",
        "label": "Simulation",
        "tooltip": "",
        "group": "112aa19380852c23",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "x": 330,
        "y": 520,
        "wires": [
            [
                "d76c7ce673b280af"
            ]
        ]
    },
    {
        "id": "79016fc241d79289",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "sim temps",
        "rules": [
            {
                "t": "set",
                "p": "#:(memoryOnly)::kiln_01.LowerTemperature",
                "pt": "global",
                "to": "#:(memoryOnly)::kiln_01.LowerSetpoint",
                "tot": "global"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "#:(memoryOnly)::kiln_01.LowerSetpoint",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 315,
        "y": 260,
        "wires": [
            [
                "acb33ff4507d9a9b"
            ]
        ],
        "l": false
    },
    {
        "id": "d76c7ce673b280af",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "set sim temp",
        "rules": [
            {
                "t": "set",
                "p": "kiln_01.SimulateTemperature",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 435,
        "y": 520,
        "wires": [
            [
                "a3ad47349ae89c29"
            ]
        ],
        "l": false
    },
    {
        "id": "f45e246dbf521446",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "check sim temp",
        "property": "kiln_01.SimulateTemperature",
        "propertyType": "global",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 135,
        "y": 360,
        "wires": [
            [
                "159e09add5a1e1ed",
                "0402b15e862a2745"
            ]
        ],
        "l": false
    },
    {
        "id": "2f036bde9aaff376",
        "type": "influxdb out",
        "z": "3154c44d1a91de38",
        "influxdb": "1a7d214ba0ada216",
        "name": "",
        "measurement": "",
        "precision": "",
        "retentionPolicy": "",
        "database": "home",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "52w",
        "org": "organisation",
        "bucket": "bucket",
        "x": 800,
        "y": 260,
        "wires": []
    },
    {
        "id": "dbaab26e980063a4",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "temp cutoff",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gte",
                "v": "50",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 555,
        "y": 260,
        "wires": [
            [
                "9468a3b6de1782db"
            ]
        ],
        "l": false
    },
    {
        "id": "5cdb1e903b180a71",
        "type": "switch",
        "z": "3154c44d1a91de38",
        "name": "temp cutoff",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gte",
                "v": "50",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 555,
        "y": 220,
        "wires": [
            [
                "1235c1dcd4711779"
            ]
        ],
        "l": false
    },
    {
        "id": "5689c5638cfebacb",
        "type": "ui_ui_control",
        "z": "3154c44d1a91de38",
        "name": "",
        "events": "connect",
        "x": 155,
        "y": 520,
        "wires": [
            [
                "477ed7158a34c5bf"
            ]
        ],
        "l": false
    },
    {
        "id": "477ed7158a34c5bf",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "get sim temp",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "kiln_01.SimulateTemperature",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 215,
        "y": 520,
        "wires": [
            [
                "bc3e2212fd11e206"
            ]
        ],
        "l": false
    },
    {
        "id": "218ba5aacd9d564e",
        "type": "link in",
        "z": "3154c44d1a91de38",
        "name": "",
        "links": [
            "a3ad47349ae89c29"
        ],
        "x": 175,
        "y": 240,
        "wires": [
            [
                "819eacdd5b2d931c"
            ]
        ]
    },
    {
        "id": "a3ad47349ae89c29",
        "type": "link out",
        "z": "3154c44d1a91de38",
        "name": "",
        "mode": "link",
        "links": [
            "218ba5aacd9d564e"
        ],
        "x": 495,
        "y": 520,
        "wires": []
    },
    {
        "id": "16e8124d59e7fb62",
        "type": "rpi-gpio out",
        "z": "3154c44d1a91de38",
        "name": "Upper_Heater",
        "pin": "26",
        "set": true,
        "level": "0",
        "freq": "",
        "out": "out",
        "bcm": true,
        "x": 520,
        "y": 760,
        "wires": []
    },
    {
        "id": "708a944b9506b9a4",
        "type": "trigger",
        "z": "3154c44d1a91de38",
        "name": "",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "200",
        "extend": false,
        "overrideDelay": true,
        "units": "ms",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 375,
        "y": 720,
        "wires": [
            [
                "16e8124d59e7fb62"
            ]
        ],
        "l": false
    },
    {
        "id": "ee6259aabb77fcdf",
        "type": "inject",
        "z": "3154c44d1a91de38",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "0.1",
        "topic": "",
        "x": 490,
        "y": 40,
        "wires": [
            [
                "11d1503b33735b7a"
            ]
        ]
    },
    {
        "id": "11d1503b33735b7a",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "initialize",
        "rules": [
            {
                "t": "set",
                "p": "#:(memoryOnly)::kiln_01.Setpoint",
                "pt": "global",
                "to": "0",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "#:(memoryOnly)::kiln_01.UpperSetpoint",
                "pt": "global",
                "to": "0",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "#:(memoryOnly)::kiln_01.LowerSetpoint",
                "pt": "global",
                "to": "0",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "kiln_01.SimulateTemperature",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 40,
        "wires": [
            []
        ]
    },
    {
        "id": "12681729a71ef662",
        "type": "rpi-gpio out",
        "z": "3154c44d1a91de38",
        "name": "Lower_Heater",
        "pin": "19",
        "set": true,
        "level": "0",
        "freq": "",
        "out": "out",
        "bcm": true,
        "x": 520,
        "y": 840,
        "wires": []
    },
    {
        "id": "26dcb58ffb63fae4",
        "type": "trigger",
        "z": "3154c44d1a91de38",
        "name": "",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "200",
        "extend": false,
        "overrideDelay": true,
        "units": "ms",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 375,
        "y": 800,
        "wires": [
            [
                "12681729a71ef662"
            ]
        ],
        "l": false
    },
    {
        "id": "e4a7e7415279dc26",
        "type": "comment",
        "z": "3154c44d1a91de38",
        "name": "ssr output",
        "info": "",
        "x": 80,
        "y": 660,
        "wires": []
    },
    {
        "id": "4411f03fad54a3bf",
        "type": "comment",
        "z": "3154c44d1a91de38",
        "name": "thermocouples input and data collection",
        "info": "",
        "x": 180,
        "y": 80,
        "wires": []
    },
    {
        "id": "f149b69a489b3e6f",
        "type": "comment",
        "z": "3154c44d1a91de38",
        "name": "TODO: fault when thermocouple is removed",
        "info": "",
        "x": 210,
        "y": 140,
        "wires": []
    },
    {
        "id": "1e743148a5de6976",
        "type": "comment",
        "z": "3154c44d1a91de38",
        "name": "TODO: calibration routine",
        "info": "",
        "x": 150,
        "y": 160,
        "wires": []
    },
    {
        "id": "0d670f61e6fde01c",
        "type": "smooth",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "payload",
        "action": "low",
        "count": "10",
        "round": "2",
        "mult": "single",
        "reduce": false,
        "x": 375,
        "y": 340,
        "wires": [
            [
                "dcbc073ea7b777ee",
                "bd45525a6924a5c5",
                "aec3c2c38a63dd10"
            ]
        ],
        "l": false
    },
    {
        "id": "8c970109233d3f07",
        "type": "smooth",
        "z": "3154c44d1a91de38",
        "name": "",
        "property": "payload",
        "action": "low",
        "count": "10",
        "round": "2",
        "mult": "single",
        "reduce": false,
        "x": 375,
        "y": 400,
        "wires": [
            [
                "6c490df17d1de881",
                "e65201e766b76bfd",
                "6ab284ac808bee4a"
            ]
        ],
        "l": false
    },
    {
        "id": "d4cb1a52a4fe0d75",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "// create a new message object to clean it up\nvar msg_out = { delay: msg.payload * 10 }; // should come in as 0 - 100%\nvar dutycycle = msg.payload * 1\nvar FsmStatus_Schedule = global.get('kiln_01.FsmStatus_Schedule','memoryOnly')\n//var FsmStatus_Segment = global.get('kiln_01.FsmStatus_Segment','memoryOnly')\nvar auto_tune_upper = global.get('pid.zone[0].autotune.active')\nvar auto_tune_lower = global.get('pid.zone[1].autotune.active')\nvar UpperSetpoint = global.get('kiln_01.UpperSetpoint','memoryOnly')\nvar LowerSetpoint = global.get('kiln_01.LowerSetpoint','memoryOnly')\nvar UpperTemperature = global.get('kiln_01.UpperTemperature','memoryOnly')\nvar LowerTemperature = global.get('kiln_01.LowerTemperature','memoryOnly')\n\n//if (Math.abs(UpperSetpoint - UpperTemperature) < 100 && Math.abs(LowerSetpoint - LowerTemperature) < 100 \n//    || auto_tune_upper || auto_tune_lower) {\n        // temps a setpoints are within tolerance\n        //node.status({fill:\"green\",shape:\"dot\",text:\"All good!\"});\n        // the trigger function locks up if you send it a zero\n        // similarly, we dont want to send it a value over\n        // the trigger time (1000 ms)\n        if (msg_out.delay > 0 && msg_out.delay < 1000 && (FsmStatus_Schedule != 'IDLE' && !auto_tune_upper && !auto_tune_lower)) {\n            node.status({fill:\"green\",shape:\"dot\",text:dutycycle.toFixed(1) + '%'});\n            return [ msg_out, null ];\n        } else if (msg_out.delay <= 0 || (FsmStatus_Schedule == 'IDLE' && !auto_tune_upper && !auto_tune_lower)) {\n            // send an \"off\" directly to the output node\n            node.status({fill:\"green\",shape:\"ring\",text:'0%'});\n            msg_out.payload = \"0\"\n            return [ null, msg_out ];\n        } else if (msg_out.delay >= 1000){\n            // send an \"on\" directly to the output node\n            node.status({fill:\"green\",shape:\"dot\",text:'100%'});\n            msg_out.payload = \"1\"\n            return [ null, msg_out ];\n        } else {\n            // send an \"off\" directly to the output node\n            node.status({fill:\"green\",shape:\"ring\",text:'0%'});\n            msg_out.payload = \"0\"\n            return [ null, msg_out ];\n        }\n//} else {\n    // temp is too far away from setpoint. something is wrong.\n    // send an \"off\" directly to the output node\n    //node.warn(\"temp is too far away from setpoint. something is wrong.\")\n//    node.status({fill:\"red\",shape:\"dot\",text:\"Something is wrong!\"});\n//    msg_out.payload = \"0\"\n//    return [ null, msg_out ];\n//}",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 275,
        "y": 740,
        "wires": [
            [
                "708a944b9506b9a4"
            ],
            [
                "16e8124d59e7fb62"
            ]
        ],
        "l": false
    },
    {
        "id": "5bb8a83cadcb2ba3",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "// create a new message object to clean it up\nvar msg_out = { delay: msg.payload * 10 }; // should come in as 0 - 100%\nvar dutycycle = msg.payload * 1\nvar FsmStatus_Schedule = global.get('kiln_01.FsmStatus_Schedule','memoryOnly')\n//var FsmStatus_Segment = global.get('kiln_01.FsmStatus_Segment','memoryOnly')\nvar auto_tune_upper = global.get('pid.zone[0].autotune.active')\nvar auto_tune_lower = global.get('pid.zone[1].autotune.active')\nvar UpperSetpoint = global.get('kiln_01.UpperSetpoint','memoryOnly')\nvar LowerSetpoint = global.get('kiln_01.LowerSetpoint','memoryOnly')\nvar UpperTemperature = global.get('kiln_01.UpperTemperature','memoryOnly')\nvar LowerTemperature = global.get('kiln_01.LowerTemperature','memoryOnly')\n\n//if (Math.abs(UpperSetpoint - UpperTemperature) < 100 && Math.abs(LowerSetpoint - LowerTemperature) < 100 \n//    || auto_tune_upper || auto_tune_lower) {\n        // temps a setpoints are within tolerance\n        //node.status({fill:\"green\",shape:\"dot\",text:\"All good!\"});\n        // the trigger function locks up if you send it a zero\n        // similarly, we dont want to send it a value over\n        // the trigger time (1000 ms)\n        if (msg_out.delay > 0 && msg_out.delay < 1000 && (FsmStatus_Schedule != 'IDLE' && !auto_tune_upper && !auto_tune_lower)) {\n            node.status({fill:\"green\",shape:\"dot\",text:dutycycle.toFixed(1) + '%'});\n            return [ msg_out, null ];\n        } else if (msg_out.delay <= 0 || (FsmStatus_Schedule == 'IDLE' && !auto_tune_upper && !auto_tune_lower)) {\n            // send an \"off\" directly to the output node\n            node.status({fill:\"green\",shape:\"ring\",text:'0%'});\n            msg_out.payload = \"0\"\n            return [ null, msg_out ];\n        } else if (msg_out.delay >= 1000){\n            // send an \"on\" directly to the output node\n            node.status({fill:\"green\",shape:\"dot\",text:'100%'});\n            msg_out.payload = \"1\"\n            return [ null, msg_out ];\n        } else {\n            // send an \"off\" directly to the output node\n            node.status({fill:\"green\",shape:\"ring\",text:'0%'});\n            msg_out.payload = \"0\"\n            return [ null, msg_out ];\n        }\n//} else {\n    // temp is too far away from setpoint. something is wrong.\n    // send an \"off\" directly to the output node\n    //node.warn(\"temp is too far away from setpoint. something is wrong.\")\n//    node.status({fill:\"red\",shape:\"dot\",text:\"Something is wrong!\"});\n//    msg_out.payload = \"0\"\n//    return [ null, msg_out ];\n//}",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 275,
        "y": 820,
        "wires": [
            [
                "26dcb58ffb63fae4"
            ],
            [
                "12681729a71ef662"
            ]
        ],
        "l": false
    },
    {
        "id": "0cfeb2a7be515599",
        "type": "link in",
        "z": "3154c44d1a91de38",
        "name": "input - upper heater",
        "links": [
            "094e9b28f33ff867"
        ],
        "x": 215,
        "y": 740,
        "wires": [
            [
                "d4cb1a52a4fe0d75",
                "2dc776b16235c7a0"
            ]
        ]
    },
    {
        "id": "f2bc62537768881d",
        "type": "link in",
        "z": "3154c44d1a91de38",
        "name": "input - upper heater",
        "links": [
            "4316bc9dff8ce9e9"
        ],
        "x": 215,
        "y": 820,
        "wires": [
            [
                "5bb8a83cadcb2ba3"
            ]
        ]
    },
    {
        "id": "159e09add5a1e1ed",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "spidev",
                "pt": "msg",
                "to": "/dev/spidev0.1",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 195,
        "y": 340,
        "wires": [
            [
                "35573d9f8cb557cc"
            ]
        ],
        "l": false
    },
    {
        "id": "0402b15e862a2745",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "spidev",
                "pt": "msg",
                "to": "/dev/spidev0.0",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 195,
        "y": 400,
        "wires": [
            [
                "90d2df249ed5559d"
            ]
        ],
        "l": false
    },
    {
        "id": "bbab6af088f829c2",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "msg.payload = parseFloat(msg.payload.toFixed(2))\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 375,
        "y": 220,
        "wires": [
            [
                "dcbc073ea7b777ee",
                "bd45525a6924a5c5"
            ]
        ],
        "l": false
    },
    {
        "id": "acb33ff4507d9a9b",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "",
        "func": "msg.payload = parseFloat(msg.payload.toFixed(2))\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 375,
        "y": 260,
        "wires": [
            [
                "6c490df17d1de881",
                "e65201e766b76bfd"
            ]
        ],
        "l": false
    },
    {
        "id": "2dc776b16235c7a0",
        "type": "debug",
        "z": "3154c44d1a91de38",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 430,
        "y": 680,
        "wires": []
    },
    {
        "id": "aec3c2c38a63dd10",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "#:(memoryOnly)::kiln_01.UpperTemperature",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 555,
        "y": 340,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "6ab284ac808bee4a",
        "type": "change",
        "z": "3154c44d1a91de38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "#:(memoryOnly)::kiln_01.LowerTemperature",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 555,
        "y": 400,
        "wires": [
            []
        ],
        "l": false
    },
    {
        "id": "ba263ec1075b0897",
        "type": "function",
        "z": "3154c44d1a91de38",
        "name": "initialize variables",
        "func": "\nvar input = []\nvar inputcount = 2\nfor (let index = 0; index < inputcount; index++) {\n    var obj1 = { x: { min: 0.0, max: 0.0 }, y: { min: 0.0, max: 0.0 }, span: 0.0, offset: 0.0 }\n    var calibration = Object.create(obj1)\n    var obj2 = { HiHi: 0.0, Hi: 0.0, Lo: 0.0, LoLo: 0.0 }\n    var limits = Object.create(obj2)\n    var obj3 = { HiHi: false, Hi: false, Lo: false, LoLo: false }\n    var alarms = Object.create(obj3)\n    input.push({ id: '', raw: 0.0, scaled: 0.0, calibration, limits, alarms })\n}\nvar analoginput = { selected_input: 0, input }\nglobal.set('analoginput', analoginput)\nmsg.payload = { analoginput }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 670,
        "y": 100,
        "wires": [
            [
                "28039e0648bd6ac9"
            ]
        ]
    },
    {
        "id": "28039e0648bd6ac9",
        "type": "debug",
        "z": "3154c44d1a91de38",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 850,
        "y": 100,
        "wires": []
    },
    {
        "id": "de189d290a2ccfe0",
        "type": "inject",
        "z": "3154c44d1a91de38",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 490,
        "y": 100,
        "wires": [
            [
                "ba263ec1075b0897"
            ]
        ]
    },
    {
        "id": "7287721824e53891",
        "type": "range",
        "z": "3154c44d1a91de38",
        "minin": "0",
        "maxin": "3000",
        "minout": "0",
        "maxout": "3000",
        "action": "scale",
        "round": false,
        "property": "payload",
        "name": "",
        "x": 315,
        "y": 340,
        "wires": [
            [
                "0d670f61e6fde01c"
            ]
        ],
        "l": false
    },
    {
        "id": "9e74c237cf627626",
        "type": "range",
        "z": "3154c44d1a91de38",
        "minin": "0",
        "maxin": "3000",
        "minout": "0",
        "maxout": "3000",
        "action": "scale",
        "round": false,
        "property": "payload",
        "name": "",
        "x": 315,
        "y": 400,
        "wires": [
            [
                "8c970109233d3f07"
            ]
        ],
        "l": false
    },
    {
        "id": "1c9e79b136a623e2",
        "type": "catch",
        "z": "98e4246c87add39e",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 60,
        "y": 20,
        "wires": [
            [
                "d3aa01638e9fef28"
            ]
        ]
    },
    {
        "id": "d3aa01638e9fef28",
        "type": "debug",
        "z": "98e4246c87add39e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 190,
        "y": 20,
        "wires": []
    },
    {
        "id": "0f5d38dea1f9fdf8",
        "type": "inject",
        "z": "98e4246c87add39e",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 140,
        "wires": [
            [
                "f14af351da1b05c1"
            ]
        ]
    },
    {
        "id": "f14af351da1b05c1",
        "type": "exec",
        "z": "98e4246c87add39e",
        "command": "node-red-restart",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 380,
        "y": 140,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "680c5276908a542b",
        "type": "inject",
        "z": "98e4246c87add39e",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 180,
        "wires": [
            [
                "3b38d7ad7142ae99"
            ]
        ]
    },
    {
        "id": "3b38d7ad7142ae99",
        "type": "exec",
        "z": "98e4246c87add39e",
        "command": "sudo shutdown now",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 400,
        "y": 180,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "300160ca9486c7ff",
        "type": "inject",
        "z": "98e4246c87add39e",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 220,
        "wires": [
            [
                "5bb9693f827a8916"
            ]
        ]
    },
    {
        "id": "5bb9693f827a8916",
        "type": "exec",
        "z": "98e4246c87add39e",
        "command": "sudo reboot now",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 390,
        "y": 220,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "596909473c6a4408",
        "type": "comment",
        "z": "98e4246c87add39e",
        "name": "PiSugar: https://github.com/PiSugar/pisugar-power-manager-rs",
        "info": "",
        "x": 370,
        "y": 480,
        "wires": []
    },
    {
        "id": "8de289bdc5fd2ca4",
        "type": "comment",
        "z": "98e4246c87add39e",
        "name": "PiSugar user:admin pass:admin",
        "info": "",
        "x": 270,
        "y": 500,
        "wires": []
    },
    {
        "id": "136ed4e4c080a681",
        "type": "inject",
        "z": "98e4246c87add39e",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "x": 210,
        "y": 260,
        "wires": [
            [
                "5e1d74212376e4f3"
            ]
        ]
    },
    {
        "id": "5e1d74212376e4f3",
        "type": "exec",
        "z": "98e4246c87add39e",
        "command": "hostname",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 360,
        "y": 260,
        "wires": [
            [
                "f619121c08077343"
            ],
            [],
            []
        ]
    },
    {
        "id": "f619121c08077343",
        "type": "change",
        "z": "98e4246c87add39e",
        "name": "set hostname",
        "rules": [
            {
                "t": "set",
                "p": "hostname",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "1097eb74c1ce2240",
        "type": "http in",
        "z": "98e4246c87add39e",
        "name": "",
        "url": "/ui/PiSugar",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 220,
        "y": 400,
        "wires": [
            [
                "af3ca29e3470f492"
            ]
        ]
    },
    {
        "id": "cdb3dcc1721e5831",
        "type": "http response",
        "z": "98e4246c87add39e",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 530,
        "y": 400,
        "wires": []
    },
    {
        "id": "af3ca29e3470f492",
        "type": "function",
        "z": "98e4246c87add39e",
        "name": "",
        "func": "var hostname = global.get('hostname')\nvar Location = \"http://\"+hostname.replace(/[^\\x20-\\x7E]/g, '')+\":8421\"\n\nmsg.statusCode = 303;\nmsg.headers = {Location}\ndelete msg.payload;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 400,
        "wires": [
            [
                "cdb3dcc1721e5831"
            ]
        ]
    },
    {
        "id": "ca9e41f3290507c6",
        "type": "http in",
        "z": "98e4246c87add39e",
        "name": "",
        "url": "/ui/NodeRed",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 210,
        "y": 420,
        "wires": [
            [
                "852ffc368267fec4"
            ]
        ]
    },
    {
        "id": "c3144365fd84c245",
        "type": "http response",
        "z": "98e4246c87add39e",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 530,
        "y": 420,
        "wires": []
    },
    {
        "id": "852ffc368267fec4",
        "type": "function",
        "z": "98e4246c87add39e",
        "name": "",
        "func": "var hostname = global.get('hostname')\nvar Location = \"http://\"+hostname.replace(/[^\\x20-\\x7E]/g, '')+\":1880\"\n\nmsg.statusCode = 303;\nmsg.headers = {Location}\ndelete msg.payload;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 420,
        "wires": [
            [
                "c3144365fd84c245"
            ]
        ]
    },
    {
        "id": "f6f7fc1d1ca591cd",
        "type": "http in",
        "z": "98e4246c87add39e",
        "name": "",
        "url": "/ui/Grafana",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 220,
        "y": 440,
        "wires": [
            [
                "e1079bfffd705742"
            ]
        ]
    },
    {
        "id": "ca1a6fb8733136ea",
        "type": "http response",
        "z": "98e4246c87add39e",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 530,
        "y": 440,
        "wires": []
    },
    {
        "id": "e1079bfffd705742",
        "type": "function",
        "z": "98e4246c87add39e",
        "name": "",
        "func": "var hostname = global.get('hostname')\nvar Location = \"http://\" + hostname.replace(/[^\\x20-\\x7E]/g, '') + \":3000/d/_6ZBVeRgk/historical-temperatures?orgId=1&from=now-24h&to=now&fullscreen&panelId=5\"\n//var Location = \"http://\"+hostname.replace(/[^\\x20-\\x7E]/g, '')+\":3000/d/_6ZBVeRgk/historical-temperatures?orgId=1&from=now-7d&to=now&fullscreen&panelId=4\"\n\nmsg.statusCode = 303;\nmsg.headers = { Location }\ndelete msg.payload;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 440,
        "wires": [
            [
                "ca1a6fb8733136ea"
            ]
        ]
    },
    {
        "id": "f9460b8af28fe098",
        "type": "comment",
        "z": "98e4246c87add39e",
        "name": "system commands",
        "info": "",
        "x": 110,
        "y": 100,
        "wires": []
    },
    {
        "id": "d50ee496a66536be",
        "type": "comment",
        "z": "98e4246c87add39e",
        "name": "web redirection",
        "info": "",
        "x": 100,
        "y": 360,
        "wires": []
    }
]